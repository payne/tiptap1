(self.webpackChunktiptap1=self.webpackChunktiptap1||[]).push([[179],{761:(xl,us,ds)=>{"use strict";function Re(t){return"function"==typeof t}function K(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const le=K(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function U(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class M{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(Re(r))try{r()}catch(s){e=s instanceof le?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{_(s)}catch(o){e=e??[],o instanceof le?e=[...e,...o.errors]:e.push(o)}}if(e)throw new le(e)}}add(e){var n;if(e&&e!==this)if(this.closed)_(e);else{if(e instanceof M){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&U(n,e)}remove(e){const{_finalizers:n}=this;n&&U(n,e),e instanceof M&&e._removeParent(this)}}M.EMPTY=(()=>{const t=new M;return t.closed=!0,t})();const G=M.EMPTY;function Q(t){return t instanceof M||t&&"closed"in t&&Re(t.remove)&&Re(t.add)&&Re(t.unsubscribe)}function _(t){Re(t)?t():t.unsubscribe()}const A={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},I={setTimeout(t,e,...n){const{delegate:r}=I;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=I;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function C(t){I.setTimeout(()=>{const{onUnhandledError:e}=A;if(!e)throw t;e(t)})}function F(){}const V=b("C",void 0,void 0);function b(t,e,n){return{kind:t,value:e,error:n}}let S=null;function E(t){if(A.useDeprecatedSynchronousErrorHandling){const e=!S;if(e&&(S={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=S;if(S=null,n)throw r}}else t()}class T extends M{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Q(e)&&e.add(this)):this.destination=Fe}static create(e,n,r){return new N(e,n,r)}next(e){this.isStopped?Ce(function q(t){return b("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Ce(function $(t){return b("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ce(V,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const P=Function.prototype.bind;function W(t,e){return P.call(t,e)}class x{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){J(r)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){J(r)}else J(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){J(n)}}}class N extends T{constructor(e,n,r){let i;if(super(),Re(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&A.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&W(e.next,s),error:e.error&&W(e.error,s),complete:e.complete&&W(e.complete,s)}):i=e}this.destination=new x(i)}}function J(t){A.useDeprecatedSynchronousErrorHandling?function O(t){A.useDeprecatedSynchronousErrorHandling&&S&&(S.errorThrown=!0,S.error=t)}(t):C(t)}function Ce(t,e){const{onStoppedNotification:n}=A;n&&I.setTimeout(()=>n(t,e))}const Fe={closed:!0,next:F,error:function ie(t){throw t},complete:F},Ge="function"==typeof Symbol&&Symbol.observable||"@@observable";function ot(t){return t}function we(t){return 0===t.length?ot:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}let vt=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const s=function at(t){return t&&t instanceof T||function Ar(t){return t&&Re(t.next)&&Re(t.error)&&Re(t.complete)}(t)&&Q(t)}(n)?n:new N(n,r,i);return E(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=Tr(r))((i,s)=>{const o=new N({next:a=>{try{n(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[Ge](){return this}pipe(...n){return we(n)(this)}toPromise(n){return new(n=Tr(n))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function Tr(t){var e;return null!==(e=t??A.Promise)&&void 0!==e?e:Promise}const lt=K(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let qt=(()=>{class t extends vt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new Fn(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new lt}next(n){E(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){E(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){E(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:s}=this;return r||i?G:(this.currentObservers=null,s.push(n),new M(()=>{this.currentObservers=null,U(s,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){const n=new vt;return n.source=this,n}}return t.create=(e,n)=>new Fn(e,n),t})();class Fn extends qt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:G}}function Ir(t){return Re(t?.lift)}function ht(t){return e=>{if(Ir(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function wt(t,e,n,r,i){return new kr(t,e,n,r,i)}class kr extends T{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function xe(t,e){return ht((n,r)=>{let i=0;n.subscribe(wt(r,s=>{r.next(t.call(e,s,i++))}))})}function Xe(t){return this instanceof Xe?(this.v=t,this):new Xe(t)}function Ze(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){r[h]&&(i[h]=function(p){return new Promise(function(m,v){s.push([h,p,m,v])>1||a(h,p)})})}function a(h,p){try{!function l(h){h.value instanceof Xe?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(r[h](p))}catch(m){d(s[0][3],m)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,p){h(p),s.shift(),s.length&&a(s[0][0],s[0][1])}}function qe(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function D(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){!function i(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=t[s](o)).done,o.value)})}}}const qb=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Kb(t){return Re(t?.then)}function Jb(t){return Re(t[Ge])}function Yb(t){return Symbol.asyncIterator&&Re(t?.[Symbol.asyncIterator])}function Zb(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Qb=function hO(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Xb(t){return Re(t?.[Qb])}function e0(t){return Ze(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:i}=yield Xe(n.read());if(i)return yield Xe(void 0);yield yield Xe(r)}}finally{n.releaseLock()}})}function t0(t){return Re(t?.getReader)}function xr(t){if(t instanceof vt)return t;if(null!=t){if(Jb(t))return function pO(t){return new vt(e=>{const n=t[Ge]();if(Re(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(qb(t))return function gO(t){return new vt(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(Kb(t))return function mO(t){return new vt(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,C)})}(t);if(Yb(t))return n0(t);if(Xb(t))return function yO(t){return new vt(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(t0(t))return function vO(t){return n0(e0(t))}(t)}throw Zb(t)}function n0(t){return new vt(e=>{(function wO(t,e){var n,r,i,s;return function Ue(t,e,n,r){return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function i(s){return s instanceof n?s:new n(function(o){o(s)})}(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(n=qe(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function Oi(t,e,n,r=0,i=!1){const s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Xt(t,e,n=1/0){return Re(e)?Xt((r,i)=>xe((s,o)=>e(r,s,i,o))(xr(t(r,i))),n):("number"==typeof e&&(n=e),ht((r,i)=>function bO(t,e,n,r,i,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},p=v=>c<r?m(v):l.push(v),m=v=>{s&&e.next(v),c++;let w=!1;xr(n(v,u++)).subscribe(wt(e,k=>{i?.(k),s?p(k):e.next(k)},()=>{w=!0},void 0,()=>{if(w)try{for(c--;l.length&&c<r;){const k=l.shift();o?Oi(e,o,()=>m(k)):m(k)}h()}catch(k){e.error(k)}}))};return t.subscribe(wt(e,p,()=>{d=!0,h()})),()=>{a?.()}}(r,i,t,n)))}function ea(t=1/0){return Xt(ot,t)}const Ri=new vt(t=>t.complete());function vp(t){return t[t.length-1]}function r0(t){return Re(vp(t))?t.pop():void 0}function Nl(t){return function CO(t){return t&&Re(t.schedule)}(vp(t))?t.pop():void 0}function s0(t,e=0){return ht((n,r)=>{n.subscribe(wt(r,i=>Oi(r,t,()=>r.next(i),e),()=>Oi(r,t,()=>r.complete(),e),i=>Oi(r,t,()=>r.error(i),e)))})}function o0(t,e=0){return ht((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function a0(t,e){if(!t)throw new Error("Iterable cannot be null");return new vt(n=>{Oi(n,e,()=>{const r=t[Symbol.asyncIterator]();Oi(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function Ft(t,e){return e?function IO(t,e){if(null!=t){if(Jb(t))return function SO(t,e){return xr(t).pipe(o0(e),s0(e))}(t,e);if(qb(t))return function MO(t,e){return new vt(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(Kb(t))return function EO(t,e){return xr(t).pipe(o0(e),s0(e))}(t,e);if(Yb(t))return a0(t,e);if(Xb(t))return function TO(t,e){return new vt(n=>{let r;return Oi(n,e,()=>{r=t[Qb](),Oi(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void n.error(o)}s?n.complete():n.next(i)},0,!0)}),()=>Re(r?.return)&&r.return()})}(t,e);if(t0(t))return function AO(t,e){return a0(e0(t),e)}(t,e)}throw Zb(t)}(t,e):xr(t)}function wp(t,e,...n){if(!0===e)return void t();if(!1===e)return;const r=new N({next:()=>{r.unsubscribe(),t()}});return e(...n).subscribe(r)}function ct(t){for(let e in t)if(t[e]===ct)return e;throw Error("Could not find renamed property on target object.")}function bp(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function ut(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(ut).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function _p(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const NO=ct({__forward_ref__:ct});function dt(t){return t.__forward_ref__=dt,t.toString=function(){return ut(this())},t}function ye(t){return Cp(t)?t():t}function Cp(t){return"function"==typeof t&&t.hasOwnProperty(NO)&&t.__forward_ref__===dt}function Dp(t){return t&&!!t.\u0275providers}class te extends Error{constructor(e,n){super(function Vu(t,e){return`NG0${Math.abs(t)}${e?": "+e.trim():""}`}(e,n)),this.code=e}}function Ie(t){return"string"==typeof t?t:null==t?"":String(t)}function Bu(t,e){throw new te(-201,!1)}function Qn(t,e){null==t&&function tt(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function Me(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function fr(t){return{providers:t.providers||[],imports:t.imports||[]}}function Uu(t){return c0(t,ju)||c0(t,d0)}function c0(t,e){return t.hasOwnProperty(e)?t[e]:null}function u0(t){return t&&(t.hasOwnProperty(Sp)||t.hasOwnProperty(jO))?t[Sp]:null}const ju=ct({\u0275prov:ct}),Sp=ct({\u0275inj:ct}),d0=ct({ngInjectableDef:ct}),jO=ct({ngInjectorDef:ct});var ve=(()=>((ve=ve||{})[ve.Default=0]="Default",ve[ve.Host=1]="Host",ve[ve.Self=2]="Self",ve[ve.SkipSelf=4]="SkipSelf",ve[ve.Optional=8]="Optional",ve))();let Ep;function hr(t){const e=Ep;return Ep=t,e}function f0(t,e,n){const r=Uu(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&ve.Optional?null:void 0!==e?e:void Bu(ut(t))}const pt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Ol={},Mp="__NG_DI_FLAG__",$u="ngTempTokenPath",zO=/\n/gm,h0="__source";let Rl;function ta(t){const e=Rl;return Rl=t,e}function WO(t,e=ve.Default){if(void 0===Rl)throw new te(-203,!1);return null===Rl?f0(t,void 0,e):Rl.get(t,e&ve.Optional?null:void 0,e)}function pe(t,e=ve.Default){return(function $O(){return Ep}()||WO)(ye(t),e)}function st(t,e=ve.Default){return pe(t,Hu(e))}function Hu(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Tp(t){const e=[];for(let n=0;n<t.length;n++){const r=ye(t[n]);if(Array.isArray(r)){if(0===r.length)throw new te(900,!1);let i,s=ve.Default;for(let o=0;o<r.length;o++){const a=r[o],l=qO(a);"number"==typeof l?-1===l?i=a.token:s|=l:i=a}e.push(pe(i,s))}else e.push(pe(r))}return e}function Fl(t,e){return t[Mp]=e,t.prototype[Mp]=e,t}function qO(t){return t[Mp]}function fs(t){return{toString:t}.toString()}var Nr=(()=>((Nr=Nr||{})[Nr.OnPush=0]="OnPush",Nr[Nr.Default=1]="Default",Nr))(),si=(()=>{return(t=si||(si={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",si;var t})();const Pi={},Qe=[],zu=ct({\u0275cmp:ct}),Ap=ct({\u0275dir:ct}),Ip=ct({\u0275pipe:ct}),g0=ct({\u0275mod:ct}),Li=ct({\u0275fac:ct}),Pl=ct({__NG_ELEMENT_ID__:ct});let YO=0;function Ll(t){return fs(()=>{const n=!0===t.standalone,r={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Nr.OnPush,directiveDefs:null,pipeDefs:null,standalone:n,dependencies:n&&t.dependencies||null,getStandaloneInjector:null,selectors:t.selectors||Qe,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||si.Emulated,id:"c"+YO++,styles:t.styles||Qe,_:null,setInput:null,schemas:t.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=t.dependencies,o=t.features;return i.inputs=v0(t.inputs,r),i.outputs=v0(t.outputs),o&&o.forEach(a=>a(i)),i.directiveDefs=s?()=>("function"==typeof s?s():s).map(m0).filter(y0):null,i.pipeDefs=s?()=>("function"==typeof s?s():s).map(_n).filter(y0):null,i})}function m0(t){return nt(t)||ln(t)}function y0(t){return null!==t}function Or(t){return fs(()=>({type:t.type,bootstrap:t.bootstrap||Qe,declarations:t.declarations||Qe,imports:t.imports||Qe,exports:t.exports||Qe,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function v0(t,e){if(null==t)return Pi;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}const De=Ll;function nt(t){return t[zu]||null}function ln(t){return t[Ap]||null}function _n(t){return t[Ip]||null}function Xn(t,e){const n=t[g0]||null;if(!n&&!0===e)throw new Error(`Type ${ut(t)} does not have '\u0275mod' property.`);return n}function Vn(t){return Array.isArray(t)&&"object"==typeof t[1]}function Fr(t){return Array.isArray(t)&&!0===t[1]}function Np(t){return 0!=(4&t.flags)}function Ku(t){return t.componentOffset>-1}function Ju(t){return 1==(1&t.flags)}function Pr(t){return null!==t.template}function nR(t){return 0!=(256&t[2])}function oo(t,e){return t.hasOwnProperty(Li)?t[Li]:null}class sR{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function gr(){return _0}function _0(t){return t.type.prototype.ngOnChanges&&(t.setInput=aR),oR}function oR(){const t=D0(this),e=t?.current;if(e){const n=t.previous;if(n===Pi)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function aR(t,e,n,r){const i=this.declaredInputs[n],s=D0(t)||function lR(t,e){return t[C0]=e}(t,{previous:Pi,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[i];o[i]=new sR(l&&l.currentValue,e,a===Pi),t[r]=e}gr.ngInherit=!0;const C0="__ngSimpleChanges__";function D0(t){return t[C0]||null}function jt(t){for(;Array.isArray(t);)t=t[0];return t}function Yu(t,e){return jt(e[t])}function tr(t,e){return jt(e[t.index])}function Lp(t,e){return t.data[e]}function nr(t,e){const n=e[t];return Vn(n)?n:n[0]}function Zu(t){return 64==(64&t[2])}function hs(t,e){return null==e?null:t[e]}function S0(t){t[18]=0}function Vp(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const Te={lFrame:R0(null),bindingsEnabled:!0};function M0(){return Te.bindingsEnabled}function Z(){return Te.lFrame.lView}function Ke(){return Te.lFrame.tView}function en(){let t=T0();for(;null!==t&&64===t.type;)t=t.parent;return t}function T0(){return Te.lFrame.currentTNode}function oi(t,e){const n=Te.lFrame;n.currentTNode=t,n.isParent=e}function Bp(){return Te.lFrame.isParent}function aa(){return Te.lFrame.bindingIndex++}function ER(t,e){const n=Te.lFrame;n.bindingIndex=n.bindingRootIndex=t,jp(e)}function jp(t){Te.lFrame.currentDirectiveIndex=t}function Hp(t){Te.lFrame.currentQueryIndex=t}function TR(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function N0(t,e,n){if(n&ve.SkipSelf){let i=e,s=t;for(;!(i=i.parent,null!==i||n&ve.Host||(i=TR(s),null===i||(s=s[15],10&i.type))););if(null===i)return!1;e=i,t=s}const r=Te.lFrame=O0();return r.currentTNode=e,r.lView=t,!0}function zp(t){const e=O0(),n=t[1];Te.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function O0(){const t=Te.lFrame,e=null===t?null:t.child;return null===e?R0(t):e}function R0(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function F0(){const t=Te.lFrame;return Te.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const P0=F0;function Gp(){const t=F0();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Dn(){return Te.lFrame.selectedIndex}function ao(t){Te.lFrame.selectedIndex=t}function Qu(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(t.contentHooks||(t.contentHooks=[])).push(-n,o),a&&((t.contentHooks||(t.contentHooks=[])).push(n,a),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,a)),l&&(t.viewHooks||(t.viewHooks=[])).push(-n,l),c&&((t.viewHooks||(t.viewHooks=[])).push(n,c),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,c)),null!=u&&(t.destroyHooks||(t.destroyHooks=[])).push(n,u)}}function Xu(t,e,n){L0(t,e,3,n)}function ed(t,e,n,r){(3&t[2])===n&&L0(t,e,n,r)}function Wp(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function L0(t,e,n,r){const s=r??-1,o=e.length-1;let a=0;for(let l=void 0!==r?65535&t[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=r&&a>=r)break}else e[l]<0&&(t[18]+=65536),(a<s||-1==s)&&(PR(t,n,e,l),t[18]=(4294901760&t[18])+l+2),l++}function PR(t,e,n,r){const i=n[r]<0,s=n[r+1],a=t[i?-n[r]:n[r]];if(i){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Hl{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Kp(t,e,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{const s=i,o=n[++r];B0(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function V0(t){return 3===t||4===t||6===t}function B0(t){return 64===t.charCodeAt(0)}function Gl(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||U0(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function U0(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}function j0(t){return-1!==t}function la(t){return 32767&t}function ca(t,e){let n=function jR(t){return t>>16}(t),r=e;for(;n>0;)r=r[15],n--;return r}let Jp=!0;function td(t){const e=Jp;return Jp=t,e}let $R=0;const ai={};function nd(t,e){const n=Zp(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,Yp(r.data,t),Yp(e,null),Yp(r.blueprint,null));const i=rd(t,e),s=t.injectorIndex;if(j0(i)){const o=la(i),a=ca(i,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=i,s}function Yp(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Zp(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function rd(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){if(r=Y0(i),null===r)return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Qp(t,e,n){!function HR(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Pl)&&(r=n[Pl]),null==r&&(r=n[Pl]=$R++);const i=255&r;e.data[t+(i>>5)]|=1<<i}(t,e,n)}function z0(t,e,n){if(n&ve.Optional||void 0!==t)return t;Bu()}function G0(t,e,n,r){if(n&ve.Optional&&void 0===r&&(r=null),0==(n&(ve.Self|ve.Host))){const i=t[9],s=hr(void 0);try{return i?i.get(e,r,n&ve.Optional):f0(e,r,n&ve.Optional)}finally{hr(s)}}return z0(r,0,n)}function W0(t,e,n,r=ve.Default,i){if(null!==t){if(1024&e[2]){const o=function KR(t,e,n,r,i){let s=t,o=e;for(;null!==s&&null!==o&&1024&o[2]&&!(256&o[2]);){const a=q0(s,o,n,r|ve.Self,ai);if(a!==ai)return a;let l=s.parent;if(!l){const c=o[21];if(c){const u=c.get(n,ai,r);if(u!==ai)return u}l=Y0(o),o=o[15]}s=l}return i}(t,e,n,r,ai);if(o!==ai)return o}const s=q0(t,e,n,r,ai);if(s!==ai)return s}return G0(e,n,r,i)}function q0(t,e,n,r,i){const s=function WR(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Pl)?t[Pl]:void 0;return"number"==typeof e?e>=0?255&e:qR:e}(n);if("function"==typeof s){if(!N0(e,t,r))return r&ve.Host?z0(i,0,r):G0(e,n,r,i);try{const o=s(r);if(null!=o||r&ve.Optional)return o;Bu()}finally{P0()}}else if("number"==typeof s){let o=null,a=Zp(t,e),l=-1,c=r&ve.Host?e[16][6]:null;for((-1===a||r&ve.SkipSelf)&&(l=-1===a?rd(t,e):e[a+8],-1!==l&&J0(r,!1)?(o=e[1],a=la(l),e=ca(l,e)):a=-1);-1!==a;){const u=e[1];if(K0(s,a,u.data)){const d=GR(a,e,n,o,r,c);if(d!==ai)return d}l=e[a+8],-1!==l&&J0(r,e[1].data[a+8]===c)&&K0(s,a,e)?(o=u,a=la(l),e=ca(l,e)):a=-1}}return i}function GR(t,e,n,r,i,s){const o=e[1],a=o.data[t+8],u=function id(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,l=t.directiveStart,u=s>>20,h=i?a+u:t.directiveEnd;for(let p=r?a:a+u;p<h;p++){const m=o[p];if(p<l&&n===m||p>=l&&m.type===n)return p}if(i){const p=o[l];if(p&&Pr(p)&&p.type===n)return l}return null}(a,o,n,null==r?Ku(a)&&Jp:r!=o&&0!=(3&a.type),i&ve.Host&&s===a);return null!==u?ua(e,o,u,a):ai}function ua(t,e,n,r){let i=t[n];const s=e.data;if(function LR(t){return t instanceof Hl}(i)){const o=i;o.resolving&&function OO(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new te(-200,`Circular dependency in DI detected for ${t}${n}`)}(function et(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Ie(t)}(s[n]));const a=td(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?hr(o.injectImpl):null;N0(t,r,ve.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function FR(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=_0(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==l&&hr(l),td(a),o.resolving=!1,P0()}}return i}function K0(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function J0(t,e){return!(t&ve.Self||t&ve.Host&&e)}class da{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return W0(this._tNode,this._lView,e,Hu(r),n)}}function qR(){return new da(en(),Z())}function tn(t){return fs(()=>{const e=t.prototype.constructor,n=e[Li]||Xp(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const s=i[Li]||Xp(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Xp(t){return Cp(t)?()=>{const e=Xp(ye(t));return e&&e()}:oo(t)}function Y0(t){const e=t[1],n=e.type;return 2===n?e.declTNode:1===n?t[6]:null}const ha="__parameters__";function ga(t,e,n){return fs(()=>{const r=function eg(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(ha)?l[ha]:Object.defineProperty(l,ha,{value:[]})[ha];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class fe{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Me({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function lo(t,e){t.forEach(n=>Array.isArray(n)?lo(n,e):e(n))}function Q0(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function od(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function ir(t,e,n){let r=ma(t,e);return r>=0?t[1|r]=n:(r=~r,function QR(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function ng(t,e){const n=ma(t,e);if(n>=0)return t[1|n]}function ma(t,e){return function t_(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){const s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}(t,e,1)}const Jl=Fl(ga("Optional"),8),Yl=Fl(ga("SkipSelf"),4);var Bn=(()=>((Bn=Bn||{})[Bn.Important=1]="Important",Bn[Bn.DashCase=2]="DashCase",Bn))();const lg=new Map;let bF=0;const ug="__ngContext__";function dn(t,e){Vn(e)?(t[ug]=e[20],function CF(t){lg.set(t[20],t)}(e)):t[ug]=e}function fg(t,e){return undefined(t,e)}function ec(t){const e=t[3];return Fr(e)?e[3]:e}function hg(t){return C_(t[13])}function pg(t){return C_(t[4])}function C_(t){for(;null!==t&&!Fr(t);)t=t[4];return t}function va(t,e,n,r,i){if(null!=r){let s,o=!1;Fr(r)?s=r:Vn(r)&&(o=!0,r=r[0]);const a=jt(r);0===t&&null!==n?null==i?A_(e,n,a):co(e,n,a,i||null,!0):1===t&&null!==n?co(e,n,a,i||null,!0):2===t?function _g(t,e,n){const r=ud(t,e);r&&function HF(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function WF(t,e,n,r,i){const s=n[7];s!==jt(n)&&va(e,t,r,s,i);for(let a=10;a<n.length;a++){const l=n[a];tc(l[1],l,t,e,r,s)}}(e,t,s,n,i)}}function mg(t,e,n){return t.createElement(e,n)}function S_(t,e){const n=t[9],r=n.indexOf(e),i=e[3];512&e[2]&&(e[2]&=-513,Vp(i,-1)),n.splice(r,1)}function yg(t,e){if(t.length<=10)return;const n=10+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&S_(i,r),e>0&&(t[n-1][4]=r[4]);const s=od(t,10+e);!function FF(t,e){tc(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const o=s[19];null!==o&&o.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function E_(t,e){if(!(128&e[2])){const n=e[11];n.destroyNode&&tc(t,e,n,3,null,null),function VF(t){let e=t[13];if(!e)return vg(t[1],t);for(;e;){let n=null;if(Vn(e))n=e[13];else{const r=e[10];r&&(n=r)}if(!n){for(;e&&!e[4]&&e!==t;)Vn(e)&&vg(e[1],e),e=e[3];null===e&&(e=t),Vn(e)&&vg(e[1],e),n=e&&e[4]}e=n}}(e)}}function vg(t,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function $F(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof Hl)){const s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(i)}finally{}}}}(t,e),function jF(t,e){const n=t.cleanup,r=e[7];let i=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+3];o>=0?r[i=o]():r[i=-o].unsubscribe(),s+=2}else{const o=r[i=n[s+1]];n[s].call(o)}if(null!==r){for(let s=i+1;s<r.length;s++)(0,r[s])();e[7]=null}}(t,e),1===e[1].type&&e[11].destroy();const n=e[17];if(null!==n&&Fr(e[3])){n!==e[3]&&S_(n,e);const r=e[19];null!==r&&r.detachView(t)}!function DF(t){lg.delete(t[20])}(e)}}function M_(t,e,n){return function T_(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=t.data[r.directiveStart+i];if(s===si.None||s===si.Emulated)return null}return tr(r,n)}}(t,e.parent,n)}function co(t,e,n,r,i){t.insertBefore(e,n,r,i)}function A_(t,e,n){t.appendChild(e,n)}function I_(t,e,n,r,i){null!==r?co(t,e,n,r,i):A_(t,e,n)}function ud(t,e){return t.parentNode(e)}let Sg,N_=function x_(t,e,n){return 40&t.type?tr(t,n):null};function dd(t,e,n,r){const i=M_(t,r,e),s=e[11],a=function k_(t,e,n){return N_(t,e,n)}(r.parent||e[6],r,e);if(null!=i)if(Array.isArray(n))for(let l=0;l<n.length;l++)I_(s,i,n[l],a,!1);else I_(s,i,n,a,!1)}function fd(t,e){if(null!==e){const n=e.type;if(3&n)return tr(e,t);if(4&n)return bg(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return fd(t,r);{const i=t[e.index];return Fr(i)?bg(-1,i):jt(i)}}if(32&n)return fg(e,t)()||jt(t[e.index]);{const r=R_(t,e);return null!==r?Array.isArray(r)?r[0]:fd(ec(t[16]),r):fd(t,e.next)}}return null}function R_(t,e){return null!==e?t[16][6].projection[e.projection]:null}function bg(t,e){const n=10+t+1;if(n<e.length){const r=e[n],i=r[1].firstChild;if(null!==i)return fd(r,i)}return e[7]}function Cg(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],l=n.type;if(o&&0===e&&(a&&dn(jt(a),r),n.flags|=2),32!=(32&n.flags))if(8&l)Cg(t,e,n.child,r,i,s,!1),va(e,t,i,a,s);else if(32&l){const c=fg(n,r);let u;for(;u=c();)va(e,t,i,u,s);va(e,t,i,a,s)}else 16&l?F_(t,e,r,n,i,s):va(e,t,i,a,s);n=o?n.projectionNext:n.next}}function tc(t,e,n,r,i,s){Cg(n,r,t.firstChild,e,i,s,!1)}function F_(t,e,n,r,i,s){const o=n[16],l=o[6].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)va(e,t,i,l[c],s);else Cg(t,e,l,o[3],i,s,!0)}function P_(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function L_(t,e,n){const{mergedAttrs:r,classes:i,styles:s}=n;null!==r&&Kp(t,e,r),null!==i&&P_(t,e,i),null!==s&&function KF(t,e,n){t.setAttribute(e,"style",n)}(t,e,s)}class $_{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}const md=new fe("ENVIRONMENT_INITIALIZER"),Q_=new fe("INJECTOR",-1),X_=new fe("INJECTOR_DEF_TYPES");class eC{get(e,n=Ol){if(n===Ol){const r=new Error(`NullInjectorError: No provider for ${ut(e)}!`);throw r.name="NullInjectorError",r}return n}}function _P(...t){return{\u0275providers:tC(0,t),\u0275fromNgModule:!0}}function tC(t,...e){const n=[],r=new Set;let i;return lo(e,s=>{const o=s;kg(o,n,[],r)&&(i||(i=[]),i.push(o))}),void 0!==i&&nC(i,n),n}function nC(t,e){for(let n=0;n<t.length;n++){const{providers:i}=t[n];xg(i,s=>{e.push(s)})}}function kg(t,e,n,r){if(!(t=ye(t)))return!1;let i=null,s=u0(t);const o=!s&&nt(t);if(s||o){if(o&&!o.standalone)return!1;i=t}else{const l=t.ngModule;if(s=u0(l),!s)return!1;i=l}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)kg(c,e,n,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;r.add(i);try{lo(s.imports,u=>{kg(u,e,n,r)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&nC(c,e)}if(!a){const c=oo(i)||(()=>new i);e.push({provide:i,useFactory:c,deps:Qe},{provide:X_,useValue:i,multi:!0},{provide:md,useValue:()=>pe(i),multi:!0})}const l=s.providers;null==l||a||xg(l,u=>{e.push(u)})}}return i!==t&&void 0!==t.providers}function xg(t,e){for(let n of t)Dp(n)&&(n=n.\u0275providers),Array.isArray(n)?xg(n,e):e(n)}const CP=ct({provide:String,useValue:ct});function Ng(t){return null!==t&&"object"==typeof t&&CP in t}function fo(t){return"function"==typeof t}const Og=new fe("Set Injector scope."),yd={},SP={};let Rg;function vd(){return void 0===Rg&&(Rg=new eC),Rg}class ms{}class sC extends ms{constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Pg(e,o=>this.processProvider(o)),this.records.set(Q_,wa(void 0,this)),i.has("environment")&&this.records.set(ms,wa(void 0,this));const s=this.records.get(Og);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(X_.multi,Qe,ve.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const n=ta(this),r=hr(void 0);try{return e()}finally{ta(n),hr(r)}}get(e,n=Ol,r=ve.Default){this.assertNotDestroyed(),r=Hu(r);const i=ta(this),s=hr(void 0);try{if(!(r&ve.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function IP(t){return"function"==typeof t||"object"==typeof t&&t instanceof fe}(e)&&Uu(e);a=l&&this.injectableDefInScope(l)?wa(Fg(e),yd):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(r&ve.Self?vd():this.parent).get(e,n=r&ve.Optional&&n===Ol?null:n)}catch(o){if("NullInjectorError"===o.name){if((o[$u]=o[$u]||[]).unshift(ut(e)),i)throw o;return function KO(t,e,n,r){const i=t[$u];throw e[h0]&&i.unshift(e[h0]),t.message=function JO(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let i=ut(e);if(Array.isArray(e))i=e.map(ut).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):ut(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(zO,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[$u]=null,t}(o,e,"R3InjectorError",this.source)}throw o}finally{hr(s),ta(i)}}resolveInjectorInitializers(){const e=ta(this),n=hr(void 0);try{const r=this.get(md.multi,Qe,ve.Self);for(const i of r)i()}finally{ta(e),hr(n)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(ut(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new te(205,!1)}processProvider(e){let n=fo(e=ye(e))?e:ye(e&&e.provide);const r=function MP(t){return Ng(t)?wa(void 0,t.useValue):wa(oC(t),yd)}(e);if(fo(e)||!0!==e.multi)this.records.get(n);else{let i=this.records.get(n);i||(i=wa(void 0,yd,!0),i.factory=()=>Tp(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===yd&&(n.value=SP,n.value=n.factory()),"object"==typeof n.value&&n.value&&function AP(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=ye(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}}function Fg(t){const e=Uu(t),n=null!==e?e.factory:oo(t);if(null!==n)return n;if(t instanceof fe)throw new te(204,!1);if(t instanceof Function)return function EP(t){const e=t.length;if(e>0)throw function Kl(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?"),new te(204,!1);const n=function BO(t){const e=t&&(t[ju]||t[d0]);if(e){const n=function UO(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new te(204,!1)}function oC(t,e,n){let r;if(fo(t)){const i=ye(t);return oo(i)||Fg(i)}if(Ng(t))r=()=>ye(t.useValue);else if(function iC(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Tp(t.deps||[]));else if(function rC(t){return!(!t||!t.useExisting)}(t))r=()=>pe(ye(t.useExisting));else{const i=ye(t&&(t.useClass||t.provide));if(!function TP(t){return!!t.deps}(t))return oo(i)||Fg(i);r=()=>new i(...Tp(t.deps))}return r}function wa(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Pg(t,e){for(const n of t)Array.isArray(n)?Pg(n,e):n&&Dp(n)?Pg(n.\u0275providers,e):e(n)}class kP{}class aC{}class NP{resolveComponentFactory(e){throw function xP(t){const e=Error(`No component factory found for ${ut(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(e)}}let sc=(()=>{class t{}return t.NULL=new NP,t})();function OP(){return ba(en(),Z())}function ba(t,e){return new Un(tr(t,e))}let Un=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=OP,t})();class cC{}let li=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function FP(){const t=Z(),n=nr(en().index,t);return(Vn(n)?n:t)[11]}(),t})(),PP=(()=>{class t{}return t.\u0275prov=Me({token:t,providedIn:"root",factory:()=>null}),t})();class oc{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const LP=new oc("15.0.1"),Lg={};function Bg(t){return t.ngOriginalError}class _a{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Bg(e);for(;n&&Bg(n);)n=Bg(n);return n||null}}function ji(t){return t instanceof Function?t():t}function dC(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}const fC="ng-template";function KP(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==dC(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function hC(t){return 4===t.type&&t.value!==fC}function JP(t,e,n){return e===(4!==t.type||n?t.value:fC)}function YP(t,e,n){let r=4;const i=t.attrs||[],s=function XP(t){for(let e=0;e<t.length;e++)if(V0(t[e]))return e;return t.length}(i);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&r){if(r=2|1&r,""!==l&&!JP(t,l,n)||""===l&&1===e.length){if(Lr(r))return!1;o=!0}}else{const c=8&r?l:e[++a];if(8&r&&null!==t.attrs){if(!KP(t.attrs,c,n)){if(Lr(r))return!1;o=!0}continue}const d=ZP(8&r?"class":l,i,hC(t),n);if(-1===d){if(Lr(r))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":i[d+1].toLowerCase();const p=8&r?h:null;if(p&&-1!==dC(p,c,0)||2&r&&c!==h){if(Lr(r))return!1;o=!0}}}}else{if(!o&&!Lr(r)&&!Lr(l))return!1;if(o&&Lr(l))continue;o=!1,r=l|1&r}}return Lr(r)||o}function Lr(t){return 0==(1&t)}function ZP(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){const o=e[i];if(o===t)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function eL(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function pC(t,e,n=!1){for(let r=0;r<e.length;r++)if(YP(t,e[r],n))return!0;return!1}function gC(t,e){return t?":not("+e.trim()+")":e}function nL(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!Lr(o)&&(e+=gC(s,i),i=""),r=o,s=s||!Lr(r);n++}return""!==i&&(e+=gC(s,i)),e}const ke={};function wd(t){mC(Ke(),Z(),Dn()+t,!1)}function mC(t,e,n,r){if(!r)if(3==(3&e[2])){const s=t.preOrderCheckHooks;null!==s&&Xu(e,s,n)}else{const s=t.preOrderHooks;null!==s&&ed(e,s,0,n)}ao(n)}function bC(t,e=null,n=null,r){const i=_C(t,e,n,r);return i.resolveInjectorInitializers(),i}function _C(t,e=null,n=null,r,i=new Set){const s=[n||Qe,_P(t)];return r=r||("object"==typeof t?void 0:ut(t)),new sC(s,e||vd(),r||null,i)}let yr=(()=>{class t{static create(n,r){if(Array.isArray(n))return bC({name:""},r,n,"");{const i=n.name??"";return bC({name:i},n.parent,n.providers,i)}}}return t.THROW_IF_NOT_FOUND=Ol,t.NULL=new eC,t.\u0275prov=Me({token:t,providedIn:"any",factory:()=>pe(Q_)}),t.__NG_ELEMENT_ID__=-1,t})();function X(t,e=ve.Default){const n=Z();return null===n?pe(t,e):W0(en(),n,ye(t),e)}function zg(){throw new Error("invalid")}function _d(t,e){return t<<17|e<<2}function Vr(t){return t>>17&32767}function Gg(t){return 2|t}function $i(t){return(131068&t)>>2}function Wg(t,e){return-131069&t|e<<2}function qg(t){return 1|t}function VC(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],s=n[r+1];if(-1!==s){const o=t.data[s];Hp(i),o.contentQueries(2,e[s],s)}}}function Sd(t,e,n,r,i,s,o,a,l,c,u){const d=e.blueprint.slice();return d[0]=i,d[2]=76|r,(null!==u||t&&1024&t[2])&&(d[2]|=1024),S0(d),d[3]=d[15]=t,d[8]=n,d[10]=o||t&&t[10],d[11]=a||t&&t[11],d[12]=l||t&&t[12]||null,d[9]=c||t&&t[9]||null,d[6]=s,d[20]=function _F(){return bF++}(),d[21]=u,d[16]=2==e.type?t[16]:d,d}function Sa(t,e,n,r,i){let s=t.data[e];if(null===s)s=function tm(t,e,n,r,i){const s=T0(),o=Bp(),l=t.data[e]=function VL(t,e,n,r,i,s){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(t,e,n,r,i),function SR(){return Te.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const o=function $l(){const t=Te.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return oi(s,!0),s}function ac(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function nm(t,e,n){zp(e);try{const r=t.viewQuery;null!==r&&fm(1,r,n);const i=t.template;null!==i&&BC(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&VC(t,e),t.staticViewQueries&&fm(2,t.viewQuery,n);const s=t.components;null!==s&&function FL(t,e){for(let n=0;n<e.length;n++)rV(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[2]&=-5,Gp()}}function Ed(t,e,n,r){const i=e[2];if(128!=(128&i)){zp(e);try{S0(e),function I0(t){return Te.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&BC(t,e,n,2,r);const o=3==(3&i);if(o){const c=t.preOrderCheckHooks;null!==c&&Xu(e,c,null)}else{const c=t.preOrderHooks;null!==c&&ed(e,c,0,null),Wp(e,0)}if(function tV(t){for(let e=hg(t);null!==e;e=pg(e)){if(!e[2])continue;const n=e[9];for(let r=0;r<n.length;r++){const i=n[r],s=i[3];0==(512&i[2])&&Vp(s,1),i[2]|=512}}}(e),function eV(t){for(let e=hg(t);null!==e;e=pg(e))for(let n=10;n<e.length;n++){const r=e[n],i=r[1];Zu(r)&&Ed(i,r,i.template,r[8])}}(e),null!==t.contentQueries&&VC(t,e),o){const c=t.contentCheckHooks;null!==c&&Xu(e,c)}else{const c=t.contentHooks;null!==c&&ed(e,c,1),Wp(e,1)}!function OL(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)ao(~i);else{const s=i,o=n[++r],a=n[++r];ER(o,s),a(2,e[s])}}}finally{ao(-1)}}(t,e);const a=t.components;null!==a&&function RL(t,e){for(let n=0;n<e.length;n++)nV(t,e[n])}(e,a);const l=t.viewQuery;if(null!==l&&fm(2,l,r),o){const c=t.viewCheckHooks;null!==c&&Xu(e,c)}else{const c=t.viewHooks;null!==c&&ed(e,c,2),Wp(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,Vp(e[3],-1))}finally{Gp()}}}function BC(t,e,n,r,i){const s=Dn(),o=2&r;try{ao(-1),o&&e.length>22&&mC(t,e,22,!1),n(r,i)}finally{ao(s)}}function rm(t,e,n){if(Np(e)){const i=e.directiveEnd;for(let s=e.directiveStart;s<i;s++){const o=t.data[s];o.contentQueries&&o.contentQueries(1,n[s],s)}}}function UC(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=om(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function om(t,e,n,r,i,s,o,a,l,c){const u=22+r,d=u+i,h=function PL(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:ke);return n}(u,d),p="function"==typeof c?c():c;return h[1]={type:t,blueprint:h,template:n,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1}}function $C(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=null===n?{}:n;const s=t[i];null===r?HC(n,e,i,s):r.hasOwnProperty(i)&&HC(n,e,r[i],s)}return n}function HC(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function zC(t,e){const n=nr(e,t);16&n[2]||(n[2]|=32)}function GC(t,e,n,r,i,s){for(let c=0;c<r.length;c++)Qp(nd(n,e),t,r[c].type);!function JL(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let c=0;c<r.length;c++){const u=r[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=ac(t,e,r.length,null);for(let c=0;c<r.length;c++){const u=r[c];n.mergedAttrs=Gl(n.mergedAttrs,u.hostAttrs),YL(t,n,e,l,u),KL(l,u,i),null!==u.contentQueries&&(n.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(n.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),a=!0),l++}!function BL(t,e,n){const i=e.directiveEnd,s=t.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<i;u++){const d=s[u],h=n?n.get(d):null,m=h?h.outputs:null;l=$C(d.inputs,u,l,h?h.inputs:null),c=$C(d.outputs,u,c,m);const v=null===l||null===o||hC(e)?null:XL(l,u,o);a.push(v)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(t,n,s)}function WC(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=function MR(){return Te.lFrame.currentDirectiveIndex}();try{ao(s);for(let a=r;a<i;a++){const l=t.data[a],c=e[a];jp(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&GL(l,c)}}finally{ao(-1),jp(o)}}function GL(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function lm(t,e,n){e.componentOffset=n,(t.components||(t.components=[])).push(e.index)}function KL(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Pr(e)&&(n[""]=t)}}function YL(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=oo(i.type)),o=new Hl(s,Pr(i),X);t.blueprint[r]=o,n[r]=o,function $L(t,e,n,r,i){const s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const a=~e.index;(function HL(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=a&&o.push(a),o.push(n,r,s)}}(t,e,r,ac(t,n,i.hostVars,ke),i)}function ZL(t,e,n){const r=tr(e,t),i=UC(n),s=t[10],o=Md(t,Sd(t,i,null,n.onPush?32:16,r,e,s,s.createRenderer(r,n),null,null,null));t[e.index]=o}function QL(t,e,n,r,i,s){const o=s[e];if(null!==o){const a=r.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],d=o[l++];null!==a?r.setInput(n,d,c,u):n[u]=d}}}function XL(t,e,n){let r=null,i=0;for(;i<n.length;){const s=n[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===r&&(r=[]);const o=t[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],n[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function nV(t,e){const n=nr(e,t);if(Zu(n)){const r=n[1];48&n[2]?Ed(r,n,r.template,n[8]):n[5]>0&&um(n)}}function um(t){for(let r=hg(t);null!==r;r=pg(r))for(let i=10;i<r.length;i++){const s=r[i];if(Zu(s))if(512&s[2]){const o=s[1];Ed(o,s,o.template,s[8])}else s[5]>0&&um(s)}const n=t[1].components;if(null!==n)for(let r=0;r<n.length;r++){const i=nr(n[r],t);Zu(i)&&i[5]>0&&um(i)}}function rV(t,e){const n=nr(e,t),r=n[1];(function iV(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(r,n),nm(r,n,n[8])}function Md(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function dm(t){for(;t;){t[2]|=32;const e=ec(t);if(nR(t)&&!e)return t;t=e}return null}function Td(t,e,n,r=!0){const i=e[10];i.begin&&i.begin();try{Ed(t,e,t.template,n)}catch(o){throw r&&ZC(e,o),o}finally{i.end&&i.end()}}function fm(t,e,n){Hp(0),e(t,n)}function KC(t){return t[7]||(t[7]=[])}function JC(t){return t.cleanup||(t.cleanup=[])}function ZC(t,e){const n=t[9],r=n?n.get(_a,null):null;r&&r.handleError(e)}function hm(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=e[o],c=t.data[o];null!==c.setInput?c.setInput(l,i,r,a):l[a]=i}}function Ad(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=_p(i,a):2==s&&(r=_p(r,a+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}function Id(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&r.push(jt(s)),Fr(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Id(l[1],l,c,r)}const o=n.type;if(8&o)Id(t,e,n.child,r);else if(32&o){const a=fg(n,e);let l;for(;l=a();)r.push(l)}else if(16&o){const a=R_(e,n);if(Array.isArray(a))r.push(...a);else{const l=ec(e[16]);Id(l[1],l,a,r,!0)}}n=i?n.projectionNext:n.next}return r}class lc{constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,n=e[1];return Id(n,e,n.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Fr(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(yg(e,r),od(n,r))}this._attachedToViewContainer=!1}E_(this._lView[1],this._lView)}onDestroy(e){!function jC(t,e,n,r){const i=KC(e);null===n?i.push(r):(i.push(n),t.firstCreatePass&&JC(t).push(r,i.length-1))}(this._lView[1],this._lView,null,e)}markForCheck(){dm(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Td(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function LF(t,e){tc(t,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new te(902,!1);this._appRef=e}}class sV extends lc{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Td(e[1],e,e[8],!1)}checkNoChanges(){}get context(){return null}}class pm extends sc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=nt(e);return new cc(n,this.ngModule)}}function QC(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}class aV{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Hu(r);const i=this.injector.get(e,Lg,r);return i!==Lg||n===Lg?i:this.parentInjector.get(e,n,r)}}class cc extends aC{constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function rL(t){return t.map(nL).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return QC(this.componentDef.inputs)}get outputs(){return QC(this.componentDef.outputs)}create(e,n,r,i){let s=(i=i||this.ngModule)instanceof ms?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new aV(e,s):e,a=o.get(cC,null);if(null===a)throw new te(407,!1);const l=o.get(PP,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",d=r?function LL(t,e,n){return t.selectRootElement(e,n===si.ShadowDom)}(c,r,this.componentDef.encapsulation):mg(c,u,function oV(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(u)),h=this.componentDef.onPush?288:272,p=om(0,null,null,1,0,null,null,null,null,null),m=Sd(null,p,null,h,null,null,a,c,l,o,null);let v,w;zp(m);try{const k=this.componentDef;let z,B=null;k.findHostDirectiveDefs?(z=[],B=new Map,k.findHostDirectiveDefs(k,z,B),z.push(k)):z=[k];const ce=function uV(t,e){const n=t[1];return t[22]=e,Sa(n,22,2,"#host",null)}(m,d),_e=function dV(t,e,n,r,i,s,o,a){const l=i[1];!function fV(t,e,n,r){for(const i of t)e.mergedAttrs=Gl(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(Ad(e,e.mergedAttrs,!0),null!==n&&L_(r,n,e))}(r,t,e,o);const c=s.createRenderer(e,n),u=Sd(i,UC(n),null,n.onPush?32:16,i[t.index],t,s,c,a||null,null,null);return l.firstCreatePass&&lm(l,t,r.length-1),Md(i,u),i[t.index]=u}(ce,d,k,z,m,a,c);w=Lp(p,22),d&&function pV(t,e,n,r){if(r)Kp(t,n,["ng-version",LP.full]);else{const{attrs:i,classes:s}=function iL(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!Lr(i))break;i=s}r++}return{attrs:e,classes:n}}(e.selectors[0]);i&&Kp(t,n,i),s&&s.length>0&&P_(t,n,s.join(" "))}}(c,k,d,r),void 0!==n&&function gV(t,e,n){const r=t.projection=[];for(let i=0;i<e.length;i++){const s=n[i];r.push(null!=s?Array.from(s):null)}}(w,this.ngContentSelectors,n),v=function hV(t,e,n,r,i,s){const o=en(),a=i[1],l=tr(o,i);GC(a,i,o,n,null,r);for(let u=0;u<n.length;u++)dn(ua(i,a,o.directiveStart+u,o),i);WC(a,i,o),l&&dn(l,i);const c=ua(i,a,o.directiveStart+o.componentOffset,o);if(t[8]=i[8]=c,null!==s)for(const u of s)u(c,e);return rm(a,o,t),c}(_e,k,z,B,m,[mV]),nm(p,m,null)}finally{Gp()}return new cV(this.componentType,v,ba(w,m),m,w)}}class cV extends kP{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.instance=n,this.hostView=this.changeDetectorRef=new sV(i),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){const s=this._rootLView;hm(s[1],s,i,e,n),zC(s,this._tNode.index)}}get injector(){return new da(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function mV(){const t=en();Qu(Z()[1],t)}function rt(t){let e=function XC(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),n=!0;const r=[t];for(;e;){let i;if(Pr(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new te(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);const o=t;o.inputs=gm(t.inputs),o.declaredInputs=gm(t.declaredInputs),o.outputs=gm(t.outputs);const a=i.hostBindings;a&&bV(t,a);const l=i.viewQuery,c=i.contentQueries;if(l&&vV(t,l),c&&wV(t,c),bp(t.inputs,i.inputs),bp(t.declaredInputs,i.declaredInputs),bp(t.outputs,i.outputs),Pr(i)&&i.data.animation){const u=t.data;u.animation=(u.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(t),a===rt&&(n=!1)}}e=Object.getPrototypeOf(e)}!function yV(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Gl(i.hostAttrs,n=Gl(n,i.hostAttrs))}}(r)}function gm(t){return t===Pi?{}:t===Qe?[]:t}function vV(t,e){const n=t.viewQuery;t.viewQuery=n?(r,i)=>{e(r,i),n(r,i)}:e}function wV(t,e){const n=t.contentQueries;t.contentQueries=n?(r,i,s)=>{e(r,i,s),n(r,i,s)}:e}function bV(t,e){const n=t.hostBindings;t.hostBindings=n?(r,i)=>{e(r,i),n(r,i)}:e}function fn(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Nd(t,e,n){const r=Z();return fn(r,aa(),e)&&function sr(t,e,n,r,i,s,o,a){const l=tr(e,n);let u,c=e.inputs;!a&&null!=c&&(u=c[r])?(hm(t,n,u,r,i),Ku(e)&&zC(n,e.index)):3&e.type&&(r=function UL(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(l,r,i))}(Ke(),function Dt(){const t=Te.lFrame;return Lp(t.tView,t.selectedIndex)}(),r,t,e,r[11],n,!1),Nd}function ym(t,e,n,r,i){const o=i?"class":"style";hm(t,n,e.inputs[o],o,r)}function go(t,e,n,r){const i=Z(),s=Ke(),o=22+t,a=i[11],l=i[o]=mg(a,e,function RR(){return Te.lFrame.currentNamespace}()),c=s.firstCreatePass?function RV(t,e,n,r,i,s,o){const a=e.consts,c=Sa(e,t,2,i,hs(a,s));return function am(t,e,n,r){let i=!1;if(M0()){const s=null===r?null:{"":-1},o=function WL(t,e){const n=t.directiveRegistry;let r=null,i=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];if(pC(e,o.selectors,!1))if(r||(r=[]),Pr(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),lm(t,e,a.length)}else r.unshift(o),lm(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(t,n);let a,l;null===o?a=l=null:[a,l]=o,null!==a&&(i=!0,GC(t,e,n,a,s,l)),s&&function qL(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const s=n[e[i+1]];if(null==s)throw new te(-301,!1);r.push(e[i],s)}}}(n,r,s)}return n.mergedAttrs=Gl(n.mergedAttrs,n.attrs),i}(e,n,c,hs(a,o)),null!==c.attrs&&Ad(c,c.attrs,!1),null!==c.mergedAttrs&&Ad(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,i,0,e,n,r):s.data[o];return oi(c,!0),L_(a,l,c),32!=(32&c.flags)&&dd(s,i,l,c),0===function mR(){return Te.lFrame.elementDepthCount}()&&dn(l,i),function yR(){Te.lFrame.elementDepthCount++}(),Ju(c)&&(function im(t,e,n){!M0()||(function zL(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;t.firstCreatePass||nd(n,e),dn(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const l=t.data[a],c=Pr(l);c&&ZL(e,n,l);const u=ua(e,t,a,n);dn(u,e),null!==o&&QL(0,a-i,u,l,0,o),c&&(nr(n.index,e)[8]=u)}}(t,e,n,tr(n,e)),64==(64&n.flags)&&WC(t,e,n))}(s,i,c),rm(s,c,i)),null!==r&&function sm(t,e,n=tr){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}(i,c),go}function mo(){let t=en();Bp()?function Up(){Te.lFrame.isParent=!1}():(t=t.parent,oi(t,!1));const e=t;!function vR(){Te.lFrame.elementDepthCount--}();const n=Ke();return n.firstCreatePass&&(Qu(n,t),Np(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function BR(t){return 0!=(8&t.flags)}(e)&&ym(n,e,Z(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function UR(t){return 0!=(16&t.flags)}(e)&&ym(n,e,Z(),e.stylesWithoutHost,!1),mo}function Od(t,e,n,r){return go(t,e,n,r),mo(),Od}function fc(t){return!!t&&"function"==typeof t.then}const bm=function hD(t){return!!t&&"function"==typeof t.subscribe};function jn(t,e,n,r){const i=Z(),s=Ke(),o=en();return function gD(t,e,n,r,i,s,o){const a=Ju(r),c=t.firstCreatePass&&JC(t),u=e[8],d=KC(e);let h=!0;if(3&r.type||o){const v=tr(r,e),w=o?o(v):v,k=d.length,z=o?ce=>o(jt(ce[r.index])):r.index;let B=null;if(!o&&a&&(B=function LV(t,e,n,r){const i=t.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===n&&i[s+1]===r){const a=e[7],l=i[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(t,e,i,r.index)),null!==B)(B.__ngLastListenerFn__||B).__ngNextListenerFn__=s,B.__ngLastListenerFn__=s,h=!1;else{s=yD(r,e,u,s,!1);const ce=n.listen(w,i,s);d.push(s,ce),c&&c.push(i,z,k,k+1)}}else s=yD(r,e,u,s,!1);const p=r.outputs;let m;if(h&&null!==p&&(m=p[i])){const v=m.length;if(v)for(let w=0;w<v;w+=2){const _e=e[m[w]][m[w+1]].subscribe(s),Je=d.length;d.push(s,_e),c&&c.push(i,r.index,Je,-(Je+1))}}}(s,i,i[11],o,t,e,r),jn}function mD(t,e,n,r){try{return!1!==n(r)}catch(i){return ZC(t,i),!1}}function yD(t,e,n,r,i){return function s(o){if(o===Function)return r;dm(t.componentOffset>-1?nr(t.index,e):e);let l=mD(e,0,r,o),c=s.__ngNextListenerFn__;for(;c;)l=mD(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return i&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function TD(t,e,n,r,i){const s=t[n+1],o=null===e;let a=r?Vr(s):$i(s),l=!1;for(;0!==a&&(!1===l||o);){const u=t[a+1];zV(t[a],e)&&(l=!0,t[a+1]=r?qg(u):Gg(u)),a=r?Vr(u):$i(u)}l&&(t[n+1]=r?Gg(s):qg(s))}function zV(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&ma(t,e)>=0}function Rd(t,e){return function Br(t,e,n,r){const i=Z(),s=Ke(),o=function Bi(t){const e=Te.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}(2);s.firstUpdatePass&&function PD(t,e,n,r){const i=t.data;if(null===i[n+1]){const s=i[Dn()],o=function FD(t,e){return e>=t.expandoStartIndex}(t,n);(function UD(t,e){return 0!=(t.flags&(e?8:16))})(s,r)&&null===e&&!o&&(e=!1),e=function XV(t,e,n,r){const i=function $p(t){const e=Te.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=hc(n=Cm(null,t,e,n,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==i)if(n=Cm(i,t,e,n,r),null===s){let l=function eB(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==$i(r))return t[Vr(r)]}(t,e,r);void 0!==l&&Array.isArray(l)&&(l=Cm(null,t,e,l[1],r),l=hc(l,e.attrs,r),function tB(t,e,n,r){t[Vr(n?e.classBindings:e.styleBindings)]=r}(t,e,r,l))}else s=function nB(t,e,n){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=hc(r,t[s].hostAttrs,n);return hc(r,e.attrs,n)}(t,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),n}(i,s,e,r),function $V(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Vr(o),l=$i(o);t[r]=n;let u,c=!1;if(Array.isArray(n)){const d=n;u=d[1],(null===u||ma(d,u)>0)&&(c=!0)}else u=n;if(i)if(0!==l){const h=Vr(t[a+1]);t[r+1]=_d(h,a),0!==h&&(t[h+1]=Wg(t[h+1],r)),t[a+1]=function DL(t,e){return 131071&t|e<<17}(t[a+1],r)}else t[r+1]=_d(a,0),0!==a&&(t[a+1]=Wg(t[a+1],r)),a=r;else t[r+1]=_d(l,0),0===a?a=r:t[l+1]=Wg(t[l+1],r),l=r;c&&(t[r+1]=Gg(t[r+1])),TD(t,u,r,!0),TD(t,u,r,!1),function HV(t,e,n,r,i){const s=i?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&ma(s,e)>=0&&(n[r+1]=qg(n[r+1]))}(e,u,t,r,s),o=_d(a,l),s?e.classBindings=o:e.styleBindings=o}(i,s,e,n,o,r)}}(s,t,o,r),e!==ke&&fn(i,o,e)&&function VD(t,e,n,r,i,s,o,a){if(!(3&e.type))return;const l=t.data,c=l[a+1];Fd(function kC(t){return 1==(1&t)}(c)?BD(l,e,n,i,$i(c),o):void 0)||(Fd(s)||function IC(t){return 2==(2&t)}(c)&&(s=BD(l,null,n,i,a,o)),function qF(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=-1===r.indexOf("-")?void 0:Bn.DashCase;null==i?t.removeStyle(n,r,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Bn.Important),t.setStyle(n,r,i,s))}}(r,o,Yu(Dn(),n),i,s))}(s,s.data[Dn()],i,i[11],t,i[o+1]=function sB(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=ut(function gs(t){return t instanceof $_?t.changingThisBreaksApplicationSecurity:t}(t)))),t}(e,n),r,o)}(t,e,null,!0),Rd}function Cm(t,e,n,r,i){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],r=hc(r,s.hostAttrs,i),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function hc(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),ir(t,o,!!n||e[++s]))}return void 0===t?null:t}function BD(t,e,n,r,i,s){const o=null===e;let a;for(;i>0;){const l=t[i],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=n[i+1];h===ke&&(h=d?Qe:void 0);let p=d?ng(h,r):u===r?h:void 0;if(c&&!Fd(p)&&(p=ng(l,r)),Fd(p)&&(a=p,o))return a;const m=t[i+1];i=o?Vr(m):$i(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=ng(l,r))}return a}function Fd(t){return void 0!==t}function Pd(t,e=""){const n=Z(),r=Ke(),i=t+22,s=r.firstCreatePass?Sa(r,i,1,e,null):r.data[i],o=n[i]=function gg(t,e){return t.createText(e)}(n[11],e);dd(r,n,o,s),oi(s,!1)}function Ld(t,e,n){const r=Z(),i=function Ma(t,e,n,r){return fn(t,aa(),n)?e+Ie(n)+r:ke}(r,t,e,n);return i!==ke&&function Hi(t,e,n){const r=Yu(e,t);!function D_(t,e,n){t.setValue(e,n)}(t[11],r,n)}(r,Dn(),i),Ld}const Pa="en-US";let cS=Pa;function Em(t,e,n,r,i){if(t=ye(t),Array.isArray(t))for(let s=0;s<t.length;s++)Em(t[s],e,n,r,i);else{const s=Ke(),o=Z();let a=fo(t)?t:ye(t.provide),l=oC(t);const c=en(),u=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(fo(t)||!t.multi){const p=new Hl(l,i,X),m=Tm(a,e,i?u:u+h,d);-1===m?(Qp(nd(c,o),s,a),Mm(s,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(p),o.push(p)):(n[m]=p,o[m]=p)}else{const p=Tm(a,e,u+h,d),m=Tm(a,e,u,u+h),v=p>=0&&n[p],w=m>=0&&n[m];if(i&&!w||!i&&!v){Qp(nd(c,o),s,a);const k=function D2(t,e,n,r,i){const s=new Hl(t,n,X);return s.multi=[],s.index=e,s.componentProviders=0,RS(s,i,r&&!n),s}(i?C2:_2,n.length,i,r,l);!i&&w&&(n[m].providerFactory=k),Mm(s,t,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(k),o.push(k)}else Mm(s,t,p>-1?p:m,RS(n[i?m:p],l,!i&&r));!i&&r&&w&&n[m].componentProviders++}}}function Mm(t,e,n,r){const i=fo(e),s=function DP(t){return!!t.useClass}(e);if(i||s){const l=(s?ye(e.useClass):e).prototype.ngOnDestroy;if(l){const c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){const u=c.indexOf(n);-1===u?c.push(n,[r,l]):c[u+1].push(r,l)}else c.push(n,l)}}}function RS(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Tm(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function _2(t,e,n,r){return Am(this.multi,[])}function C2(t,e,n,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=ua(n,n[1],this.providerFactory.index,r);s=a.slice(0,o),Am(i,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],Am(i,s);return s}function Am(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function bt(t,e=[]){return n=>{n.providersResolver=(r,i)=>function b2(t,e,n){const r=Ke();if(r.firstCreatePass){const i=Pr(t);Em(n,r.data,r.blueprint,i,!0),Em(e,r.data,r.blueprint,i,!1)}}(r,i?i(t):t,e)}}class vo{}class FS{}class PS extends vo{constructor(e,n){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new pm(this);const r=Xn(e);this._bootstrapComponents=ji(r.bootstrap),this._r3Injector=_C(e,n,[{provide:vo,useValue:this},{provide:sc,useValue:this.componentFactoryResolver}],ut(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Im extends FS{constructor(e){super(),this.moduleType=e}create(e){return new PS(this.moduleType,e)}}class E2 extends vo{constructor(e,n,r){super(),this.componentFactoryResolver=new pm(this),this.instance=null;const i=new sC([...e,{provide:vo,useValue:this},{provide:sc,useValue:this.componentFactoryResolver}],n||vd(),r,new Set(["environment"]));this.injector=i,i.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function $d(t,e,n=null){return new E2(t,e,n).injector}let M2=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n.id)){const r=tC(0,n.type),i=r.length>0?$d([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n.id,i)}return this.cachedInjectors.get(n.id)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return t.\u0275prov=Me({token:t,providedIn:"environment",factory:()=>new t(pe(ms))}),t})();function LS(t){t.getStandaloneInjector=e=>e.get(M2).getOrCreateStandaloneInjector(t)}function xm(t){return e=>{setTimeout(t,void 0,e)}}const At=class Q2 extends qt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&"object"==typeof e){const l=e;i=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=xm(s),i&&(i=xm(i)),o&&(o=xm(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof M&&e.add(a),a}};let jr=(()=>{class t{}return t.__NG_ELEMENT_ID__=rU,t})();function rU(){return function ZS(t,e){let n;const r=e[t.index];if(Fr(r))n=r;else{let i;if(8&t.type)i=jt(r);else{const s=e[11];i=s.createComment("");const o=tr(t,e);co(s,ud(s,o),i,function zF(t,e){return t.nextSibling(e)}(s,o),!1)}e[t.index]=n=function qC(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}(r,e,i,t),Md(e,n)}return new JS(n,t,e)}(en(),Z())}const iU=jr,JS=class extends iU{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return ba(this._hostTNode,this._hostLView)}get injector(){return new da(this._hostTNode,this._hostLView)}get parentInjector(){const e=rd(this._hostTNode,this._hostLView);if(j0(e)){const n=ca(e,this._hostLView),r=la(e);return new da(n[1].data[r+8],n)}return new da(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=YS(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,n,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const o=e.createEmbeddedView(n||{},s);return this.insert(o,i),o}createComponent(e,n,r,i,s){const o=e&&!function ql(t){return"function"==typeof t}(e);let a;if(o)a=n;else{const d=n||{};a=d.index,r=d.injector,i=d.projectableNodes,s=d.environmentInjector||d.ngModuleRef}const l=o?e:new cc(nt(e)),c=r||this.parentInjector;if(!s&&null==l.ngModule){const h=(o?c:this.parentInjector).get(ms,null);h&&(s=h)}const u=l.create(c,i,void 0,s);return this.insert(u.hostView,a),u}insert(e,n){const r=e._lView,i=r[1];if(function gR(t){return Fr(t[3])}(r)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=r[3],h=new JS(d,d[6],d[3]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(n),o=this._lContainer;!function BF(t,e,n,r){const i=10+r,s=n.length;r>0&&(n[i-1][4]=e),r<s-10?(e[4]=n[i],Q0(n,10+r,e)):(n.push(e),e[4]=null),e[3]=n;const o=e[17];null!==o&&n!==o&&function UF(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=64}(i,r,o,s);const a=bg(s,o),l=r[11],c=ud(l,o[7]);return null!==c&&function PF(t,e,n,r,i,s){r[0]=i,r[6]=e,tc(t,r,n,1,i,s)}(i,o[6],l,r,c,a),e.attachToViewContainerRef(),Q0(Om(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=YS(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=yg(this._lContainer,n);r&&(od(Om(this._lContainer),n),E_(r[1],r))}detach(e){const n=this._adjustIndex(e,-1),r=yg(this._lContainer,n);return r&&null!=od(Om(this._lContainer),n)?new lc(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function YS(t){return t[8]}function Om(t){return t[8]||(t[8]=[])}function Gd(...t){}const Wd=new fe("Application Initializer");let qd=(()=>{class t{constructor(n){this.appInits=n,this.resolve=Gd,this.reject=Gd,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const s=this.appInits[i]();if(fc(s))n.push(s);else if(bm(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});n.push(o)}}Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}}return t.\u0275fac=function(n){return new(n||t)(pe(Wd,8))},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Cc=new fe("AppId",{providedIn:"root",factory:function SE(){return`${Hm()}${Hm()}${Hm()}`}});function Hm(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const EE=new fe("Platform Initializer"),ME=new fe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),TE=new fe("appBootstrapListener");let RU=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const Gi=new fe("LocaleId",{providedIn:"root",factory:()=>st(Gi,ve.Optional|ve.SkipSelf)||function FU(){return typeof $localize<"u"&&$localize.locale||Pa}()});class LU{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}let zm=(()=>{class t{compileModuleSync(n){return new Im(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),s=ji(Xn(n).declarations).reduce((o,a)=>{const l=nt(a);return l&&o.push(new cc(l)),o},[]);return new LU(r,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const UU=(()=>Promise.resolve(0))();function Gm(t){typeof Zone>"u"?UU.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Lt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new At(!1),this.onMicrotaskEmpty=new At(!1),this.onStable=new At(!1),this.onError=new At(!1),typeof Zone>"u")throw new te(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function jU(){let t=pt.requestAnimationFrame,e=pt.cancelAnimationFrame;if(typeof Zone<"u"&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function zU(t){const e=()=>{!function HU(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(pt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,qm(t),t.isCheckStableRunning=!0,Wm(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),qm(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{try{return kE(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),xE(t)}},onInvoke:(n,r,i,s,o,a,l)=>{try{return kE(t),n.invoke(i,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),xE(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,qm(t),Wm(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Lt.isInAngularZone())throw new te(909,!1)}static assertNotInAngularZone(){if(Lt.isInAngularZone())throw new te(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,$U,Gd,Gd);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const $U={};function Wm(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function qm(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function kE(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function xE(t){t._nesting--,Wm(t)}class GU{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new At,this.onMicrotaskEmpty=new At,this.onStable=new At,this.onError=new At}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}const NE=new fe(""),Kd=new fe("");let Ym,Km=(()=>{class t{constructor(n,r,i){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Ym||(function WU(t){Ym=t}(i),i.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Lt.assertNotInAngularZone(),Gm(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Gm(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,i){return[]}}return t.\u0275fac=function(n){return new(n||t)(pe(Lt),pe(Jm),pe(Kd))},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})(),Jm=(()=>{class t{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return Ym?.findTestabilityInTree(this,n,r)??null}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})(),ws=null;const OE=new fe("AllowMultipleToken"),Zm=new fe("PlatformDestroyListeners");class RE{constructor(e,n){this.name=e,this.token=n}}function PE(t,e,n=[]){const r=`Platform: ${e}`,i=new fe(r);return(s=[])=>{let o=Qm();if(!o||o.injector.get(OE,!1)){const a=[...n,...s,{provide:i,useValue:!0}];t?t(a):function JU(t){if(ws&&!ws.get(OE,!1))throw new te(400,!1);ws=t;const e=t.get(VE);(function FE(t){const e=t.get(EE,null);e&&e.forEach(n=>n())})(t)}(function LE(t=[],e){return yr.create({name:e,providers:[{provide:Og,useValue:"platform"},{provide:Zm,useValue:new Set([()=>ws=null])},...t]})}(a,r))}return function ZU(t){const e=Qm();if(!e)throw new te(401,!1);return e}()}}function Qm(){return ws?.get(VE)??null}let VE=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const i=function UE(t,e){let n;return n="noop"===t?new GU:("zone.js"===t?void 0:t)||new Lt(e),n}(r?.ngZone,function BE(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(r)),s=[{provide:Lt,useValue:i}];return i.run(()=>{const o=yr.create({providers:s,parent:this.injector,name:n.moduleType.name}),a=n.create(o),l=a.injector.get(_a,null);if(!l)throw new te(402,!1);return i.runOutsideAngular(()=>{const c=i.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{Yd(this._modules,a),c.unsubscribe()})}),function jE(t,e,n){try{const r=n();return fc(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(l,i,()=>{const c=a.injector.get(qd);return c.runInitializers(),c.donePromise.then(()=>(function uS(t){Qn(t,"Expected localeId to be defined"),"string"==typeof t&&(cS=t.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Gi,Pa)||Pa),this._moduleDoBootstrap(a),a))})})}bootstrapModule(n,r=[]){const i=$E({},r);return function qU(t,e,n){const r=new Im(n);return Promise.resolve(r)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(n){const r=n.injector.get(Jd);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new te(403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new te(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(Zm,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(n){return new(n||t)(pe(yr))},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function $E(t,e){return Array.isArray(e)?e.reduce($E,t):{...t,...e}}let Jd=(()=>{class t{constructor(n,r,i){this._zone=n,this._injector=r,this._exceptionHandler=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new vt(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new vt(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{Lt.assertNotInAngularZone(),Gm(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{Lt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=function kO(...t){const e=Nl(t),n=function DO(t,e){return"number"==typeof vp(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?xr(r[0]):ea(n)(Ft(r,e)):Ri}(s,o.pipe(function xO(t={}){const{connector:e=(()=>new qt),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,l,c=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},p=()=>{h(),o=l=void 0,u=d=!1},m=()=>{const v=o;p(),v?.unsubscribe()};return ht((v,w)=>{c++,!d&&!u&&h();const k=l=l??e();w.add(()=>{c--,0===c&&!d&&!u&&(a=wp(m,i))}),k.subscribe(w),!o&&c>0&&(o=new N({next:z=>k.next(z),error:z=>{d=!0,h(),a=wp(p,n,z),k.error(z)},complete:()=>{u=!0,h(),a=wp(p,r),k.complete()}}),xr(v).subscribe(o))})(s)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const i=n instanceof aC;if(!this._injector.get(qd).done)throw!i&&function na(t){const e=nt(t)||ln(t)||_n(t);return null!==e&&e.standalone}(n),new te(405,false);let o;o=i?n:this._injector.get(sc).resolveComponentFactory(n),this.componentTypes.push(o.componentType);const a=function KU(t){return t.isBoundToModule}(o)?void 0:this._injector.get(vo),c=o.create(yr.NULL,[],r||o.selector,a),u=c.location.nativeElement,d=c.injector.get(NE,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),Yd(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new te(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;Yd(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(TE,[]).concat(this._bootstrapListeners).forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Yd(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new te(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(n){return new(n||t)(pe(Lt),pe(ms),pe(_a))},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Yd(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}let Dc=(()=>{class t{}return t.__NG_ELEMENT_ID__=XU,t})();function XU(t){return function ej(t,e,n){if(Ku(t)&&!n){const r=nr(t.index,e);return new lc(r,r)}return 47&t.type?new lc(e[16],e):null}(en(),Z(),16==(16&t))}const hj=PE(null,"core",[]);let pj=(()=>{class t{constructor(n){}}return t.\u0275fac=function(n){return new(n||t)(pe(Jd))},t.\u0275mod=Or({type:t}),t.\u0275inj=fr({}),t})();let ef=null;function pi(){return ef}class yj{}const $n=new fe("DocumentToken");let ry=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:function(){return function vj(){return pe(XE)}()},providedIn:"platform"}),t})();const wj=new fe("Location Initialized");let XE=(()=>{class t extends ry{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return pi().getBaseHref(this._doc)}onPopState(n){const r=pi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=pi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,r,i){eM()?this._history.pushState(n,r,i):this.location.hash=i}replaceState(n,r,i){eM()?this._history.replaceState(n,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return t.\u0275fac=function(n){return new(n||t)(pe($n))},t.\u0275prov=Me({token:t,factory:function(){return function bj(){return new XE(pe($n))}()},providedIn:"platform"}),t})();function eM(){return!!window.history.pushState}function iy(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function tM(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function qi(t){return t&&"?"!==t[0]?"?"+t:t}let bo=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:function(){return st(rM)},providedIn:"root"}),t})();const nM=new fe("appBaseHref");let rM=(()=>{class t extends bo{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??st($n).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return iy(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+qi(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,s){const o=this.prepareExternalUrl(i+qi(s));this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){const o=this.prepareExternalUrl(i+qi(s));this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return t.\u0275fac=function(n){return new(n||t)(pe(ry),pe(nM,8))},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),_j=(()=>{class t extends bo{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=iy(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,s){let o=this.prepareExternalUrl(i+qi(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){let o=this.prepareExternalUrl(i+qi(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return t.\u0275fac=function(n){return new(n||t)(pe(ry),pe(nM,8))},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})(),sy=(()=>{class t{constructor(n){this._subject=new At,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._baseHref=tM(iM(r)),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+qi(r))}normalize(n){return t.stripTrailingSlash(function Dj(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,iM(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+qi(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+qi(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r,complete:i})}}return t.normalizeQueryParams=qi,t.joinWithSlash=iy,t.stripTrailingSlash=tM,t.\u0275fac=function(n){return new(n||t)(pe(bo))},t.\u0275prov=Me({token:t,factory:function(){return function Cj(){return new sy(pe(bo))}()},providedIn:"root"}),t})();function iM(t){return t.replace(/\/index.html$/,"")}let $$=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Or({type:t}),t.\u0275inj=fr({}),t})();let W$=(()=>{class t{}return t.\u0275prov=Me({token:t,providedIn:"root",factory:()=>new q$(pe($n),window)}),t})();class q${constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function K$(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=e)}}scrollToElement(e){const n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=bM(this.window.history)||bM(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function bM(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class CH extends yj{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class _y extends CH{static makeCurrent(){!function mj(t){ef||(ef=t)}(new _y)}onAndCancel(e,n,r){return e.addEventListener(n,r,!1),()=>{e.removeEventListener(n,r,!1)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function DH(){return Ac=Ac||document.querySelector("base"),Ac?Ac.getAttribute("href"):null}();return null==n?null:function SH(t){hf=hf||document.createElement("a"),hf.setAttribute("href",t);const e=hf.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){Ac=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function o$(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,s]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let hf,Ac=null;const MM=new fe("TRANSITION_ID"),MH=[{provide:Wd,useFactory:function EH(t,e,n){return()=>{n.get(qd).donePromise.then(()=>{const r=pi(),i=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<i.length;s++)r.remove(i[s])})}},deps:[MM,$n,yr],multi:!0}];let AH=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})();const pf=new fe("EventManagerPlugins");let gf=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>i.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}addGlobalEventListener(n,r,i){return this._findPluginFor(r).addGlobalEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const i=this._plugins;for(let s=0;s<i.length;s++){const o=i[s];if(o.supports(n))return this._eventNameToPlugin.set(n,o),o}throw new Error(`No event manager plugin found for event ${n}`)}}return t.\u0275fac=function(n){return new(n||t)(pe(pf),pe(Lt))},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})();class TM{constructor(e){this._doc=e}addGlobalEventListener(e,n,r){const i=pi().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${n}`);return this.addEventListener(i,n,r)}}let AM=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(n){const r=new Set;n.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})(),Ic=(()=>{class t extends AM{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,r,i){n.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,i.push(r.appendChild(o))})}addHost(n){const r=[];this._addStylesToHost(this._stylesSet,n,r),this._hostNodes.set(n,r)}removeHost(n){const r=this._hostNodes.get(n);r&&r.forEach(IM),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(n,i,r)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(IM))}}return t.\u0275fac=function(n){return new(n||t)(pe($n))},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})();function IM(t){pi().remove(t)}const Cy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Dy=/%COMP%/g;function mf(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?mf(t,i,n):(i=i.replace(Dy,t),n.push(i))}return n}function NM(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Sy=(()=>{class t{constructor(n,r,i){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Ey(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;switch(r.encapsulation){case si.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new RH(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(n),i}case 1:case si.ShadowDom:return new FH(this.eventManager,this.sharedStylesHost,n,r);default:if(!this.rendererByCompId.has(r.id)){const i=mf(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(n){return new(n||t)(pe(gf),pe(Ic),pe(Cc))},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})();class Ey{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,n){return n?document.createElementNS(Cy[n]||n,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,n){(RM(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(RM(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const s=Cy[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=Cy[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Bn.DashCase|Bn.Important)?e.style.setProperty(n,r,i&Bn.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Bn.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,n,NM(r)):this.eventManager.addEventListener(e,n,NM(r))}}function RM(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class RH extends Ey{constructor(e,n,r,i){super(e),this.component=r;const s=mf(i+"-"+r.id,r.styles,[]);n.addStyles(s),this.contentAttr=function xH(t){return"_ngcontent-%COMP%".replace(Dy,t)}(i+"-"+r.id),this.hostAttr=function NH(t){return"_nghost-%COMP%".replace(Dy,t)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}class FH extends Ey{constructor(e,n,r,i){super(e),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=mf(i.id,i.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let PH=(()=>{class t extends TM{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}}return t.\u0275fac=function(n){return new(n||t)(pe($n))},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})();const FM=["alt","control","meta","shift"],LH={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},VH={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let BH=(()=>{class t extends TM{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const s=t.parseEventName(r),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>pi().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=t._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),FM.forEach(c=>{const u=r.indexOf(c);u>-1&&(r.splice(u,1),o+=c+".")}),o+=s,0!=r.length||0===s.length)return null;const l={};return l.domEventName=i,l.fullKey=o,l}static matchEventFullKeyCode(n,r){let i=LH[n.key]||n.key,s="";return r.indexOf("code.")>-1&&(i=n.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),FM.forEach(o=>{o!==i&&(0,VH[o])(n)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(n,r,i){return s=>{t.matchEventFullKeyCode(s,n)&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return t.\u0275fac=function(n){return new(n||t)(pe($n))},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})();const LM=[{provide:ME,useValue:"browser"},{provide:EE,useValue:function UH(){_y.makeCurrent()},multi:!0},{provide:$n,useFactory:function $H(){return function QF(t){Sg=t}(document),document},deps:[]}],HH=PE(hj,"browser",LM),VM=new fe(""),BM=[{provide:Kd,useClass:class TH{addToWindow(e){pt.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new Error("Could not find testability for element.");return s},pt.getAllAngularTestabilities=()=>e.getAllTestabilities(),pt.getAllAngularRootElements=()=>e.getAllRootElements(),pt.frameworkStabilizers||(pt.frameworkStabilizers=[]),pt.frameworkStabilizers.push(r=>{const i=pt.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(l){o=o||l,s--,0==s&&r(o)};i.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,n,r){return null==n?null:e.getTestability(n)??(r?pi().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},deps:[]},{provide:NE,useClass:Km,deps:[Lt,Jm,Kd]},{provide:Km,useClass:Km,deps:[Lt,Jm,Kd]}],UM=[{provide:Og,useValue:"root"},{provide:_a,useFactory:function jH(){return new _a},deps:[]},{provide:pf,useClass:PH,multi:!0,deps:[$n,Lt,ME]},{provide:pf,useClass:BH,multi:!0,deps:[$n]},{provide:Sy,useClass:Sy,deps:[gf,Ic,Cc]},{provide:cC,useExisting:Sy},{provide:AM,useExisting:Ic},{provide:Ic,useClass:Ic,deps:[$n]},{provide:gf,useClass:gf,deps:[pf,Lt]},{provide:class J${},useClass:AH,deps:[]},[]];let zH=(()=>{class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:Cc,useValue:n.appId},{provide:MM,useExisting:Cc},MH]}}}return t.\u0275fac=function(n){return new(n||t)(pe(VM,12))},t.\u0275mod=Or({type:t}),t.\u0275inj=fr({providers:[...UM,...BM],imports:[$$,pj]}),t})(),jM=(()=>{class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return t.\u0275fac=function(n){return new(n||t)(pe($n))},t.\u0275prov=Me({token:t,factory:function(n){let r=null;return r=n?new n:function WH(){return new jM(pe($n))}(),r},providedIn:"root"}),t})();typeof window<"u"&&window;const{isArray:e3}=Array,{getPrototypeOf:t3,prototype:n3,keys:r3}=Object;function zM(t){if(1===t.length){const e=t[0];if(e3(e))return{args:e,keys:null};if(function i3(t){return t&&"object"==typeof t&&t3(t)===n3}(e)){const n=r3(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}const{isArray:s3}=Array;function GM(t){return xe(e=>function o3(t,e){return s3(e)?t(...e):t(e)}(t,e))}function WM(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}let qM=(()=>{class t{constructor(n,r){this._renderer=n,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return t.\u0275fac=function(n){return new(n||t)(X(li),X(Un))},t.\u0275dir=De({type:t}),t})(),_o=(()=>{class t extends qM{}return t.\u0275fac=function(){let e;return function(r){return(e||(e=tn(t)))(r||t)}}(),t.\u0275dir=De({type:t,features:[rt]}),t})();const Gr=new fe("NgValueAccessor"),c3={provide:Gr,useExisting:dt(()=>yf),multi:!0},d3=new fe("CompositionEventMode");let yf=(()=>{class t extends qM{constructor(n,r,i){super(n,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function u3(){const t=pi()?pi().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return t.\u0275fac=function(n){return new(n||t)(X(li),X(Un),X(d3,8))},t.\u0275dir=De({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){1&n&&jn("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[bt([c3]),rt]}),t})();const hn=new fe("NgValidators"),Cs=new fe("NgAsyncValidators");function i1(t){return null!=t}function s1(t){return fc(t)?Ft(t):t}function o1(t){let e={};return t.forEach(n=>{e=null!=n?{...e,...n}:e}),0===Object.keys(e).length?null:e}function a1(t,e){return e.map(n=>n(t))}function l1(t){return t.map(e=>function p3(t){return!t.validate}(e)?e:n=>e.validate(n))}function Ay(t){return null!=t?function c1(t){if(!t)return null;const e=t.filter(i1);return 0==e.length?null:function(n){return o1(a1(n,e))}}(l1(t)):null}function Iy(t){return null!=t?function u1(t){if(!t)return null;const e=t.filter(i1);return 0==e.length?null:function(n){return function a3(...t){const e=r0(t),{args:n,keys:r}=zM(t),i=new vt(s=>{const{length:o}=n;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let d=!1;xr(n[u]).subscribe(wt(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(r?WM(r,a):a),s.complete())}))}});return e?i.pipe(GM(e)):i}(a1(n,e).map(s1)).pipe(xe(o1))}}(l1(t)):null}function d1(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function ky(t){return t?Array.isArray(t)?t:[t]:[]}function wf(t,e){return Array.isArray(t)?t.includes(e):t===e}function p1(t,e){const n=ky(e);return ky(t).forEach(i=>{wf(n,i)||n.push(i)}),n}function g1(t,e){return ky(e).filter(n=>!wf(t,n))}class m1{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ay(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Iy(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,n){return!!this.control&&this.control.hasError(e,n)}getError(e,n){return this.control?this.control.getError(e,n):null}}class Tn extends m1{get formDirective(){return null}get path(){return null}}class Ds extends m1{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class y1{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let v1=(()=>{class t extends y1{constructor(n){super(n)}}return t.\u0275fac=function(n){return new(n||t)(X(Ds,2))},t.\u0275dir=De({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){2&n&&Rd("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[rt]}),t})();const kc="VALID",_f="INVALID",Ua="PENDING",xc="DISABLED";function Cf(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class C1{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===kc}get invalid(){return this.status===_f}get pending(){return this.status==Ua}get disabled(){return this.status===xc}get enabled(){return this.status!==xc}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(p1(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(p1(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(g1(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(g1(e,this._rawAsyncValidators))}hasValidator(e){return wf(this._rawValidators,e)}hasAsyncValidator(e){return wf(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ua,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=xc,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=kc,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===kc||this.status===Ua)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?xc:kc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ua,this._hasOwnPendingAsyncValidator=!0;const n=s1(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(!1!==n.emitEvent)}get(e){let n=e;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){const r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new At,this.statusChanges=new At}_calculateStatus(){return this._allControlsDisabled()?xc:this.errors?_f:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ua)?Ua:this._anyControlsHaveStatus(_f)?_f:kc}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Cf(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function C3(t){return Array.isArray(t)?Ay(t):t||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function D3(t){return Array.isArray(t)?Iy(t):t||null}(this._rawAsyncValidators)}}const Nc=new fe("CallSetDisabledState",{providedIn:"root",factory:()=>Ly}),Ly="always";function Oc(t,e,n=Ly){(function Vy(t,e){const n=function f1(t){return t._rawValidators}(t);null!==e.validator?t.setValidators(d1(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const r=function h1(t){return t._rawAsyncValidators}(t);null!==e.asyncValidator?t.setAsyncValidators(d1(r,e.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const i=()=>t.updateValueAndValidity();Ef(e._rawValidators,i),Ef(e._rawAsyncValidators,i)})(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||"always"===n)&&e.valueAccessor.setDisabledState?.(t.disabled),function M3(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&D1(t,e)})}(t,e),function A3(t,e){const n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function T3(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&D1(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function E3(t,e){if(e.valueAccessor.setDisabledState){const n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function Ef(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function D1(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function M1(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function T1(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const A1=class extends C1{constructor(e=null,n,r){super(function Ry(t){return(Cf(t)?t.validators:t)||null}(n),function Fy(t,e){return(Cf(e)?e.asyncValidators:t)||null}(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Cf(n)&&(n.nonNullable||n.initialValueIsDefault)&&(this.defaultValue=T1(e)?e.value:e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){M1(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){M1(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){T1(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},P3={provide:Ds,useExisting:dt(()=>Hy)},x1=(()=>Promise.resolve())();let Hy=(()=>{class t extends Ds{constructor(n,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new A1,this._registered=!1,this.update=new At,this._parent=n,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function jy(t,e){if(!e)return null;let n,r,i;return Array.isArray(e),e.forEach(s=>{s.constructor===yf?n=s:function x3(t){return Object.getPrototypeOf(t.constructor)===_o}(s)?r=s:i=s}),i||r||n||null}(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),function Uy(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Oc(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){x1.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const r=n.isDisabled.currentValue,i=0!==r&&function Ba(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}(r);x1.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?function Df(t,e){return[...e.path,t]}(n,this._parent):[n]}}return t.\u0275fac=function(n){return new(n||t)(X(Tn,9),X(hn,10),X(Cs,10),X(Gr,10),X(Dc,8),X(Nc,8))},t.\u0275dir=De({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[bt([P3]),rt,gr]}),t})(),O1=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Or({type:t}),t.\u0275inj=fr({}),t})(),a8=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Or({type:t}),t.\u0275inj=fr({imports:[O1]}),t})(),l8=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:Nc,useValue:n.callSetDisabledState??Ly}]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Or({type:t}),t.\u0275inj=fr({imports:[a8]}),t})(),u8=(()=>{class t{constructor(n,r,i){this.elRef=n,this.renderer=r,this.changeDetectorRef=i,this.outputFormat="html",this.onChange=()=>{},this.onTouched=()=>{},this.handleChange=({transaction:s})=>{if(s.docChanged){if("html"===this.outputFormat)return void this.onChange(this.editor.getHTML());this.onChange(this.editor.getJSON())}}}writeValue(n){!this.outputFormat&&"string"==typeof n&&(this.outputFormat="html"),this.editor.chain().setContent(n,!1).run()}registerOnChange(n){this.onChange=n}registerOnTouched(n){this.onTouched=n}setDisabledState(n){this.editor.setEditable(!n),this.renderer.setProperty(this.elRef.nativeElement,"disabled",n)}ngOnInit(){if(!this.editor)throw new Error("Required: Input `editor`");const{innerHTML:n}=this.elRef.nativeElement;this.elRef.nativeElement.innerHTML="",this.elRef.nativeElement.append(...Array.from(this.editor.options.element.childNodes)),this.editor.setOptions({element:this.elRef.nativeElement}),n&&this.editor.chain().setContent(n,!1).run(),this.editor.on("blur",()=>{this.onTouched()}),this.editor.on("transaction",this.handleChange)}ngAfterViewInit(){this.changeDetectorRef.detectChanges()}}return t.\u0275fac=function(n){return new(n||t)(X(Un),X(li),X(Dc))},t.\u0275dir=De({type:t,selectors:[["tiptap","editor",""],["","tiptap","","editor",""],["tiptap-editor","editor",""],["","tiptapEditor","","editor",""]],inputs:{editor:"editor",outputFormat:"outputFormat"},features:[bt([{provide:Gr,useExisting:dt(()=>t),multi:!0}])]}),t})(),d8=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Or({type:t}),t.\u0275inj=fr({}),t})();function me(...t){return Ft(t,Nl(t))}class Wr extends qt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}const Tf=K(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Z1(...t){const e=Nl(t),n=r0(t),{args:r,keys:i}=zM(t);if(0===r.length)return Ft([],e);const s=new vt(function p8(t,e,n=ot){return r=>{Q1(e,()=>{const{length:i}=t,s=new Array(i);let o=i,a=i;for(let l=0;l<i;l++)Q1(e,()=>{const c=Ft(t[l],e);let u=!1;c.subscribe(wt(r,d=>{s[l]=d,u||(u=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,i?o=>WM(i,o):ot));return n?s.pipe(GM(n)):s}function Q1(t,e,n){t?Oi(n,t,e):e()}function Yy(...t){return function g8(){return ea(1)}()(Ft(t,Nl(t)))}function X1(t){return new vt(e=>{xr(t()).subscribe(e)})}function Fc(t,e){const n=Re(t)?t:()=>t,r=i=>i.error(n());return new vt(e?i=>e.schedule(r,0,i):r)}function Zy(){return ht((t,e)=>{let n=null;t._refCount++;const r=wt(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(n=null);const i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}class eT extends vt{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Ir(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new M;const n=this.getSubject();e.add(this.source.subscribe(wt(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=M.EMPTY)}return e}refCount(){return Zy()(this)}}function gi(t,e){return ht((n,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();n.subscribe(wt(r,l=>{i?.unsubscribe();let c=0;const u=s++;xr(t(l,u)).subscribe(i=wt(r,d=>r.next(e?e(l,d,u,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Pc(t){return t<=0?()=>Ri:ht((e,n)=>{let r=0;e.subscribe(wt(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Ss(t,e){return ht((n,r)=>{let i=0;n.subscribe(wt(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Af(t){return ht((e,n)=>{let r=!1;e.subscribe(wt(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function tT(t=y8){return ht((e,n)=>{let r=!1;e.subscribe(wt(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function y8(){return new Tf}function Es(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Ss((i,s)=>t(i,s,r)):ot,Pc(1),n?Af(e):tT(()=>new Tf))}function Do(t,e){return Re(e)?Xt(t,e,1):Xt(t,1)}function pn(t,e,n){const r=Re(t)||e||n?{next:t,error:e,complete:n}:t;return r?ht((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(wt(s,l=>{var c;null===(c=r.next)||void 0===c||c.call(r,l),s.next(l)},()=>{var l;a=!1,null===(l=r.complete)||void 0===l||l.call(r),s.complete()},l=>{var c;a=!1,null===(c=r.error)||void 0===c||c.call(r,l),s.error(l)},()=>{var l,c;a&&(null===(l=r.unsubscribe)||void 0===l||l.call(r)),null===(c=r.finalize)||void 0===c||c.call(r)}))}):ot}function Ms(t){return ht((e,n)=>{let s,r=null,i=!1;r=e.subscribe(wt(n,void 0,void 0,o=>{s=xr(t(o,Ms(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function v8(t,e,n,r,i){return(s,o)=>{let a=n,l=e,c=0;s.subscribe(wt(o,u=>{const d=c++;l=a?t(l,u,d):(a=!0,u),r&&o.next(l)},i&&(()=>{a&&o.next(l),o.complete()})))}}function nT(t,e){return ht(v8(t,e,arguments.length>=2,!0))}function Qy(t){return t<=0?()=>Ri:ht((e,n)=>{let r=[];e.subscribe(wt(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(const i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function rT(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Ss((i,s)=>t(i,s,r)):ot,Qy(1),n?Af(e):tT(()=>new Tf))}function Xy(t){return ht((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}const He="primary",Lc=Symbol("RouteTitle");class _8{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function ja(t){return new _8(t)}function C8(t,e,n){const r=n.path.split("/");if(r.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function mi(t,e){const n=t?Object.keys(t):void 0,r=e?Object.keys(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!iT(t[i],e[i]))return!1;return!0}function iT(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}return t===e}function sT(t){return Array.prototype.concat.apply([],t)}function oT(t){return t.length>0?t[t.length-1]:null}function nn(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Ts(t){return bm(t)?t:fc(t)?Ft(Promise.resolve(t)):me(t)}const If=!1,S8={exact:function cT(t,e,n){if(!Eo(t.segments,e.segments)||!kf(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!cT(t.children[r],e.children[r],n))return!1;return!0},subset:uT},aT={exact:function E8(t,e){return mi(t,e)},subset:function M8(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>iT(t[n],e[n]))},ignored:()=>!0};function lT(t,e,n){return S8[n.paths](t.root,e.root,n.matrixParams)&&aT[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function uT(t,e,n){return dT(t,e,e.segments,n)}function dT(t,e,n,r){if(t.segments.length>n.length){const i=t.segments.slice(0,n.length);return!(!Eo(i,n)||e.hasChildren()||!kf(i,n,r))}if(t.segments.length===n.length){if(!Eo(t.segments,n)||!kf(t.segments,n,r))return!1;for(const i in e.children)if(!t.children[i]||!uT(t.children[i],e.children[i],r))return!1;return!0}{const i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!(Eo(t.segments,i)&&kf(t.segments,i,r)&&t.children[He])&&dT(t.children[He],e,s,r)}}function kf(t,e,n){return e.every((r,i)=>aT[n](t[i].parameters,r.parameters))}class So{constructor(e=new ze([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ja(this.queryParams)),this._queryParamMap}toString(){return I8.serialize(this)}}class ze{constructor(e,n){this.segments=e,this.children=n,this.parent=null,nn(n,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return xf(this)}}class Vc{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=ja(this.parameters)),this._parameterMap}toString(){return gT(this)}}function Eo(t,e){return t.length===e.length&&t.every((n,r)=>n.path===e[r].path)}let fT=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:function(){return new ev},providedIn:"root"}),t})();class ev{parse(e){const n=new V8(e);return new So(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${Bc(e.root,!0)}`,r=function N8(t){const e=Object.keys(t).map(n=>{const r=t[n];return Array.isArray(r)?r.map(i=>`${Nf(n)}=${Nf(i)}`).join("&"):`${Nf(n)}=${Nf(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${n}${r}${"string"==typeof e.fragment?`#${function k8(t){return encodeURI(t)}(e.fragment)}`:""}`}}const I8=new ev;function xf(t){return t.segments.map(e=>gT(e)).join("/")}function Bc(t,e){if(!t.hasChildren())return xf(t);if(e){const n=t.children[He]?Bc(t.children[He],!1):"",r=[];return nn(t.children,(i,s)=>{s!==He&&r.push(`${s}:${Bc(i,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function A8(t,e){let n=[];return nn(t.children,(r,i)=>{i===He&&(n=n.concat(e(r,i)))}),nn(t.children,(r,i)=>{i!==He&&(n=n.concat(e(r,i)))}),n}(t,(r,i)=>i===He?[Bc(t.children[He],!1)]:[`${i}:${Bc(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[He]?`${xf(t)}/${n[0]}`:`${xf(t)}/(${n.join("//")})`}}function hT(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Nf(t){return hT(t).replace(/%3B/gi,";")}function tv(t){return hT(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Of(t){return decodeURIComponent(t)}function pT(t){return Of(t.replace(/\+/g,"%20"))}function gT(t){return`${tv(t.path)}${function x8(t){return Object.keys(t).map(e=>`;${tv(e)}=${tv(t[e])}`).join("")}(t.parameters)}`}const O8=/^[^\/()?;=#]+/;function Rf(t){const e=t.match(O8);return e?e[0]:""}const R8=/^[^=?&#]+/,P8=/^[^&#]+/;class V8{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ze([],{}):new ze([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[He]=new ze(e,n)),r}parseSegment(){const e=Rf(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new te(4009,If);return this.capture(e),new Vc(Of(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=Rf(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const i=Rf(this.remaining);i&&(r=i,this.capture(r))}e[Of(n)]=Of(r)}parseQueryParam(e){const n=function F8(t){const e=t.match(R8);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const o=function L8(t){const e=t.match(P8);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=pT(n),s=pT(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=Rf(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new te(4010,If);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=He);const o=this.parseChildren();n[s]=1===Object.keys(o).length?o[He]:new ze([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new te(4011,If)}}function nv(t){return t.segments.length>0?new ze([],{[He]:t}):t}function Ff(t){const e={};for(const r of Object.keys(t.children)){const s=Ff(t.children[r]);(s.segments.length>0||s.hasChildren())&&(e[r]=s)}return function B8(t){if(1===t.numberOfChildren&&t.children[He]){const e=t.children[He];return new ze(t.segments.concat(e.segments),e.children)}return t}(new ze(t.segments,e))}function Mo(t){return t instanceof So}function $8(t,e,n,r,i){if(0===n.length)return $a(e.root,e.root,e.root,r,i);const s=function vT(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new yT(!0,0,t);let e=0,n=!1;const r=t.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return nn(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?n=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new yT(n,e,r)}(n);return s.toRoot()?$a(e.root,e.root,new ze([],{}),r,i):function o(l){const c=function z8(t,e,n,r){if(t.isAbsolute)return new Ha(e.root,!0,0);if(-1===r)return new Ha(n,n===e.root,0);return function wT(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new te(4005,!1);i=r.segments.length}return new Ha(r,!1,i-s)}(n,r+(Uc(t.commands[0])?0:1),t.numberOfDoubleDots)}(s,e,t.snapshot?._urlSegment,l),u=c.processChildren?$c(c.segmentGroup,c.index,s.commands):iv(c.segmentGroup,c.index,s.commands);return $a(e.root,c.segmentGroup,u,r,i)}(t.snapshot?._lastPathIndex)}function Uc(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function jc(t){return"object"==typeof t&&null!=t&&t.outlets}function $a(t,e,n,r,i){let o,s={};r&&nn(r,(l,c)=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=t===e?n:mT(t,e,n);const a=nv(Ff(o));return new So(a,s,i)}function mT(t,e,n){const r={};return nn(t.children,(i,s)=>{r[s]=i===e?n:mT(i,e,n)}),new ze(t.segments,r)}class yT{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Uc(r[0]))throw new te(4003,!1);const i=r.find(jc);if(i&&i!==oT(r))throw new te(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Ha{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}}function iv(t,e,n){if(t||(t=new ze([],{})),0===t.segments.length&&t.hasChildren())return $c(t,e,n);const r=function W8(t,e,n){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;const o=t.segments[i],a=n[r];if(jc(a))break;const l=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!_T(l,c,o))return s;r+=2}else{if(!_T(l,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const s=new ze(t.segments.slice(0,r.pathIndex),{});return s.children[He]=new ze(t.segments.slice(r.pathIndex),t.children),$c(s,0,i)}return r.match&&0===i.length?new ze(t.segments,{}):r.match&&!t.hasChildren()?sv(t,e,n):r.match?$c(t,0,i):sv(t,e,n)}function $c(t,e,n){if(0===n.length)return new ze(t.segments,{});{const r=function G8(t){return jc(t[0])?t[0].outlets:{[He]:t}}(n),i={};return nn(r,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(i[o]=iv(t.children[o],e,s))}),nn(t.children,(s,o)=>{void 0===r[o]&&(i[o]=s)}),new ze(t.segments,i)}}function sv(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){const s=n[i];if(jc(s)){const l=q8(s.outlets);return new ze(r,l)}if(0===i&&Uc(n[0])){r.push(new Vc(t.segments[e].path,bT(n[0]))),i++;continue}const o=jc(s)?s.outlets[He]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Uc(a)?(r.push(new Vc(o,bT(a))),i+=2):(r.push(new Vc(o,{})),i++)}return new ze(r,{})}function q8(t){const e={};return nn(t,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(e[r]=sv(new ze([],{}),0,n))}),e}function bT(t){const e={};return nn(t,(n,r)=>e[r]=`${n}`),e}function _T(t,e,n){return t==n.path&&mi(e,n.parameters)}class Ji{constructor(e,n){this.id=e,this.url=n}}class ov extends Ji{constructor(e,n,r="imperative",i=null){super(e,n),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class To extends Ji{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Pf extends Ji{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class CT extends Ji{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class K8 extends Ji{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class J8 extends Ji{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Y8 extends Ji{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Z8 extends Ji{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Q8 extends Ji{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class X8{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ez{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class tz{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nz{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rz{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class iz{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class DT{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ST{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=av(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){const n=av(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=lv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return lv(e,this._root).map(n=>n.value)}}function av(t,e){if(t===e.value)return e;for(const n of e.children){const r=av(t,n);if(r)return r}return null}function lv(t,e){if(t===e.value)return[e];for(const n of e.children){const r=lv(t,n);if(r.length)return r.unshift(e),r}return[]}class Yi{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function za(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class ET extends ST{constructor(e,n){super(e),this.snapshot=n,cv(this,e)}toString(){return this.snapshot.toString()}}function MT(t,e){const n=function oz(t,e){const o=new Lf([],{},{},"",{},He,e,null,t.root,-1,{});return new AT("",new Yi(o,[]))}(t,e),r=new Wr([new Vc("",{})]),i=new Wr({}),s=new Wr({}),o=new Wr({}),a=new Wr(""),l=new Ga(r,i,o,a,s,He,e,n.root);return l.snapshot=n.root,new ET(new Yi(l,[]),n)}class Ga{constructor(e,n,r,i,s,o,a,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.title=this.data?.pipe(xe(c=>c[Lc]))??me(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(xe(e=>ja(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(xe(e=>ja(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function TT(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const i=n[r],s=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(s.component)break;r--}}return function az(t){return t.reduce((e,n)=>({params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.resolve,...n.routeConfig?.data,...n._resolvedData}}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Lf{constructor(e,n,r,i,s,o,a,l,c,u,d){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=d}get title(){return this.data?.[Lc]}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ja(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ja(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class AT extends ST{constructor(e,n){super(n),this.url=e,cv(this,n)}toString(){return IT(this._root)}}function cv(t,e){e.value._routerState=t,e.children.forEach(n=>cv(t,n))}function IT(t){const e=t.children.length>0?` { ${t.children.map(IT).join(", ")} } `:"";return`${t.value}${e}`}function uv(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,mi(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),mi(e.params,n.params)||t.params.next(n.params),function D8(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!mi(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),mi(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function dv(t,e){const n=mi(t.params,e.params)&&function T8(t,e){return Eo(t,e)&&t.every((n,r)=>mi(n.parameters,e[r].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||dv(t.parent,e.parent))}function Hc(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const i=function cz(t,e,n){return e.children.map(r=>{for(const i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Hc(t,r,i);return Hc(t,r)})}(t,e,n);return new Yi(r,i)}{if(t.shouldAttach(e.value)){const s=t.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Hc(t,a)),o}}const r=function uz(t){return new Ga(new Wr(t.url),new Wr(t.params),new Wr(t.queryParams),new Wr(t.fragment),new Wr(t.data),t.outlet,t.component,t)}(e.value),i=e.children.map(s=>Hc(t,s));return new Yi(r,i)}}const fv="ngNavigationCancelingError";function kT(t,e){const{redirectTo:n,navigationBehaviorOptions:r}=Mo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=xT(!1,0,e);return i.url=n,i.navigationBehaviorOptions=r,i}function xT(t,e,n){const r=new Error("NavigationCancelingError: "+(t||""));return r[fv]=!0,r.cancellationCode=e,n&&(r.url=n),r}function NT(t){return OT(t)&&Mo(t.url)}function OT(t){return t&&t[fv]}class dz{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new zc,this.attachRef=null}}let zc=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){const i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new dz,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Vf=!1;let hv=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=He,this.activateEvents=new At,this.deactivateEvents=new At,this.attachEvents=new At,this.detachEvents=new At,this.parentContexts=st(zc),this.location=st(jr),this.changeDetector=st(Dc),this.environmentInjector=st(ms)}ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:i}=n.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new te(4012,Vf);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new te(4012,Vf);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new te(4012,Vf);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new te(4013,Vf);this._activatedRoute=n;const i=this.location,o=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new fz(n,a,i.injector);if(r&&function hz(t){return!!t.resolveComponentFactory}(r)){const c=r.resolveComponentFactory(o);this.activated=i.createComponent(c,i.length,l)}else this.activated=i.createComponent(o,{index:i.length,injector:l,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=De({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[gr]}),t})();class fz{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Ga?this.route:e===zc?this.childContexts:this.parent.get(e,n)}}let pv=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Ll({type:t,selectors:[["ng-component"]],standalone:!0,features:[LS],decls:1,vars:0,template:function(n,r){1&n&&Od(0,"router-outlet")},dependencies:[hv],encapsulation:2}),t})();function RT(t,e){return t.providers&&!t._injector&&(t._injector=$d(t.providers,e,`Route: ${t.path}`)),t._injector??e}function mv(t){const e=t.children&&t.children.map(mv),n=e?{...t,children:e}:{...t};return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==He&&(n.component=pv),n}function _r(t){return t.outlet||He}function FT(t,e){const n=t.filter(r=>_r(r)===e);return n.push(...t.filter(r=>_r(r)!==e)),n}function Gc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class vz{constructor(e,n,r,i){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i}activate(e){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),uv(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){const i=za(n);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),nn(i,(s,o)=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=za(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){const o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=za(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,n,r){const i=za(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new iz(s.value.snapshot))}),e.children.length&&this.forwardEvent(new nz(e.value.snapshot))}activateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(uv(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),uv(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Gc(i.snapshot),l=a?.get(sc)??null;o.attachRef=null,o.route=i,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}}class PT{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Bf{constructor(e,n){this.component=e,this.route=n}}function wz(t,e,n){const r=t._root;return Wc(r,e?e._root:null,n,[r.value])}function Wa(t,e){const n=Symbol(),r=e.get(t,n);return r===n?"function"!=typeof t||function VO(t){return null!==Uu(t)}(t)?e.get(t):t:r}function Wc(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=za(e);return t.children.forEach(o=>{(function _z(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function Cz(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Eo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Eo(t.url,e.url)||!mi(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!dv(t,e)||!mi(t.queryParams,e.queryParams);default:return!dv(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new PT(r)):(s.data=o.data,s._resolvedData=o._resolvedData),Wc(t,e,s.component?a?a.children:null:n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Bf(a.outlet.component,o))}else o&&qc(e,a,i),i.canActivateChecks.push(new PT(r)),Wc(t,null,s.component?a?a.children:null:n,r,i)})(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),nn(s,(o,a)=>qc(o,n.getContext(a),i)),i}function qc(t,e,n){const r=za(t),i=t.value;nn(r,(s,o)=>{qc(s,i.component?e?e.children.getContext(o):null:e,n)}),n.canDeactivateChecks.push(new Bf(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Kc(t){return"function"==typeof t}function yv(t){return t instanceof Tf||"EmptyError"===t?.name}const Uf=Symbol("INITIAL_VALUE");function qa(){return gi(t=>Z1(t.map(e=>e.pipe(Pc(1),function m8(...t){const e=Nl(t);return ht((n,r)=>{(e?Yy(t,n,e):Yy(t,n)).subscribe(r)})}(Uf)))).pipe(xe(e=>{for(const n of e)if(!0!==n){if(n===Uf)return Uf;if(!1===n||n instanceof So)return n}return!0}),Ss(e=>e!==Uf),Pc(1)))}function LT(t){return function an(...t){return we(t)}(pn(e=>{if(Mo(e))throw kT(0,e)}),xe(e=>!0===e))}const vv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function VT(t,e,n,r,i){const s=wv(t,e,n);return s.matched?function Bz(t,e,n,r){const i=e.canMatch;return i&&0!==i.length?me(i.map(o=>{const a=Wa(o,t);return Ts(function Az(t){return t&&Kc(t.canMatch)}(a)?a.canMatch(e,n):t.runInContext(()=>a(e,n)))})).pipe(qa(),LT()):me(!0)}(r=RT(e,r),e,n).pipe(xe(o=>!0===o?s:{...vv})):me(s)}function wv(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{...vv}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const i=(e.matcher||C8)(n,t,e);if(!i)return{...vv};const s={};nn(i.posParams,(a,l)=>{s[l]=a.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function jf(t,e,n,r){if(n.length>0&&function $z(t,e,n){return n.some(r=>$f(t,e,r)&&_r(r)!==He)}(t,n,r)){const s=new ze(e,function jz(t,e,n,r){const i={};i[He]=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const s of n)if(""===s.path&&_r(s)!==He){const o=new ze([],{});o._sourceSegment=t,o._segmentIndexShift=e.length,i[_r(s)]=o}return i}(t,e,r,new ze(n,t.children)));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===n.length&&function Hz(t,e,n){return n.some(r=>$f(t,e,r))}(t,n,r)){const s=new ze(t.segments,function Uz(t,e,n,r,i){const s={};for(const o of r)if($f(t,n,o)&&!i[_r(o)]){const a=new ze([],{});a._sourceSegment=t,a._segmentIndexShift=e.length,s[_r(o)]=a}return{...i,...s}}(t,e,n,r,t.children));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}const i=new ze(t.segments,t.children);return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:n}}function $f(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function BT(t,e,n,r){return!!(_r(t)===r||r!==He&&$f(e,n,t))&&("**"===t.path||wv(e,t,n).matched)}function UT(t,e,n){return 0===e.length&&!t.children[n]}const Hf=!1;class zf{constructor(e){this.segmentGroup=e||null}}class jT{constructor(e){this.urlTree=e}}function Jc(t){return Fc(new zf(t))}function $T(t){return Fc(new jT(t))}class qz{constructor(e,n,r,i,s){this.injector=e,this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=s,this.allowRedirects=!0}apply(){const e=jf(this.urlTree.root,[],[],this.config).segmentGroup,n=new ze(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,n,He).pipe(xe(s=>this.createUrlTree(Ff(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ms(s=>{if(s instanceof jT)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof zf?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,He).pipe(xe(i=>this.createUrlTree(Ff(i),e.queryParams,e.fragment))).pipe(Ms(i=>{throw i instanceof zf?this.noMatchError(i):i}))}noMatchError(e){return new te(4002,Hf)}createUrlTree(e,n,r){const i=nv(e);return new So(i,n,r)}expandSegmentGroup(e,n,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,n,r).pipe(xe(s=>new ze([],s))):this.expandSegment(e,r,n,r.segments,i,!0)}expandChildren(e,n,r){const i=[];for(const s of Object.keys(r.children))"primary"===s?i.unshift(s):i.push(s);return Ft(i).pipe(Do(s=>{const o=r.children[s],a=FT(n,s);return this.expandSegmentGroup(e,a,o,s).pipe(xe(l=>({segment:l,outlet:s})))}),nT((s,o)=>(s[o.outlet]=o.segment,s),{}),rT())}expandSegment(e,n,r,i,s,o){return Ft(r).pipe(Do(a=>this.expandSegmentAgainstRoute(e,n,r,a,i,s,o).pipe(Ms(c=>{if(c instanceof zf)return me(null);throw c}))),Es(a=>!!a),Ms((a,l)=>{if(yv(a))return UT(n,i,s)?me(new ze([],{})):Jc(n);throw a}))}expandSegmentAgainstRoute(e,n,r,i,s,o,a){return BT(i,n,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,n,i,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o):Jc(n):Jc(n)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,i){const s=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?$T(s):this.lineralizeSegments(r,s).pipe(Xt(o=>{const a=new ze(o,{});return this.expandSegment(e,a,n,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=wv(n,i,s);if(!a)return Jc(n);const d=this.applyRedirectCommands(l,i.redirectTo,u);return i.redirectTo.startsWith("/")?$T(d):this.lineralizeSegments(i,d).pipe(Xt(h=>this.expandSegment(e,n,r,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){return"**"===r.path?(e=RT(r,e),r.loadChildren?(r._loadedRoutes?me({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(e,r)).pipe(xe(a=>(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,new ze(i,{})))):me(new ze(i,{}))):VT(n,r,i,e).pipe(gi(({matched:o,consumedSegments:a,remainingSegments:l})=>o?this.getChildConfig(e=r._injector??e,r,i).pipe(Xt(u=>{const d=u.injector??e,h=u.routes,{segmentGroup:p,slicedSegments:m}=jf(n,a,l,h),v=new ze(p.segments,p.children);if(0===m.length&&v.hasChildren())return this.expandChildren(d,h,v).pipe(xe(B=>new ze(a,B)));if(0===h.length&&0===m.length)return me(new ze(a,{}));const w=_r(r)===s;return this.expandSegment(d,v,h,m,w?He:s,!0).pipe(xe(z=>new ze(a.concat(z.segments),z.children)))})):Jc(n)))}getChildConfig(e,n,r){return n.children?me({routes:n.children,injector:e}):n.loadChildren?void 0!==n._loadedRoutes?me({routes:n._loadedRoutes,injector:n._loadedInjector}):function Vz(t,e,n,r){const i=e.canLoad;return void 0===i||0===i.length?me(!0):me(i.map(o=>{const a=Wa(o,t);return Ts(function Sz(t){return t&&Kc(t.canLoad)}(a)?a.canLoad(e,n):t.runInContext(()=>a(e,n)))})).pipe(qa(),LT())}(e,n,r).pipe(Xt(i=>i?this.configLoader.loadChildren(e,n).pipe(pn(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):function Gz(t){return Fc(xT(Hf,3))}())):me({routes:[],injector:e})}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return me(r);if(i.numberOfChildren>1||!i.children[He])return Fc(new te(4e3,Hf));i=i.children[He]}}applyRedirectCommands(e,n,r){return this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r)}applyRedirectCreateUrlTree(e,n,r,i){const s=this.createSegmentGroup(e,n.root,r,i);return new So(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const r={};return nn(e,(i,s)=>{if("string"==typeof i&&i.startsWith(":")){const a=i.substring(1);r[s]=n[a]}else r[s]=i}),r}createSegmentGroup(e,n,r,i){const s=this.createSegments(e,n.segments,r,i);let o={};return nn(n.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,r,i)}),new ze(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){const i=r[n.path.substring(1)];if(!i)throw new te(4001,Hf);return i}findOrReturn(e,n){let r=0;for(const i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}}class Jz{}class Qz{constructor(e,n,r,i,s,o,a){this.injector=e,this.rootComponentType=n,this.config=r,this.urlTree=i,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a}recognize(){const e=jf(this.urlTree.root,[],[],this.config.filter(n=>void 0===n.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,He).pipe(xe(n=>{if(null===n)return null;const r=new Lf([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},He,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Yi(r,n),s=new AT(this.url,i);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const n=e.value,r=TT(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,n,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i)}processChildren(e,n,r){return Ft(Object.keys(r.children)).pipe(Do(i=>{const s=r.children[i],o=FT(n,i);return this.processSegmentGroup(e,o,s,i)}),nT((i,s)=>i&&s?(i.push(...s),i):null),function w8(t,e=!1){return ht((n,r)=>{let i=0;n.subscribe(wt(r,s=>{const o=t(s,i++);(o||e)&&r.next(s),!o&&r.complete()}))})}(i=>null!==i),Af(null),rT(),xe(i=>{if(null===i)return null;const s=zT(i);return function Xz(t){t.sort((e,n)=>e.value.outlet===He?-1:n.value.outlet===He?1:e.value.outlet.localeCompare(n.value.outlet))}(s),s}))}processSegment(e,n,r,i,s){return Ft(n).pipe(Do(o=>this.processSegmentAgainstRoute(o._injector??e,o,r,i,s)),Es(o=>!!o),Ms(o=>{if(yv(o))return UT(r,i,s)?me([]):me(null);throw o}))}processSegmentAgainstRoute(e,n,r,i,s){if(n.redirectTo||!BT(n,r,i,s))return me(null);let o;if("**"===n.path){const a=i.length>0?oT(i).parameters:{},l=WT(r)+i.length;o=me({snapshot:new Lf(i,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,qT(n),_r(n),n.component??n._loadedComponent??null,n,GT(r),l,KT(n)),consumedSegments:[],remainingSegments:[]})}else o=VT(r,n,i,e).pipe(xe(({matched:a,consumedSegments:l,remainingSegments:c,parameters:u})=>{if(!a)return null;const d=WT(r)+l.length;return{snapshot:new Lf(l,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,qT(n),_r(n),n.component??n._loadedComponent??null,n,GT(r),d,KT(n)),consumedSegments:l,remainingSegments:c}}));return o.pipe(gi(a=>{if(null===a)return me(null);const{snapshot:l,consumedSegments:c,remainingSegments:u}=a;e=n._injector??e;const d=n._loadedInjector??e,h=function e6(t){return t.children?t.children:t.loadChildren?t._loadedRoutes:[]}(n),{segmentGroup:p,slicedSegments:m}=jf(r,c,u,h.filter(w=>void 0===w.redirectTo));if(0===m.length&&p.hasChildren())return this.processChildren(d,h,p).pipe(xe(w=>null===w?null:[new Yi(l,w)]));if(0===h.length&&0===m.length)return me([new Yi(l,[])]);const v=_r(n)===s;return this.processSegment(d,h,p,m,v?He:s).pipe(xe(w=>null===w?null:[new Yi(l,w)]))}))}}function t6(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function zT(t){const e=[],n=new Set;for(const r of t){if(!t6(r)){e.push(r);continue}const i=e.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),n.add(i)):e.push(r)}for(const r of n){const i=zT(r.children);e.push(new Yi(r.value,i))}return e.filter(r=>!n.has(r))}function GT(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function WT(t){let e=t,n=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift??0;return n-1}function qT(t){return t.data||{}}function KT(t){return t.resolve||{}}function JT(t){return"string"==typeof t.title||null===t.title}function bv(t){return gi(e=>{const n=t(e);return n?Ft(n).pipe(xe(()=>e)):me(e)})}class c6{constructor(e){this.router=e,this.currentNavigation=null}setupNavigations(e){const n=this.router.events;return e.pipe(Ss(r=>0!==r.id),xe(r=>({...r,extractedUrl:this.router.urlHandlingStrategy.extract(r.rawUrl)})),gi(r=>{let i=!1,s=!1;return me(r).pipe(pn(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.router.lastSuccessfulNavigation?{...this.router.lastSuccessfulNavigation,previousNavigation:null}:null}}),gi(o=>{const a=this.router.browserUrlTree.toString(),l=!this.router.navigated||o.extractedUrl.toString()!==a||a!==this.router.currentUrlTree.toString();if(("reload"===this.router.onSameUrlNavigation||l)&&this.router.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return ZT(o.source)&&(this.router.browserUrlTree=o.extractedUrl),me(o).pipe(gi(u=>{const d=this.router.transitions.getValue();return n.next(new ov(u.id,this.router.serializeUrl(u.extractedUrl),u.source,u.restoredState)),d!==this.router.transitions.getValue()?Ri:Promise.resolve(u)}),function Kz(t,e,n,r){return gi(i=>function Wz(t,e,n,r,i){return new qz(t,e,n,r,i).apply()}(t,e,n,i.extractedUrl,r).pipe(xe(s=>({...i,urlAfterRedirects:s}))))}(this.router.ngModule.injector,this.router.configLoader,this.router.urlSerializer,this.router.config),pn(u=>{this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects},r.urlAfterRedirects=u.urlAfterRedirects}),function r6(t,e,n,r,i){return Xt(s=>function Zz(t,e,n,r,i,s,o="emptyOnly"){return new Qz(t,e,n,r,i,o,s).recognize().pipe(gi(a=>null===a?function Yz(t){return new vt(e=>e.error(t))}(new Jz):me(a)))}(t,e,n,s.urlAfterRedirects,r.serialize(s.urlAfterRedirects),r,i).pipe(xe(o=>({...s,targetSnapshot:o}))))}(this.router.ngModule.injector,this.router.rootComponentType,this.router.config,this.router.urlSerializer,this.router.paramsInheritanceStrategy),pn(u=>{if(r.targetSnapshot=u.targetSnapshot,"eager"===this.router.urlUpdateStrategy){if(!u.extras.skipLocationChange){const h=this.router.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl);this.router.setBrowserUrl(h,u)}this.router.browserUrlTree=u.urlAfterRedirects}const d=new K8(u.id,this.router.serializeUrl(u.extractedUrl),this.router.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);n.next(d)}));if(l&&this.router.rawUrlTree&&this.router.urlHandlingStrategy.shouldProcessUrl(this.router.rawUrlTree)){const{id:d,extractedUrl:h,source:p,restoredState:m,extras:v}=o,w=new ov(d,this.router.serializeUrl(h),p,m);n.next(w);const k=MT(h,this.router.rootComponentType).snapshot;return me(r={...o,targetSnapshot:k,urlAfterRedirects:h,extras:{...v,skipLocationChange:!1,replaceUrl:!1}})}return this.router.rawUrlTree=o.rawUrl,o.resolve(null),Ri}),pn(o=>{const a=new J8(o.id,this.router.serializeUrl(o.extractedUrl),this.router.serializeUrl(o.urlAfterRedirects),o.targetSnapshot);this.router.triggerEvent(a)}),xe(o=>r={...o,guards:wz(o.targetSnapshot,o.currentSnapshot,this.router.rootContexts)}),function kz(t,e){return Xt(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?me({...n,guardsResult:!0}):function xz(t,e,n,r){return Ft(t).pipe(Xt(i=>function Lz(t,e,n,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?me(s.map(a=>{const l=Gc(e)??i,c=Wa(a,l);return Ts(function Tz(t){return t&&Kc(t.canDeactivate)}(c)?c.canDeactivate(t,e,n,r):l.runInContext(()=>c(t,e,n,r))).pipe(Es())})).pipe(qa()):me(!0)}(i.component,i.route,n,e,r)),Es(i=>!0!==i,!0))}(o,r,i,t).pipe(Xt(a=>a&&function Dz(t){return"boolean"==typeof t}(a)?function Nz(t,e,n,r){return Ft(e).pipe(Do(i=>Yy(function Rz(t,e){return null!==t&&e&&e(new tz(t)),me(!0)}(i.route.parent,r),function Oz(t,e){return null!==t&&e&&e(new rz(t)),me(!0)}(i.route,r),function Pz(t,e,n){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function bz(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(o)).filter(o=>null!==o).map(o=>X1(()=>me(o.guards.map(l=>{const c=Gc(o.node)??n,u=Wa(l,c);return Ts(function Mz(t){return t&&Kc(t.canActivateChild)}(u)?u.canActivateChild(r,t):c.runInContext(()=>u(r,t))).pipe(Es())})).pipe(qa())));return me(s).pipe(qa())}(t,i.path,n),function Fz(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return me(!0);const i=r.map(s=>X1(()=>{const o=Gc(e)??n,a=Wa(s,o);return Ts(function Ez(t){return t&&Kc(t.canActivate)}(a)?a.canActivate(e,t):o.runInContext(()=>a(e,t))).pipe(Es())}));return me(i).pipe(qa())}(t,i.route,n))),Es(i=>!0!==i,!0))}(r,s,t,e):me(a)),xe(a=>({...n,guardsResult:a})))})}(this.router.ngModule.injector,o=>this.router.triggerEvent(o)),pn(o=>{if(r.guardsResult=o.guardsResult,Mo(o.guardsResult))throw kT(0,o.guardsResult);const a=new Y8(o.id,this.router.serializeUrl(o.extractedUrl),this.router.serializeUrl(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.router.triggerEvent(a)}),Ss(o=>!!o.guardsResult||(this.router.restoreHistory(o),this.router.cancelNavigationTransition(o,"",3),!1)),bv(o=>{if(o.guards.canActivateChecks.length)return me(o).pipe(pn(a=>{const l=new Z8(a.id,this.router.serializeUrl(a.extractedUrl),this.router.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.router.triggerEvent(l)}),gi(a=>{let l=!1;return me(a).pipe(function i6(t,e){return Xt(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return me(n);let s=0;return Ft(i).pipe(Do(o=>function s6(t,e,n,r){const i=t.routeConfig,s=t._resolve;return void 0!==i?.title&&!JT(i)&&(s[Lc]=i.title),function o6(t,e,n,r){const i=function a6(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}(t);if(0===i.length)return me({});const s={};return Ft(i).pipe(Xt(o=>function l6(t,e,n,r){const i=Gc(e)??r,s=Wa(t,i);return Ts(s.resolve?s.resolve(e,n):i.runInContext(()=>s(e,n)))}(t[o],e,n,r).pipe(Es(),pn(a=>{s[o]=a}))),Qy(1),function b8(t){return xe(()=>t)}(s),Ms(o=>yv(o)?Ri:Fc(o)))}(s,t,e,r).pipe(xe(o=>(t._resolvedData=o,t.data=TT(t,n).resolve,i&&JT(i)&&(t.data[Lc]=i.title),null)))}(o.route,r,t,e)),pn(()=>s++),Qy(1),Xt(o=>s===i.length?me(n):Ri))})}(this.router.paramsInheritanceStrategy,this.router.ngModule.injector),pn({next:()=>l=!0,complete:()=>{l||(this.router.restoreHistory(a),this.router.cancelNavigationTransition(a,"",2))}}))}),pn(a=>{const l=new Q8(a.id,this.router.serializeUrl(a.extractedUrl),this.router.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.router.triggerEvent(l)}))}),bv(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.router.configLoader.loadComponent(l.routeConfig).pipe(pn(u=>{l.component=u}),xe(()=>{})));for(const u of l.children)c.push(...a(u));return c};return Z1(a(o.targetSnapshot.root)).pipe(Af(),Pc(1))}),bv(()=>this.router.afterPreactivation()),xe(o=>{const a=function lz(t,e,n){const r=Hc(t,e._root,n?n._root:void 0);return new ET(r,e)}(this.router.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return r={...o,targetRouterState:a}}),pn(o=>{this.router.currentUrlTree=o.urlAfterRedirects,this.router.rawUrlTree=this.router.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),this.router.routerState=o.targetRouterState,"deferred"===this.router.urlUpdateStrategy&&(o.extras.skipLocationChange||this.router.setBrowserUrl(this.router.rawUrlTree,o),this.router.browserUrlTree=o.urlAfterRedirects)}),((t,e,n)=>xe(r=>(new vz(e,r.targetRouterState,r.currentRouterState,n).activate(t),r)))(this.router.rootContexts,this.router.routeReuseStrategy,o=>this.router.triggerEvent(o)),pn({next(){i=!0},complete(){i=!0}}),Xy(()=>{i||s||this.router.cancelNavigationTransition(r,"",1),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),Ms(o=>{if(s=!0,OT(o)){NT(o)||(this.router.navigated=!0,this.router.restoreHistory(r,!0));const a=new Pf(r.id,this.router.serializeUrl(r.extractedUrl),o.message,o.cancellationCode);if(n.next(a),NT(o)){const l=this.router.urlHandlingStrategy.merge(o.url,this.router.rawUrlTree),c={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.router.urlUpdateStrategy||ZT(r.source)};this.router.scheduleNavigation(l,"imperative",null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{this.router.restoreHistory(r,!0);const a=new CT(r.id,this.router.serializeUrl(r.extractedUrl),o,r.targetSnapshot??void 0);n.next(a);try{r.resolve(this.router.errorHandler(o))}catch(l){r.reject(l)}}return Ri}))}))}}function ZT(t){return"imperative"!==t}let QT=(()=>{class t{buildTitle(n){let r,i=n.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===He);return r}getResolvedTitleForRoute(n){return n.data[Lc]}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:function(){return st(u6)},providedIn:"root"}),t})(),u6=(()=>{class t extends QT{constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}}return t.\u0275fac=function(n){return new(n||t)(pe(jM))},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),d6=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:function(){return st(h6)},providedIn:"root"}),t})();class f6{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}let h6=(()=>{class t extends f6{}return t.\u0275fac=function(){let e;return function(r){return(e||(e=tn(t)))(r||t)}}(),t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Gf=new fe("",{providedIn:"root",factory:()=>({})}),Ka=new fe("ROUTES");let _v=(()=>{class t{constructor(n,r){this.injector=n,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return me(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const r=Ts(n.loadComponent()).pipe(xe(eA),pn(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),Xy(()=>{this.componentLoaders.delete(n)})),i=new eT(r,()=>new qt).pipe(Zy());return this.componentLoaders.set(n,i),i}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return me({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const s=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(xe(a=>{this.onLoadEndListener&&this.onLoadEndListener(r);let l,c,u=!1;Array.isArray(a)?c=a:(l=a.create(n).injector,c=sT(l.get(Ka,[],ve.Self|ve.Optional)));return{routes:c.map(mv),injector:l}}),Xy(()=>{this.childrenLoaders.delete(r)})),o=new eT(s,()=>new qt).pipe(Zy());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(n){return Ts(n()).pipe(xe(eA),Xt(i=>i instanceof FS||Array.isArray(i)?me(i):Ft(this.compiler.compileModuleAsync(i))))}}return t.\u0275fac=function(n){return new(n||t)(pe(yr),pe(zm))},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function eA(t){return function m6(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let y6=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:function(){return st(v6)},providedIn:"root"}),t})(),v6=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function w6(t){throw t}function b6(t,e,n){return e.parse("/")}const _6={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},C6={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function nA(){const t=st(fT),e=st(zc),n=st(sy),r=st(yr),i=st(zm),s=st(Ka,{optional:!0})??[],o=st(Gf,{optional:!0})??{},a=new gn(null,t,e,n,r,i,sT(s));return function D6(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy),t.canceledNavigationResolution&&(e.canceledNavigationResolution=t.canceledNavigationResolution)}(o,a),a}let gn=(()=>{class t{constructor(n,r,i,s,o,a,l){this.rootComponentType=n,this.urlSerializer=r,this.rootContexts=i,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new qt,this.errorHandler=w6,this.malformedUriErrorHandler=b6,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>me(void 0),this.urlHandlingStrategy=st(y6),this.routeReuseStrategy=st(d6),this.titleStrategy=st(QT),this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.canceledNavigationResolution="replace",this.navigationTransitions=new c6(this),this.configLoader=o.get(_v),this.configLoader.onLoadEndListener=h=>this.triggerEvent(new ez(h)),this.configLoader.onLoadStartListener=h=>this.triggerEvent(new X8(h)),this.ngModule=o.get(vo),this.console=o.get(RU);const d=o.get(Lt);this.isNgZoneEnabled=d instanceof Lt&&Lt.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=new So,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=MT(this.currentUrlTree,this.rootComponentType),this.transitions=new Wr({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.navigationTransitions.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next({...this.transitions.value,...n})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const r="popstate"===n.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const i={replaceUrl:!0},s=n.state?.navigationId?n.state:null;if(n.state){const a={...n.state};delete a.navigationId,delete a.\u0275routerPageId,0!==Object.keys(a).length&&(i.state=a)}const o=this.parseUrl(n.url);this.scheduleNavigation(o,r,s,i)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){this.config=n.map(mv),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=r,c=i||this.routerState.root,u=l?this.currentUrlTree.fragment:o;let d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}return null!==d&&(d=this.removeEmptyProps(d)),$8(c,this.currentUrlTree,n,d,u??null)}navigateByUrl(n,r={skipLocationChange:!1}){const i=Mo(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,r)}navigate(n,r={skipLocationChange:!1}){return function S6(t){for(let e=0;e<t.length;e++){if(null==t[e])throw new te(4008,!1)}}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let r;try{r=this.urlSerializer.parse(n)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,n)}return r}isActive(n,r){let i;if(i=!0===r?{..._6}:!1===r?{...C6}:r,Mo(n))return lT(this.currentUrlTree,n,i);const s=this.parseUrl(n);return lT(this.currentUrlTree,s,i)}removeEmptyProps(n){return Object.keys(n).reduce((r,i)=>{const s=n[i];return null!=s&&(r[i]=s),r},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new To(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.getCurrentNavigation(),this.titleStrategy?.updateTitle(this.routerState.snapshot),n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((h,p)=>{a=h,l=p});const u=++this.navigationId;let d;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),d=i&&i.\u0275routerPageId?i.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):d=0,this.setTransition({id:u,targetPageId:d,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,rawUrl:n,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}setBrowserUrl(n,r){const i=this.urlSerializer.serialize(n),s={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",s):this.location.go(i,"",s)}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===i?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===i&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,r,i){const s=new Pf(n.id,this.serializeUrl(n.extractedUrl),r,i);this.triggerEvent(s),n.resolve(!1)}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}}return t.\u0275fac=function(n){zg()},t.\u0275prov=Me({token:t,factory:function(){return nA()},providedIn:"root"}),t})();class rA{}let T6=(()=>{class t{constructor(n,r,i,s,o){this.router=n,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ss(n=>n instanceof To),Do(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const i=[];for(const s of r){s.providers&&!s._injector&&(s._injector=$d(s.providers,n,`Route: ${s.path}`));const o=s._injector??n,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?i.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Ft(i).pipe(ea())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(n,r):me(null);const s=i.pipe(Xt(o=>null===o?me(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??n,o.routes))));return r.loadComponent&&!r._loadedComponent?Ft([s,this.loader.loadComponent(r)]).pipe(ea()):s})}}return t.\u0275fac=function(n){return new(n||t)(pe(gn),pe(zm),pe(ms),pe(rA),pe(_v))},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Dv=new fe("");let iA=(()=>{class t{constructor(n,r,i,s={}){this.router=n,this.viewportScroller=r,this.zone=i,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof ov?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof To&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof DT&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.router.triggerEvent(new DT(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(n){zg()},t.\u0275prov=Me({token:t,factory:t.\u0275fac}),t})();function Ya(t,e){return{\u0275kind:t,\u0275providers:e}}function oA(){const t=st(yr);return e=>{const n=t.get(Jd);if(e!==n.components[0])return;const r=t.get(gn),i=t.get(aA);1===t.get(Ev)&&r.initialNavigation(),t.get(lA,null,ve.Optional)?.setUpPreloading(),t.get(Dv,null,ve.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.unsubscribe())}}const aA=new fe("",{factory:()=>new qt}),Ev=new fe("",{providedIn:"root",factory:()=>1});const lA=new fe("");function N6(t){return Ya(0,[{provide:lA,useExisting:T6},{provide:rA,useExisting:t}])}const cA=new fe("ROUTER_FORROOT_GUARD"),O6=[sy,{provide:fT,useClass:ev},{provide:gn,useFactory:nA},zc,{provide:Ga,useFactory:function sA(t){return t.routerState.root},deps:[gn]},_v,[]];function R6(){return new RE("Router",gn)}let uA=(()=>{class t{constructor(n){}static forRoot(n,r){return{ngModule:t,providers:[O6,[],{provide:Ka,multi:!0,useValue:n},{provide:cA,useFactory:V6,deps:[[gn,new Jl,new Yl]]},{provide:Gf,useValue:r||{}},r?.useHash?{provide:bo,useClass:_j}:{provide:bo,useClass:rM},{provide:Dv,useFactory:()=>{const t=st(gn),e=st(W$),n=st(Lt),r=st(Gf);return r.scrollOffset&&e.setOffset(r.scrollOffset),new iA(t,e,n,r)}},r?.preloadingStrategy?N6(r.preloadingStrategy).\u0275providers:[],{provide:RE,multi:!0,useFactory:R6},r?.initialNavigation?B6(r):[],[{provide:dA,useFactory:oA},{provide:TE,multi:!0,useExisting:dA}]]}}static forChild(n){return{ngModule:t,providers:[{provide:Ka,multi:!0,useValue:n}]}}}return t.\u0275fac=function(n){return new(n||t)(pe(cA,8))},t.\u0275mod=Or({type:t}),t.\u0275inj=fr({imports:[pv]}),t})();function V6(t){return"guarded"}function B6(t){return["disabled"===t.initialNavigation?Ya(3,[{provide:Wd,multi:!0,useFactory:()=>{const e=st(gn);return()=>{e.setUpLocationChangeListener()}}},{provide:Ev,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?Ya(2,[{provide:Ev,useValue:0},{provide:Wd,multi:!0,deps:[yr],useFactory:e=>{const n=e.get(wj,Promise.resolve());return()=>n.then(()=>new Promise(i=>{const s=e.get(gn),o=e.get(aA);(function r(i){e.get(gn).events.pipe(Ss(o=>o instanceof To||o instanceof Pf||o instanceof CT),xe(o=>o instanceof To||o instanceof Pf&&(0===o.code||1===o.code)&&null),Ss(o=>null!==o),Pc(1)).subscribe(()=>{i()})})(()=>{i(!0)}),s.afterPreactivation=()=>(i(!0),o.closed?me(void 0):o),s.initialNavigation()}))}}]).\u0275providers:[]]}const dA=new fe(""),j6=[];class Wf{static#e=this.\u0275fac=function(n){return new(n||Wf)};static#t=this.\u0275mod=Or({type:Wf});static#n=this.\u0275inj=fr({imports:[uA.forRoot(j6),uA]})}function mn(t){this.content=t}mn.prototype={constructor:mn,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return-1==e?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),s=r.content.slice();return-1==i?s.push(n||t,e):(s[i+1]=e,n&&(s[i]=n)),new mn(s)},remove:function(t){var e=this.find(t);if(-1==e)return this;var n=this.content.slice();return n.splice(e,2),new mn(n)},addToStart:function(t,e){return new mn([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new mn(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),s=r.find(t);return i.splice(-1==s?i.length:s,0,e,n),new mn(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=mn.from(t)).size?new mn(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=mn.from(t)).size?new mn(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=mn.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}},mn.from=function(t){if(t instanceof mn)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new mn(e)};const fA=mn;function hA(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),s=e.child(r);if(i!=s){if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)n++;return n}if(i.content.size||s.content.size){let o=hA(i.content,s.content,n+1);if(null!=o)return o}n+=i.nodeSize}else n+=i.nodeSize}}function pA(t,e,n,r){for(let i=t.childCount,s=e.childCount;;){if(0==i||0==s)return i==s?null:{a:n,b:r};let o=t.child(--i),a=e.child(--s),l=o.nodeSize;if(o!=a){if(!o.sameMarkup(a))return{a:n,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(o.content.size||a.content.size){let c=pA(o.content,a.content,n-1,r-1);if(c)return c}n-=l,r-=l}else n-=l,r-=l}}class ee{constructor(e,n){if(this.content=e,this.size=n||0,null==n)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,s){for(let o=0,a=0;a<n;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&!1!==r(l,i+a,s||null,o)&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,n-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let s="",o=!0;return this.nodesBetween(e,n,(a,l)=>{a.isText?(s+=a.text.slice(Math.max(e,l)-l,n-l),o=!r):a.isLeaf?(i?s+="function"==typeof i?i(a):i:a.type.spec.leafText&&(s+=a.type.spec.leafText(a)),o=!r):!o&&a.isBlock&&(s+=r,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new ee(i,this.size+e.size)}cut(e,n=this.size){if(0==e&&n==this.size)return this;let r=[],i=0;if(n>e)for(let s=0,o=0;o<n;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>n)&&(a=a.isText?a.cut(Math.max(0,e-o),Math.min(a.text.length,n-o)):a.cut(Math.max(0,e-o-1),Math.min(a.content.size,n-o-1))),r.push(a),i+=a.nodeSize),o=l}return new ee(r,i)}cutByIndex(e,n){return e==n?ee.empty:0==e&&n==this.content.length?this:new ee(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),s=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new ee(i,s)}addToStart(e){return new ee([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new ee(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return hA(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return pA(this,e,n,r)}findIndex(e,n=-1){if(0==e)return qf(0,e);if(e==this.size)return qf(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=i+this.child(r).nodeSize;if(o>=e)return o==e||n>0?qf(r+1,o):qf(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return ee.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new ee(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return ee.empty;let n,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(n||(n=e.slice(0,i)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new ee(n||e,r)}static from(e){if(!e)return ee.empty;if(e instanceof ee)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new ee([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ee.empty=new ee([],0);const Mv={index:0,offset:0};function qf(t,e){return Mv.index=t,Mv.offset=e,Mv}function Kf(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Kf(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Kf(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let yt=(()=>{class t{constructor(n,r){this.type=n,this.attrs=r}addToSet(n){let r,i=!1;for(let s=0;s<n.length;s++){let o=n[s];if(this.eq(o))return n;if(this.type.excludes(o.type))r||(r=n.slice(0,s));else{if(o.type.excludes(this.type))return n;!i&&o.type.rank>this.type.rank&&(r||(r=n.slice(0,s)),r.push(this),i=!0),r&&r.push(o)}}return r||(r=n.slice()),i||r.push(this),r}removeFromSet(n){for(let r=0;r<n.length;r++)if(this.eq(n[r]))return n.slice(0,r).concat(n.slice(r+1));return n}isInSet(n){for(let r=0;r<n.length;r++)if(this.eq(n[r]))return!0;return!1}eq(n){return this==n||this.type==n.type&&Kf(this.attrs,n.attrs)}toJSON(){let n={type:this.type.name};for(let r in this.attrs){n.attrs=this.attrs;break}return n}static fromJSON(n,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let i=n.marks[r.type];if(!i)throw new RangeError(`There is no mark type ${r.type} in this schema`);return i.create(r.attrs)}static sameSet(n,r){if(n==r)return!0;if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++)if(!n[i].eq(r[i]))return!1;return!0}static setFrom(n){if(!n||Array.isArray(n)&&0==n.length)return t.none;if(n instanceof t)return[n];let r=n.slice();return r.sort((i,s)=>i.type.rank-s.type.rank),r}}return t.none=[],t})();class Jf extends Error{}class oe{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=mA(this.content,e+this.openStart,n);return r&&new oe(r,this.openStart,this.openEnd)}removeBetween(e,n){return new oe(gA(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return oe.empty;let r=n.openStart||0,i=n.openEnd||0;if("number"!=typeof r||"number"!=typeof i)throw new RangeError("Invalid input for Slice.fromJSON");return new oe(ee.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)i++;return new oe(e,r,i)}}function gA(t,e,n){let{index:r,offset:i}=t.findIndex(e),s=t.maybeChild(r),{index:o,offset:a}=t.findIndex(n);if(i==e||s.isText){if(a!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,s.copy(gA(s.content,e-i-1,n-i-1)))}function mA(t,e,n,r){let{index:i,offset:s}=t.findIndex(e),o=t.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=mA(o.content,e-s-1,n);return a&&t.replaceChild(i,o.copy(a))}function $6(t,e,n){if(n.openStart>t.depth)throw new Jf("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Jf("Inconsistent open depths");return yA(t,e,n,0)}function yA(t,e,n,r){let i=t.index(r),s=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let o=yA(t,e,n,r+1);return s.copy(s.content.replaceChild(i,o))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){let{start:o,end:a}=function H6(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)i=e.node(s).copy(ee.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}(n,t);return Io(s,wA(t,o,a,e,r))}{let o=t.parent,a=o.content;return Io(o,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}}return Io(s,Yf(t,e,r))}function vA(t,e){if(!e.type.compatibleContent(t.type))throw new Jf("Cannot join "+e.type.name+" onto "+t.type.name)}function Tv(t,e,n){let r=t.node(n);return vA(r,e.node(n)),r}function Ao(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Zc(t,e,n,r){let i=(e||t).node(n),s=0,o=e?e.index(n):i.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(Ao(t.nodeAfter,r),s++));for(let a=s;a<o;a++)Ao(i.child(a),r);e&&e.depth==n&&e.textOffset&&Ao(e.nodeBefore,r)}function Io(t,e){return t.type.checkContent(e),t.copy(e)}function wA(t,e,n,r,i){let s=t.depth>i&&Tv(t,e,i+1),o=r.depth>i&&Tv(n,r,i+1),a=[];return Zc(null,t,i,a),s&&o&&e.index(i)==n.index(i)?(vA(s,o),Ao(Io(s,wA(t,e,n,r,i+1)),a)):(s&&Ao(Io(s,Yf(t,e,i+1)),a),Zc(e,n,i,a),o&&Ao(Io(o,Yf(n,r,i+1)),a)),Zc(r,null,i,a),new ee(a)}function Yf(t,e,n){let r=[];return Zc(null,t,n,r),t.depth>n&&Ao(Io(Tv(t,e,n+1),Yf(t,e,n+1)),r),Zc(e,null,n,r),new ee(r)}oe.empty=new oe(ee.empty,0,0);class Qc{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):0==e?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[3*n],i=0==n?0:this.path[3*n-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(0==e.content.size)return yt.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let a=r;r=i,i=a}let s=r.marks;for(var o=0;o<s.length;o++)!1===s[o].type.spec.inclusive&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)!1===r[s].type.spec.inclusive&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Zf(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,s=n;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(s),c=s-l;if(r.push(o,a,i+l),!c||(o=o.child(a),o.isText))break;s=c-1,i+=l+1}return new Qc(n,r,s)}static resolveCached(e,n){for(let i=0;i<Av.length;i++){let s=Av[i];if(s.pos==n&&s.doc==e)return s}let r=Av[Iv]=Qc.resolve(e,n);return Iv=(Iv+1)%z6,r}}let Av=[],Iv=0,z6=12;class Zf{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const G6=Object.create(null);class yi{constructor(e,n,r,i=yt.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||ee.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Kf(this.attrs,n||e.defaultAttrs||G6)&&yt.sameSet(this.marks,r||yt.none)}copy(e=null){return e==this.content?this:new yi(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new yi(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return 0==e&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return oe.empty;let i=this.resolve(e),s=this.resolve(n),o=r?0:i.sharedDepth(n),a=i.start(o),c=i.node(o).content.cut(i.pos-a,s.pos-a);return new oe(c,i.depth-o,s.depth-o)}replace(e,n,r){return $6(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return Qc.resolveCached(this,e)}resolveNoCache(e){return Qc.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),bA(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=ee.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),a=o&&o.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=i;l<s;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,n);return!!o&&o.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=yt.none;for(let n=0;n<this.marks.length;n++)e=this.marks[n].addToSet(e);if(!yt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if("text"==n.type){if("string"!=typeof n.text)throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=ee.fromJSON(e,n.content);return e.nodeType(n.type).create(n.attrs,i,r)}}yi.prototype.text=void 0;class Qf extends yi{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):bA(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Qf(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Qf(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return 0==e&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function bA(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class ko{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new W6(e,n);if(null==r.next)return ko.empty;let i=_A(r);r.next&&r.err("Unexpected trailing text");let s=function X6(t){let e=Object.create(null);return function n(r){let i=[];r.forEach(o=>{t[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);SA(t,l).forEach(u=>{c||i.push([a,c=[]]),-1==c.indexOf(u)&&c.push(u)})})});let s=e[r.join(",")]=new ko(r.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let a=i[o][1].sort(DA);s.next.push({type:i[o][0],next:e[a.join(",")]||n(a)})}return s}(SA(t,0))}(function Q6(t){let e=[[]];return i(function s(o,a){if("choice"==o.type)return o.exprs.reduce((l,c)=>l.concat(s(c,a)),[]);if("seq"!=o.type){if("star"==o.type){let l=n();return r(a,l),i(s(o.expr,l),l),[r(l)]}if("plus"==o.type){let l=n();return i(s(o.expr,a),l),i(s(o.expr,l),l),[r(l)]}if("opt"==o.type)return[r(a)].concat(s(o.expr,a));if("range"==o.type){let l=a;for(let c=0;c<o.min;c++){let u=n();i(s(o.expr,l),u),l=u}if(-1==o.max)i(s(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=n();r(l,u),i(s(o.expr,l),u),l=u}return[r(l)]}if("name"==o.type)return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}for(let l=0;;l++){let c=s(o.exprs[l],a);if(l==o.exprs.length-1)return c;i(c,a=n())}}(t,0),n()),e;function n(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function i(o,a){o.forEach(l=>l.to=a)}}(i));return function e4(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],s=!i.validEnd,o=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];o.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),-1==r.indexOf(c)&&r.push(c)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(s,r),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let s=n;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!n.isText&&!n.hasRequiredAttrs())return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];return function s(o,a){let l=o.matchFragment(e,r);if(l&&(!n||l.validEnd))return ee.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:d}=o.next[c];if(!u.isText&&!u.hasRequiredAttrs()&&-1==i.indexOf(d)){i.push(d);let h=s(d,a.concat(u));if(h)return h}}return null}(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let a=i;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:a,next:l}=s.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function n(r){e.push(r);for(let i=0;i<r.next.length;i++)-1==e.indexOf(r.next[i].next)&&n(r.next[i].next)}(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join("\n")}}ko.empty=new ko(!0);class W6{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function _A(t){let e=[];do{e.push(q6(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function q6(t){let e=[];do{e.push(K6(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function K6(t){let e=function Z6(t){if(t.eat("(")){let e=_A(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){let e=function Y6(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let s in n){let o=n[s];o.groups.indexOf(e)>-1&&i.push(o)}return 0==i.length&&t.err("No node type or group '"+e+"' found"),i}(t,t.next).map(n=>(null==t.inline?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}t.err("Unexpected token '"+t.next+"'")}(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=J6(t,e)}return e}function CA(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function J6(t,e){let n=CA(t),r=n;return t.eat(",")&&(r="}"!=t.next?CA(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function DA(t,e){return e-t}function SA(t,e){let n=[];return function r(i){let s=t[i];if(1==s.length&&!s[0].term)return r(s[0].to);n.push(i);for(let o=0;o<s.length;o++){let{term:a,to:l}=s[o];!a&&-1==n.indexOf(l)&&r(l)}}(e),n.sort(DA)}function EA(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function MA(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(void 0===i){let s=t[r];if(!s.hasDefault)throw new RangeError("No value supplied for attribute "+r);i=s.default}n[r]=i}return n}function TA(t){let e=Object.create(null);if(t)for(let n in t)e[n]=new t4(t[n]);return e}class Xf{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=TA(r.attrs),this.defaultAttrs=EA(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ko.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:MA(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new yi(this,this.computeAttrs(e),ee.from(n),yt.setFrom(r))}createChecked(e=null,n,r){return n=ee.from(n),this.checkContent(n),new yi(this,this.computeAttrs(e),n,yt.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),(n=ee.from(n)).size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let i=this.contentMatch.matchFragment(n),s=i&&i.fillBefore(ee.empty,!0);return s?new yi(this,e,n.append(s),yt.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:yt.none:e}static compile(e,n){let r=Object.create(null);e.forEach((s,o)=>r[s]=new Xf(s,n,o));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}class t4{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class eh{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=TA(i.attrs),this.excluded=null;let s=EA(this.attrs);this.instance=s?new yt(this,s):null}create(e=null){return!e&&this.instance?this.instance:new yt(this,MA(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new eh(s,i++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}excludes(e){return this.excluded.indexOf(e)>-1}}class n4{constructor(e){this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=fA.from(e.nodes),n.marks=fA.from(e.marks||{}),this.nodes=Xf.compile(this.spec.nodes,this),this.marks=eh.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",a=s.spec.marks;s.contentMatch=r[o]||(r[o]=ko.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet="_"==a?null:a?AA(this,a.split(" ")):""!=a&&s.inlineContent?null:[]}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=null==o?[s]:""==o?[]:AA(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof Xf))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new Qf(r,r.defaultAttrs,e,yt.setFrom(n))}mark(e,n){return"string"==typeof e&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return yi.fromJSON(this,e)}markFromJSON(e){return yt.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function AA(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],s=t.marks[i],o=s;if(s)n.push(s);else for(let a in t.marks){let l=t.marks[a];("_"==i||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}class Za{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[],n.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new NA(this,n,!1);return r.addAll(e,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new NA(this,n,!0);return r.addAll(e,n.from,n.to),oe.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(s4(e,s.tag)&&(void 0===s.namespace||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(!1===o)continue;s.attrs=o||void 0}return s}}}matchStyle(e,n,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],a=o.style;if(!(0!=a.indexOf(e)||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(61!=a.charCodeAt(e.length)||a.slice(e.length+1)!=n))){if(o.getAttrs){let l=o.getAttrs(n);if(!1===l)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let n=[];function r(i){let s=i.priority??50,o=0;for(;o<n.length;o++){if((n[o].priority??50)<s)break}n.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=OA(o)),o.mark=i})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=OA(o)),o.node=i})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Za(e,Za.schemaRules(e)))}}const IA={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},r4={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},kA={ol:!0,ul:!0};function xA(t,e,n){return null!=e?(e?1:0)|("full"===e?2:0):t&&"pre"==t.whitespace?3:-5&n}class rh{constructor(e,n,r,i,s,o,a){this.type=e,this.attrs=n,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=a,this.content=[],this.activeMarks=yt.none,this.stashMarks=[],this.match=o||(4&a?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(ee.from(e));if(!n){let i,r=this.type.contentMatch;return(i=r.findWrapping(e.type))?(this.match=r,i):null}this.match=this.type.contentMatch.matchFragment(n)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let i,r=this.content[this.content.length-1];if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let n=ee.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(ee.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}popFromStashMark(e){for(let n=this.stashMarks.length-1;n>=0;n--)if(e.eq(this.stashMarks[n]))return this.stashMarks.splice(n,1)[0]}applyPending(e){for(let n=0,r=this.pendingMarks;n<r.length;n++){let i=r[n];(this.type?this.type.allowsMarkType(i.type):a4(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!IA.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class NA{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0;let s,i=n.topNode,o=xA(null,n.preserveWhitespace,0)|(r?4:0);s=i?new rh(i.type,i.attrs,yt.none,yt.none,!0,n.topMatch||i.type.contentMatch,o):new rh(r?null:e.schema.topNodeType,null,yt.none,yt.none,!0,null,o),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){let n=e.getAttribute("style"),r=n?this.readStyles(function o4(t){let n,e=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;n=e.exec(t);)r.push(n[1],n[2].trim());return r}(n)):null,i=this.top;if(null!=r)for(let s=0;s<r.length;s++)this.addPendingMark(r[s]);if(this.addElement(e),null!=r)for(let s=0;s<r.length;s++)this.removePendingMark(r[s],i)}}addTextNode(e){let n=e.nodeValue,r=this.top;if(2&r.options||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(1&r.options)n=2&r.options?n.replace(/\r\n?/g,"\n"):n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=e.previousSibling;(!i||s&&"BR"==s.nodeName||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n)),this.findInText(e)}else this.findInside(e)}addElement(e,n){let i,r=e.nodeName.toLowerCase();kA.hasOwnProperty(r)&&this.parser.normalizeLists&&function i4(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&kA.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,n));if(s?s.ignore:r4.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,a=this.top,l=this.needsBlock;if(IA.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),o=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);this.addAll(e),o&&this.sync(a),this.needsBlock=l}else this.addElementByRule(e,s,!1===s.consuming?i:void 0)}leafFallback(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))}ignoreFallback(e){"BR"==e.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let n=yt.none;e:for(let r=0;r<e.length;r+=2)for(let i;;){let s=this.parser.matchStyle(e[r],e[r+1],this,i);if(!s)continue e;if(s.ignore)return null;if(n=this.parser.schema.marks[s.mark].create(s.attrs).addToSet(n),!1!==s.consuming)break;i=s}return n}addElementByRule(e,n,r){let i,s,o;n.node?(s=this.parser.schema.nodes[n.node],s.isLeaf?this.insertNode(s.create(n.attrs))||this.leafFallback(e):i=this.enter(s,n.attrs||null,n.preserveWhitespace)):(o=this.parser.schema.marks[n.mark].create(n.attrs),this.addPendingMark(o));let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;"string"==typeof n.contentElement?l=e.querySelector(n.contentElement):"function"==typeof n.contentElement?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l)}i&&this.sync(a)&&this.open--,o&&this.removePendingMark(o,a)}addAll(e,n,r){let i=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=null==r?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let n,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!n||n.length>o.length)&&(n=o,r=s,!o.length)||s.solid)break}if(!n)return!1;this.sync(r);for(let i=0;i<n.length;i++)this.enterInner(n[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let n=this.textblockFromContext();n&&this.enterInner(n)}if(this.findPlace(e)){this.closeExtra();let n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));let r=n.activeMarks;for(let i=0;i<e.marks.length;i++)(!n.type||n.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return n.content.push(e.mark(r)),!0}return!1}enter(e,n,r){let i=this.findPlace(e.create(n));return i&&this.enterInner(e,n,!0,r),i}enterInner(e,n=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=xA(e,i,s.options);4&s.options&&0==s.content.length&&(o|=4),this.nodes.push(new rh(e,n,s.activeMarks,s.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let n=this.open;n>=0;n--)if(this.nodes[n]==e)return this.open=n,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)null==this.find[n].pos&&1==e.nodeType&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)null==this.find[i].pos&&1==e.nodeType&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),s=(i?0:1)-(r?r.depth+1:0),o=(a,l)=>{for(;a>=0;a--){let c=n[a];if(""==c){if(a==n.length-1||0==a)continue;for(;l>=s;l--)if(o(a-1,l))return!0;return!1}{let u=l>0||0==l&&i?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;l--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let n=function l4(t,e){for(let n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(e,this.top.pendingMarks);n&&this.top.stashMarks.push(n),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,n){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==n)break}}}function s4(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function OA(t){let e={};for(let n in t)e[n]=t[n];return e}function a4(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let s=[],o=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}class vi{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=kv(n).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let a=0,l=0;for(;a<s.length&&l<o.marks.length;){let c=o.marks[l];if(this.marks[c.type.name]){if(!c.eq(s[a][0])||!1===c.type.spec.spanning)break;a++,l++}else l++}for(;a<s.length;)i=s.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,n);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=vi.renderSpec(kv(n),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&vi.renderSpec(kv(r),i(e,n))}static renderSpec(e,n,r=null){if("string"==typeof n)return{dom:e.createTextNode(n)};if(null!=n.nodeType)return{dom:n};if(n.dom&&null!=n.dom.nodeType)return n;let i=n[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,a=r?e.createElementNS(r,i):e.createElement(i),l=n[1],c=1;if(l&&"object"==typeof l&&null==l.nodeType&&!Array.isArray(l)){c=2;for(let u in l)if(null!=l[u]){let d=u.indexOf(" ");d>0?a.setAttributeNS(u.slice(0,d),u.slice(d+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<n.length;u++){let d=n[u];if(0===d){if(u<n.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}{let{dom:h,contentDOM:p}=vi.renderSpec(e,d,r);if(a.appendChild(h),p){if(o)throw new RangeError("Multiple content holes");o=p}}}return{dom:a,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new vi(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=RA(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return RA(e.marks)}}function RA(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function kv(t){return t.document||window.document}const PA=Math.pow(2,16);function c4(t,e){return t+e*PA}function LA(t){return 65535&t}class xv{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class Cr{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Cr.empty)return Cr.empty}recover(e){let n=0,r=LA(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*r]+n+function u4(t){return(t-(65535&t))/PA}(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],d=l+c;if(e<=d){let p=l+i+((c?e==l?-1:e==d?1:n:n)<0?0:u);if(r)return p;let m=e==(n<0?l:d)?null:c4(a/3,e-l),v=e==l?2:e==d?1:4;return(n<0?e!=l:e!=d)&&(v|=8),new xv(p,v,m)}i+=u-c}return r?e+i:new xv(e+i,0,null)}touches(e,n){let r=0,i=LA(n),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s];if(e<=l+c&&a==3*i)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+n],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new Cr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?Cr.empty:new Cr(e<0?[0,-e,0]:[0,0,e])}}Cr.empty=new Cr([]);class Qa{constructor(e=[],n,r=0,i=e.length){this.maps=e,this.mirror=n,this.from=r,this.to=i}slice(e=0,n=this.maps.length){return new Qa(this.maps,this.mirror,e,n)}copy(){return new Qa(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,n){this.to=this.maps.push(e),null!=n&&this.setMirror(this.maps.length-1,n)}appendMapping(e){for(let n=0,r=this.maps.length;n<e.maps.length;n++){let i=e.getMirror(n);this.appendMap(e.maps[n],null!=i&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror)for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this.maps.length+e.maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e.maps[n].invert(),null!=i&&i>n?r-i-1:void 0)}}invert(){let e=new Qa;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let s=this.from;s<this.to;s++){let a=this.maps[s].mapResult(e,n);if(null!=a.recover){let l=this.getMirror(s);if(null!=l&&l>s&&l<this.to){s=l,e=this.maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new xv(e,i,null)}}const Nv=Object.create(null);class zn{getMap(){return Cr.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Nv[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Nv)throw new RangeError("Duplicate use of step JSON ID "+e);return Nv[e]=n,n.prototype.jsonID=e,n}}class Wt{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new Wt(e,null)}static fail(e){return new Wt(null,e)}static fromReplace(e,n,r,i){try{return Wt.ok(e.replace(n,r,i))}catch(s){if(s instanceof Jf)return Wt.fail(s.message);throw s}}}function Ov(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let s=t.child(i);s.content.size&&(s=s.copy(Ov(s.content,e,s))),s.isInline&&(s=e(s,n,i)),r.push(s)}return ee.fromArray(r)}class As extends zn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new oe(Ov(n.content,(o,a)=>o.isAtom&&a.type.allowsMarkType(this.mark.type)?o.mark(this.mark.addToSet(o.marks)):o,i),n.openStart,n.openEnd);return Wt.fromReplace(e,this.from,this.to,s)}invert(){return new wi(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new As(n.pos,r.pos,this.mark)}merge(e){return e instanceof As&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new As(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new As(n.from,n.to,e.markFromJSON(n.mark))}}zn.jsonID("addMark",As);class wi extends zn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new oe(Ov(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return Wt.fromReplace(e,this.from,this.to,r)}invert(){return new As(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new wi(n.pos,r.pos,this.mark)}merge(e){return e instanceof wi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new wi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new wi(n.from,n.to,e.markFromJSON(n.mark))}}zn.jsonID("removeMark",wi);class Is extends zn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Wt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Wt.fromReplace(e,this.pos,this.pos+1,new oe(ee.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new Is(this.pos,n.marks[i]);return new Is(this.pos,this.mark)}}return new Xa(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Is(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Is(n.pos,e.markFromJSON(n.mark))}}zn.jsonID("addNodeMark",Is);class Xa extends zn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Wt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Wt.fromReplace(e,this.pos,this.pos+1,new oe(ee.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return n&&this.mark.isInSet(n.marks)?new Is(this.pos,this.mark):this}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Xa(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Xa(n.pos,e.markFromJSON(n.mark))}}zn.jsonID("removeNodeMark",Xa);class yn extends zn{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&Rv(e,this.from,this.to)?Wt.fail("Structure replace would overwrite content"):Wt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Cr([this.from,this.to-this.from,this.slice.size])}invert(e){return new yn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new yn(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof yn)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let n=this.slice.size+e.slice.size==0?oe.empty:new oe(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new yn(e.from,this.to,n,this.structure)}}{let n=this.slice.size+e.slice.size==0?oe.empty:new oe(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new yn(this.from,this.to+(e.to-e.from),n,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new yn(n.from,n.to,oe.fromJSON(e,n.slice),!!n.structure)}}zn.jsonID("replace",yn);class Jt extends zn{constructor(e,n,r,i,s,o,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Rv(e,this.from,this.gapFrom)||Rv(e,this.gapTo,this.to)))return Wt.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Wt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Wt.fromReplace(e,this.from,this.to,r):Wt.fail("Content does not fit in gap")}getMap(){return new Cr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Jt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||s>r.pos?null:new Jt(n.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Jt(n.from,n.to,n.gapFrom,n.gapTo,oe.fromJSON(e,n.slice),n.insert,!!n.structure)}}function Rv(t,e,n){let r=t.resolve(e),i=n-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function p4(t,e,n){return(0==e||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function el(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),s=t.$from.index(r),o=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(s,o,n))return r;if(0==r||i.type.spec.isolating||!p4(i,s,o))break}return null}function Fv(t,e,n=null,r=t){let i=function m4(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.contentMatchAt(r).findWrapping(e);return s&&n.canReplaceWith(r,i,s.length?s[0]:e)?s:null}(t,e),s=i&&function y4(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(n.child(c).type);return l&&l.validEnd?o:null}(r,e);return s?i.map(jA).concat({type:e,attrs:n}).concat(s.map(jA)):null}function jA(t){return{type:t,attrs:null}}function Zi(t,e,n=1,r){let i=t.resolve(e),s=i.depth-n,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=n-2;c>s;c--,u--){let d=i.node(c),h=i.index(c);if(d.type.spec.isolating)return!1;let p=d.content.cutByIndex(h,d.childCount),m=r&&r[u]||d;if(m!=d&&(p=p.replaceChild(0,m.type.create(m.attrs))),!d.canReplace(h+1,d.childCount)||!m.type.validContent(p))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function tl(t,e){let n=t.resolve(e),r=n.index();return function $A(t,e){return!(!t||!e||t.isLeaf||!t.canAppend(e))}(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function HA(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let s=0;s<n.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(1==s)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return 0==a?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function Pv(t,e,n=e,r=oe.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),s=t.resolve(n);return zA(i,s,r)?new yn(e,n,r):new E4(i,s,r).fit()}function zA(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}zn.jsonID("replaceAround",Jt);class E4{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=ee.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=ee.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,a=i.depth;for(;o&&a&&1==s.childCount;)s=s.firstChild.content,o--,a--;let l=new oe(s,o,a);return e>-1?new Jt(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new yn(r.pos,i.pos,l):null}findFittable(){for(let e=1;e<=2;e++)for(let n=this.unplaced.openStart;n>=0;n--){let r,i=null;n?(i=Lv(this.unplaced.content,n-1).firstChild,r=i.content):r=this.unplaced.content;let s=r.firstChild;for(let o=this.depth;o>=0;o--){let c,{type:a,match:l}=this.frontier[o],u=null;if(1==e&&(s?l.matchType(s.type)||(u=l.fillBefore(ee.from(s),!1)):i&&a.compatibleContent(i.type)))return{sliceDepth:n,frontierDepth:o,parent:i,inject:u};if(2==e&&s&&(c=l.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:o,parent:i,wrap:c};if(i&&l.matchType(i.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Lv(e,n);return!(!i.childCount||i.firstChild.isLeaf||(this.unplaced=new oe(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),0))}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Lv(e,n);if(i.childCount<=1&&n>0){let s=e.size-n<=n+i.size;this.unplaced=new oe(eu(e,n-1,1),n-1,s?n-1:r)}else this.unplaced=new oe(eu(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let v=0;v<s.length;v++)this.openFrontierNode(s[v]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:d,type:h}=this.frontier[n];if(i){for(let v=0;v<i.childCount;v++)u.push(i.child(v));d=d.matchFragment(i)}let p=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let v=a.child(c),w=d.matchType(v.type);if(!w)break;c++,(c>1||0==l||v.content.size)&&(d=w,u.push(GA(v.mark(h.allowedMarks(v.marks)),1==c?l:0,c==a.childCount?p:-1)))}let m=c==a.childCount;m||(p=-1),this.placed=tu(this.placed,n,ee.from(u)),this.frontier[n].match=d,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,w=a;v<p;v++){let k=w.lastChild;this.frontier.push({type:k.type,match:k.contentMatchAt(k.childCount)}),w=k.content}this.unplaced=m?0==e?oe.empty:new oe(eu(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new oe(eu(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let n,e=this.frontier[this.depth];if(!e.type.isTextblock||!Vv(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Vv(e,n,i,r,s);if(o){for(let a=n-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Vv(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:n,fit:o,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=tu(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=tu(this.placed,this.depth,ee.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(ee.empty,!0);n.childCount&&(this.placed=tu(this.placed,this.frontier.length,n))}}function eu(t,e,n){return 0==e?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(eu(t.firstChild.content,e-1,n)))}function tu(t,e,n){return 0==e?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(tu(t.lastChild.content,e-1,n)))}function Lv(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function GA(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,GA(r.firstChild,e-1,1==r.childCount?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(ee.empty,!0)))),t.copy(r)}function Vv(t,e,n,r,i){let s=t.node(e),o=i?t.indexAfter(e):t.index(e);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!function M4(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}(n,s.content,o)?a:null}function T4(t){return t.spec.defining||t.spec.definingForContent}function WA(t,e,n,r,i){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(WA(s.content,e+1,n,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(t).append(t);t=o.append(s.matchFragment(o).fillBefore(ee.empty,!0))}return t}function qA(t,e){let n=[];for(let i=Math.min(t.depth,e.depth);i>=0;i--){let s=t.start(i);if(s<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&n.push(i)}return n}class nl extends zn{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return Wt.fail("No node at attribute step's position");let r=Object.create(null);for(let s in n.attrs)r[s]=n.attrs[s];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return Wt.fromReplace(e,this.pos,this.pos+1,new oe(ee.from(i),0,n.isLeaf?0:1))}getMap(){return Cr.empty}invert(e){return new nl(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new nl(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if("number"!=typeof n.pos||"string"!=typeof n.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new nl(n.pos,n.attr,n.value)}}zn.jsonID("attr",nl);let rl=class extends Error{};rl=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n},(rl.prototype=Object.create(Error.prototype)).constructor=rl,rl.prototype.name="TransformError";class x4{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Qa}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new rl(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=oe.empty){let i=Pv(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new oe(ee.from(r),0,0))}delete(e,n){return this.replace(e,n,oe.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return function A4(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),s=t.doc.resolve(n);if(zA(i,s,r))return t.step(new yn(e,n,r));let o=qA(i,t.doc.resolve(n));0==o[o.length-1]&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let h=i.depth,p=i.pos-1;h>0;h--,p--){let m=i.node(h).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;o.indexOf(h)>-1?a=h:i.before(h)==p&&o.splice(1,0,-h)}let l=o.indexOf(a),c=[],u=r.openStart;for(let h=r.content,p=0;;p++){let m=h.firstChild;if(c.push(m),p==r.openStart)break;h=m.content}for(let h=u-1;h>=0;h--){let p=c[h].type,m=T4(p);if(m&&i.node(l).type!=p)u=h;else if(m||!p.isTextblock)break}for(let h=r.openStart;h>=0;h--){let p=(h+u+1)%(r.openStart+1),m=c[p];if(m)for(let v=0;v<o.length;v++){let w=o[(v+l)%o.length],k=!0;w<0&&(k=!1,w=-w);let z=i.node(w-1),B=i.index(w-1);if(z.canReplaceWith(B,B,m.type,m.marks))return t.replace(i.before(w),k?s.after(w):n,new oe(WA(r.content,0,r.openStart,p),p,r.openEnd))}}let d=t.steps.length;for(let h=o.length-1;h>=0&&(t.replace(e,n,r),!(t.steps.length>d));h--){let p=o[h];p<0||(e=i.before(p),n=s.after(p))}}(this,e,n,r),this}replaceRangeWith(e,n,r){return function I4(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=function S4(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,n))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,n))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}(t.doc,e,r.type);null!=i&&(e=n=i)}t.replaceRange(e,n,new oe(ee.from(r),0,0))}(this,e,n,r),this}deleteRange(e,n){return function k4(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),s=qA(r,i);for(let o=0;o<s.length;o++){let a=s[o],l=o==s.length-1;if(l&&0==a||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return t.delete(r.before(a),i.after(a))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&i.end(o)-n!=i.depth-o)return t.delete(r.before(o),n);t.delete(e,n)}(this,e,n),this}lift(e,n){return function g4(t,e,n){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),a=i.after(s+1),l=o,c=a,u=ee.empty,d=0;for(let m=s,v=!1;m>n;m--)v||r.index(m)>0?(v=!0,u=ee.from(r.node(m).copy(u)),d++):l--;let h=ee.empty,p=0;for(let m=s,v=!1;m>n;m--)v||i.after(m+1)<i.end(m)?(v=!0,h=ee.from(i.node(m).copy(h)),p++):c++;t.step(new Jt(l,c,o,a,new oe(u.append(h),d,p),u.size-d,!0))}(this,e,n),this}join(e,n=1){return function D4(t,e,n){let r=new yn(e-n,e+n,oe.empty,!0);t.step(r)}(this,e,n),this}wrap(e,n){return function v4(t,e,n){let r=ee.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let a=n[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=ee.from(n[o].type.create(n[o].attrs,r))}let i=e.start,s=e.end;t.step(new Jt(i,s,i,s,new oe(r,0,0),n.length,!0))}(this,e,n),this}setBlockType(e,n=e,r,i=null){return function w4(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(o,a)=>{if(o.isTextblock&&!o.hasMarkup(r,i)&&function b4(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}(t.doc,t.mapping.slice(s).map(a),r)){t.clearIncompatible(t.mapping.slice(s).map(a,1),r);let l=t.mapping.slice(s),c=l.map(a,1),u=l.map(a+o.nodeSize,1);return t.step(new Jt(c,u,c+1,u-1,new oe(ee.from(r.create(i,null,o.marks)),0,0),1,!0)),!1}})}(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i=[]){return function _4(t,e,n,r,i){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(r,null,i||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Jt(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new oe(ee.from(o),0,0),1,!0))}(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new nl(e,n,r)),this}addNodeMark(e,n){return this.step(new Is(e,n)),this}removeNodeMark(e,n){if(!(n instanceof yt)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(!(n=n.isInSet(r.marks)))return this}return this.step(new Xa(e,n)),this}split(e,n=1,r){return function C4(t,e,n=1,r){let i=t.doc.resolve(e),s=ee.empty,o=ee.empty;for(let a=i.depth,l=i.depth-n,c=n-1;a>l;a--,c--){s=ee.from(i.node(a).copy(s));let u=r&&r[c];o=ee.from(u?u.type.create(u.attrs,o):i.node(a).copy(o))}t.step(new yn(e,e,new oe(s.append(o),n,n),!0))}(this,e,n,r),this}addMark(e,n,r){return function d4(t,e,n,r){let o,a,i=[],s=[];t.doc.nodesBetween(e,n,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),p=Math.min(c+l.nodeSize,n),m=r.addToSet(d);for(let v=0;v<d.length;v++)d[v].isInSet(m)||(o&&o.to==h&&o.mark.eq(d[v])?o.to=p:i.push(o=new wi(h,p,d[v])));a&&a.to==h?a.to=p:s.push(a=new As(h,p,r))}}),i.forEach(l=>t.step(l)),s.forEach(l=>t.step(l))}(this,e,n,r),this}removeMark(e,n,r){return function f4(t,e,n,r){let i=[],s=0;t.doc.nodesBetween(e,n,(o,a)=>{if(!o.isInline)return;s++;let l=null;if(r instanceof eh){let u,c=o.marks;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,n);for(let u=0;u<l.length;u++){let h,d=l[u];for(let p=0;p<i.length;p++){let m=i[p];m.step==s-1&&d.eq(i[p].style)&&(h=m)}h?(h.to=c,h.step=s):i.push({style:d,from:Math.max(a,e),to:c,step:s})}}}),i.forEach(o=>t.step(new wi(o.from,o.to,o.style)))}(this,e,n,r),this}clearIncompatible(e,n,r){return function h4(t,e,n,r=n.contentMatch){let i=t.doc.nodeAt(e),s=[],o=e+1;for(let a=0;a<i.childCount;a++){let l=i.child(a),c=o+l.nodeSize,u=r.matchType(l.type);if(u){r=u;for(let d=0;d<l.marks.length;d++)n.allowsMarkType(l.marks[d].type)||t.step(new wi(o,c,l.marks[d]))}else s.push(new yn(o,c,oe.empty));o=c}if(!r.validEnd){let a=r.fillBefore(ee.empty,!0);t.replace(o,o,new oe(a,0,0))}for(let a=s.length-1;a>=0;a--)t.step(s[a])}(this,e,n,r),this}}const Bv=Object.create(null);class je{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new N4(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=oe.empty){let r=n.content.lastChild,i=null;for(let a=0;a<n.openEnd;a++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?oe.empty:n),0==a&&YA(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:a}=i[s],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,n),YA(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new Ve(e):il(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=n<0?il(e.node(0),e.node(s),e.before(s+1),e.index(s),n,r):il(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new or(e.node(0))}static atStart(e){return il(e,e,0,0,1)||new or(e)}static atEnd(e){return il(e,e,e.content.size,e.childCount,-1)||new or(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Bv[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Bv)throw new RangeError("Duplicate use of selection JSON ID "+e);return Bv[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Ve.between(this.$anchor,this.$head).getBookmark()}}je.prototype.visible=!0;class N4{constructor(e,n){this.$from=e,this.$to=n}}let KA=!1;function JA(t){!KA&&!t.parent.inlineContent&&(KA=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Ve extends je{constructor(e,n=e){JA(e),JA(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return je.near(r);let i=e.resolve(n.map(this.anchor));return new Ve(i.parent.inlineContent?i:r,r)}replace(e,n=oe.empty){if(super.replace(e,n),n==oe.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Ve&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new sh(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ve(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let s=je.findFrom(n,r,!0)||je.findFrom(n,-r,!0);if(!s)return je.near(n,r);n=s.$head}return e.parent.inlineContent||(0==i||(e=(je.findFrom(e,-r,!0)||je.findFrom(e,r,!0)).$anchor).pos<n.pos!=i<0)&&(e=n),new Ve(e,n)}}je.jsonID("text",Ve);class sh{constructor(e,n){this.anchor=e,this.head=n}map(e){return new sh(e.map(this.anchor),e.map(this.head))}resolve(e){return Ve.between(e.resolve(this.anchor),e.resolve(this.head))}}class Se extends je{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),s=e.resolve(i);return r?je.near(s):new Se(s)}content(){return new oe(ee.from(this.node),0,0)}eq(e){return e instanceof Se&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Uv(this.anchor)}static fromJSON(e,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Se(e.resolve(n.anchor))}static create(e,n){return new Se(e.resolve(n))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}Se.prototype.visible=!1,je.jsonID("node",Se);class Uv{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new sh(r,r):new Uv(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&Se.isSelectable(r)?new Se(n):je.near(n)}}class or extends je{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=oe.empty){if(n==oe.empty){e.delete(0,e.doc.content.size);let r=je.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new or(e)}map(e){return new or(e)}eq(e){return e instanceof or}getBookmark(){return O4}}je.jsonID("all",or);const O4={map(){return this},resolve:t=>new or(t)};function il(t,e,n,r,i,s=!1){if(e.inlineContent)return Ve.create(t,n);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let a=e.child(o);if(a.isAtom){if(!s&&Se.isSelectable(a))return Se.create(t,n-(i<0?a.nodeSize:0))}else{let l=il(t,a,n+i,i<0?a.childCount:0,i,s);if(l)return l}n+=a.nodeSize*i}return null}function YA(t,e,n){let r=t.steps.length-1;if(r<e)return;let o,i=t.steps[r];(i instanceof yn||i instanceof Jt)&&(t.mapping.maps[r].forEach((a,l,c,u)=>{null==o&&(o=u)}),t.setSelection(je.near(t.doc.resolve(o),n)))}class R4 extends x4{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return yt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,n){super.addStep(e,n),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||yt.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(null==n)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(null==r&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(n);s=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,s)),this.selection.empty||this.setSelection(je.near(this.selection.$to)),this}}setMeta(e,n){return this.meta["string"==typeof e?e:e.key]=n,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function XA(t,e){return e&&t?t.bind(e):t}class nu{constructor(e,n,r){this.name=e,this.init=XA(n.init,r),this.apply=XA(n.apply,r)}}const F4=[new nu("doc",{init:t=>t.doc||t.schema.topNodeType.createAndFill(),apply:t=>t.doc}),new nu("selection",{init:(t,e)=>t.selection||je.atStart(e.doc),apply:t=>t.selection}),new nu("storedMarks",{init:t=>t.storedMarks||null,apply:(t,e,n,r)=>r.selection.$cursor?t.storedMarks:null}),new nu("scrollToSelection",{init:()=>0,apply:(t,e)=>t.scrolledIntoView?e+1:e})];class jv{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=F4.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new nu(r.key,r.spec.state,r))})}}class sl{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=i?i[o].n:0,c=i?i[o].state:this,u=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<o?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),s=!0}i&&(i[o]={state:r,n:n.length})}}if(!s)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new sl(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new R4(this)}static create(e){let n=new jv(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new sl(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new jv(this.schema,e.plugins),r=n.fields,i=new sl(n);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&"object"==typeof e)for(let r in e){if("doc"==r||"selection"==r)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(n[r]=s.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new jv(e.schema,e.plugins),s=new sl(i);return i.fields.forEach(o=>{if("doc"==o.name)s.doc=yi.fromJSON(e.schema,n.doc);else if("selection"==o.name)s.selection=je.fromJSON(s.doc,n.selection);else if("storedMarks"==o.name)n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,a))return void(s[o.name]=c.fromJSON.call(l,e,n[a],s))}s[o.name]=o.init(e,s)}}),s}}function eI(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):"handleDOMEvents"==r&&(i=eI(i,e,{})),n[r]=i}return n}class An{constructor(e){this.spec=e,this.props={},e.props&&eI(e.props,this,this.props),this.key=e.key?e.key.key:tI("plugin")}getState(e){return e[this.key]}}const $v=Object.create(null);function tI(t){return t in $v?t+"$"+ ++$v[t]:($v[t]=0,t+"$")}class qr{constructor(e="key"){this.key=tI(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const ar=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},ru=function(t){let e=t.assignedSlot||t.parentNode;return e&&11==e.nodeType?e.host:e};let nI=null;const Qi=function(t,e,n){let r=nI||(nI=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},xo=function(t,e,n,r){return n&&(rI(t,e,n,r,-1)||rI(t,e,n,r,1))},P4=/^(img|br|input|textarea|hr)$/i;function rI(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:bi(t))){let s=t.parentNode;if(!s||1!=s.nodeType||V4(t)||P4.test(t.nodeName)||"false"==t.contentEditable)return!1;e=ar(t)+(i<0?0:1),t=s}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(i<0?-1:0)]).contentEditable)return!1;e=i<0?bi(t):0}}}function bi(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function V4(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const ah=function(t){return t.focusNode&&xo(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function ol(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}const ks=typeof navigator<"u"?navigator:null,iI=typeof document<"u"?document:null,xs=ks&&ks.userAgent||"",Hv=/Edge\/(\d+)/.exec(xs),sI=/MSIE \d/.exec(xs),zv=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(xs),Gn=!!(sI||zv||Hv),Ns=sI?document.documentMode:zv?+zv[1]:Hv?+Hv[1]:0,Kr=!Gn&&/gecko\/(\d+)/i.test(xs);Kr&&/Firefox\/(\d+)/.exec(xs);const Gv=!Gn&&/Chrome\/(\d+)/.exec(xs),Wn=!!Gv,U4=Gv?+Gv[1]:0,In=!Gn&&!!ks&&/Apple Computer/.test(ks.vendor),al=In&&(/Mobile\/\w+/.test(xs)||!!ks&&ks.maxTouchPoints>2),Dr=al||!!ks&&/Mac/.test(ks.platform),_i=/Android \d/.test(xs),lh=!!iI&&"webkitFontSmoothing"in iI.documentElement.style,j4=lh?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function $4(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Os(t,e){return"number"==typeof t?t:t[e]}function H4(t){let e=t.getBoundingClientRect();return{left:e.left,right:e.left+t.clientWidth*(e.width/t.offsetWidth||1),top:e.top,bottom:e.top+t.clientHeight*(e.height/t.offsetHeight||1)}}function oI(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let o=n||t.dom;o;o=ru(o)){if(1!=o.nodeType)continue;let a=o,l=a==s.body,c=l?$4(s):H4(a),u=0,d=0;if(e.top<c.top+Os(r,"top")?d=-(c.top-e.top+Os(i,"top")):e.bottom>c.bottom-Os(r,"bottom")&&(d=e.bottom-c.bottom+Os(i,"bottom")),e.left<c.left+Os(r,"left")?u=-(c.left-e.left+Os(i,"left")):e.right>c.right-Os(r,"right")&&(u=e.right-c.right+Os(i,"right")),u||d)if(l)s.defaultView.scrollBy(u,d);else{let h=a.scrollLeft,p=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let m=a.scrollLeft-h,v=a.scrollTop-p;e={left:e.left-m,top:e.top-v,right:e.right-m,bottom:e.bottom-v}}if(l)break}}function aI(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=ru(r));return e}function lI(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:s}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let ll=null;function cI(t,e){let n,i,r=2e8,s=0,o=e.top,a=e.top;for(let l=t.firstChild,c=0;l;l=l.nextSibling,c++){let u;if(1==l.nodeType)u=l.getClientRects();else{if(3!=l.nodeType)continue;u=Qi(l).getClientRects()}for(let d=0;d<u.length;d++){let h=u[d];if(h.top<=o&&h.bottom>=a){o=Math.max(h.bottom,o),a=Math.min(h.top,a);let p=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(p<r){n=l,r=p,i=p&&3==n.nodeType?{left:h.right<e.left?h.right:h.left,top:e.top}:e,1==l.nodeType&&p&&(s=c+(e.left>=(h.left+h.right)/2?1:0));continue}}!n&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(s=c+1)}}return n&&3==n.nodeType?function q4(t,e){let n=t.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let s=Rs(r,1);if(s.top!=s.bottom&&Wv(e,s))return{node:t,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:t,offset:0}}(n,i):!n||r&&1==n.nodeType?{node:t,offset:s}:cI(n,i)}function Wv(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function uI(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),s=i;;){let o=t.childNodes[s];if(1==o.nodeType){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Wv(e,c))return uI(o,e,c)}}if((s=(s+1)%r)==i)break}return t}function Z4(t,e){let r,n=t.dom.ownerDocument,i=0;if(n.caretPositionFromPoint)try{let l=n.caretPositionFromPoint(e.left,e.top);l&&({offsetNode:r,offset:i}=l)}catch{}if(!r&&n.caretRangeFromPoint){let l=n.caretRangeFromPoint(e.left,e.top);l&&({startContainer:r,startOffset:i}=l)}let o,s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top);if(!s||!t.dom.contains(1!=s.nodeType?s.parentNode:s)){let l=t.dom.getBoundingClientRect();if(!Wv(e,l)||(s=uI(t.dom,e,l),!s))return null}if(In)for(let l=s;r&&l;l=ru(l))l.draggable&&(r=void 0);if(s=function K4(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(s,e),r){if(Kr&&1==r.nodeType&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c,l=r.childNodes[i];"IMG"==l.nodeName&&(c=l.getBoundingClientRect()).right<=e.left&&c.bottom>e.top&&i++}r==t.dom&&i==r.childNodes.length-1&&1==r.lastChild.nodeType&&e.top>r.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(0==i||1!=r.nodeType||"BR"!=r.childNodes[i-1].nodeName)&&(o=function Y4(t,e,n,r){let i=-1;for(let s=e;s!=t.dom;){let o=t.docView.nearestDesc(s,!0);if(!o)return null;if(o.node.isBlock&&o.parent){let a=o.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)i=o.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;i=o.posAfter}}s=o.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,1)}(t,r,i,e))}null==o&&(o=function J4(t,e,n){let{node:r,offset:i}=cI(e,n),s=-1;if(1==r.nodeType&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,i,s)}(t,s,e));let a=t.docView.nearestDesc(s,!0);return{pos:o,inside:a?a.posAtStart-a.border:-1}}function Rs(t,e){let n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}const Q4=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function dI(t,e,n){let{node:r,offset:i,atom:s}=t.docView.domFromPos(e,n<0?-1:1),o=lh||Kr;if(3==r.nodeType){if(!o||!Q4.test(r.nodeValue)&&(n<0?i:i!=r.nodeValue.length)){let l=i,c=i,u=n<0?1:-1;return n<0&&!i?(c++,u=-1):n>=0&&i==r.nodeValue.length?(l--,u=1):n<0?l--:c++,iu(Rs(Qi(r,l,c),1),u<0)}{let l=Rs(Qi(r,i,i),n);if(Kr&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=Rs(Qi(r,i-1,i-1),-1);if(c.top==l.top){let u=Rs(Qi(r,i,i+1),-1);if(u.top!=l.top)return iu(u,u.left<c.left)}}return l}}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(null==s&&i&&(n<0||i==bi(r))){let l=r.childNodes[i-1];if(1==l.nodeType)return qv(l.getBoundingClientRect(),!1)}if(null==s&&i<bi(r)){let l=r.childNodes[i];if(1==l.nodeType)return qv(l.getBoundingClientRect(),!0)}return qv(r.getBoundingClientRect(),n>=0)}if(null==s&&i&&(n<0||i==bi(r))){let l=r.childNodes[i-1],c=3==l.nodeType?Qi(l,bi(l)-(o?0:1)):1!=l.nodeType||"BR"==l.nodeName&&l.nextSibling?null:l;if(c)return iu(Rs(c,1),!1)}if(null==s&&i<bi(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?3==l.nodeType?Qi(l,0,o?0:1):1==l.nodeType?l:null:null;if(c)return iu(Rs(c,-1),!0)}return iu(Rs(3==r.nodeType?Qi(r):r,-n),n>=0)}function iu(t,e){if(0==t.width)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function qv(t,e){if(0==t.height)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function fI(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}const e5=/[\u0590-\u08ac]/;let hI=null,pI=null,gI=!1;class su{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=0,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&(!(o=s.pmViewDesc)||o.parent!=this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}{let s,o;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&(!(o=s.pmViewDesc)||o.parent!=this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}}let i;if(e==this.dom&&this.contentDOM)i=n>ar(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==n)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(null==i&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let o,s=this.getDesc(i);if(s&&(!n||s.node)){if(!r||!(o=s.nodeDOM)||(1==o.nodeType?o.contains(1==e.nodeType?e:e.parentNode):o==e))return s;r=!1}}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let s,r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.size;if(a>e||o instanceof wI){i=e-s;break}s=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(;r&&!(s=this.children[r-1]).size&&s instanceof yI&&s.side>=0;r--);if(n<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,s&&s.dom.parentNode!=this.contentDOM;r--,o=!1);return s&&n&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?ar(s.dom)+1:0}}{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,s&&s.dom.parentNode!=this.contentDOM;r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?ar(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(-1==i&&e<=c){let u=o+l.border;if(e>=u&&n<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,u);e=o;for(let d=a;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){i=ar(h.dom)+1;break}e-=h.size}-1==i&&(i=0)}if(i>-1&&(c>n||a==this.children.length-1)){n=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=ar(d.dom);break}n+=d.size}-1==s&&(s=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return 0==n.size||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let s=Math.min(e,n),o=Math.max(e,n);for(let h=0,p=0;h<this.children.length;h++){let m=this.children[h],v=p+m.size;if(s>p&&o<v)return m.setSelection(e-p-m.border,n-p-m.border,r,i);p=v}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),c=r.getSelection(),u=!1;if((Kr||In)&&e==n){let{node:h,offset:p}=a;if(3==h.nodeType){if(u=!(!p||"\n"!=h.nodeValue[p-1]),u&&p==h.nodeValue.length)for(let v,m=h;m;m=m.parentNode){if(v=m.nextSibling){"BR"==v.nodeName&&(a=l={node:v.parentNode,offset:ar(v)+1});break}let w=m.pmViewDesc;if(w&&w.node&&w.node.isBlock)break}}else{let m=h.childNodes[p-1];u=m&&("BR"==m.nodeName||"false"==m.contentEditable)}}if(Kr&&c.focusNode&&c.focusNode!=l.node&&1==c.focusNode.nodeType){let h=c.focusNode.childNodes[c.focusOffset];h&&"false"==h.contentEditable&&(i=!0)}if(!(i||u&&In)&&xo(a.node,a.offset,c.anchorNode,c.anchorOffset)&&xo(l.node,l.offset,c.focusNode,c.focusOffset))return;let d=!1;if((c.extend||e==n)&&!u){c.collapse(a.node,a.offset);try{e!=n&&c.extend(l.node,l.offset),d=!0}catch{}}if(!d){if(e>n){let p=a;a=l,l=p}let h=document.createRange();h.setEnd(l.node,l.offset),h.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let a=r+s.border,l=o-s.border;if(e>=a&&n<=l)return this.dirty=e==r||n==o?2:1,void(e!=a||n!=l||!s.contentLost&&s.dom.parentNode==this.contentDOM?s.markDirty(e-a,n-a):s.dirty=3);s.dirty=s.dom!=s.contentDOM||s.dom.parentNode!=this.contentDOM||s.children.length?3:2}r=o}this.dirty=2}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=1==e?2:1;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class yI extends su{constructor(e,n,r,i){let s,o=n.type.toDOM;if("function"==typeof o&&(o=o(r,()=>s?s.parent?s.parent.posBeforeChild(s):void 0:i)),!n.type.spec.raw){if(1!=o.nodeType){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return!!n&&n(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class r5 extends su{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class No extends su{constructor(e,n,r,i){super(e,[],r,i),this.mark=n}static create(e,n,r,i){let s=i.nodeViews[n.type.name],o=s&&s(n,i,r);return(!o||!o.dom)&&(o=vi.renderSpec(document,n.type.spec.toDOM(n,r))),new No(e,n,o.dom,o.contentDOM||o.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),0!=this.dirty){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}}slice(e,n,r){let i=No.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;n<o&&(s=Yv(s,n,o,r)),e>0&&(s=Yv(s,0,e,r));for(let a=0;a<s.length;a++)s[a].parent=i;return i.children=s,i}}class Oo extends su{constructor(e,n,r,i,s,o,a,l,c){super(e,[],s,o),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a,o&&this.updateChildren(l,c)}static create(e,n,r,i,s,o){let l,a=s.nodeViews[n.type.name],c=a&&a(n,s,()=>l?l.parent?l.parent.posBeforeChild(l):void 0:o,r,i),u=c&&c.dom,d=c&&c.contentDOM;if(n.isText)if(u){if(3!=u.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else u=document.createTextNode(n.text);else u||({dom:u,contentDOM:d}=vi.renderSpec(document,n.type.spec.toDOM(n)));!d&&!n.isText&&"BR"!=u.nodeName&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),n.type.spec.draggable&&(u.draggable=!0));let h=u;return u=CI(u,r,n),c?l=new i5(e,n,r,i,u,d||null,h,c,s,o+1):n.isText?new ch(e,n,r,i,u,h,s):new Oo(e,n,r,i,u,d||null,h,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>ee.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,n,r){return 0==this.dirty&&e.eq(this.node)&&Jv(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,s=e.composing?this.localCompositionInfo(e,n):null,o=s&&s.pos>-1?s:null,a=s&&s.pos<0,l=new o5(this,o&&o.node,e);(function c5(t,e,n,r){let i=e.locals(t),s=0;if(0==i.length){for(let c=0;c<t.childCount;c++){let u=t.child(c);r(u,i,e.forChild(s,u),c),s+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){if(o<i.length&&i[o].to==s){let v,m=i[o++];for(;o<i.length&&i[o].to==s;)(v||(v=[m])).push(i[o++]);if(v){v.sort(l5);for(let w=0;w<v.length;w++)n(v[w],c,!!l)}else n(m,c,!!l)}let u,d;if(l)d=-1,u=l,l=null;else{if(!(c<t.childCount))break;d=c,u=t.child(c++)}for(let m=0;m<a.length;m++)a[m].to<=s&&a.splice(m--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)a.push(i[o++]);let h=s+u.nodeSize;if(u.isText){let m=h;o<i.length&&i[o].from<m&&(m=i[o].from);for(let v=0;v<a.length;v++)a[v].to<m&&(m=a[v].to);m<h&&(l=u.cut(m-s),u=u.cut(0,m-s),h=m,d=-1)}r(u,u.isInline&&!u.isLeaf?a.filter(m=>!m.inline):a.slice(),e.forChild(s,u),d),s=h}})(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?yt.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,d,h)=>{let p;l.syncToMarks(c.marks,r,e),l.findNodeMatch(c,u,d,h)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(p=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(c,u,d,p,e)||l.updateNextNode(c,u,d,e,h)||l.addNode(c,u,d,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||2==this.dirty)&&(o&&this.protectLocalComposition(e,o),bI(this.contentDOM,this.children,e),al&&function u5(t){if("UL"==t.nodeName||"OL"==t.nodeName){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t),t.style.cssText=e}}(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof Ve)||r<n||i>n+this.node.content.size)return null;let s=e.domSelectionRange(),o=function d5(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];e=bi(t=t.childNodes[e-1])}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(s.focusNode,s.focusOffset);if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let a=o.nodeValue,l=function f5(t,e,n,r){for(let i=0,s=0;i<t.childCount&&s<=r;){let o=t.child(i++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;i<t.childCount;){let c=t.child(i++);if(s+=c.nodeSize,!c.isText)break;l+=c.text}if(s>=n){let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=n)return a+c;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}(this.node.content,a,r-n,i-n);return l<0?null:{node:o,pos:l,text:a}}return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new r5(this,s,n,i);e.input.compositionNodes.push(o),this.children=Yv(this.children,r,r+i.length,e,o)}update(e,n,r,i){return!(3==this.dirty||!e.sameMarkup(this.node)||(this.updateInner(e,n,r,i),0))}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(Jv(e,this.outerDeco))return;let n=1!=this.nodeDOM.nodeType,r=this.dom;this.dom=_I(this.dom,this.nodeDOM,Kv(this.outerDeco,this.node,n),Kv(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function vI(t,e,n,r,i){return CI(r,e,t),new Oo(void 0,t,e,n,r,r,r,i,0)}class ch extends Oo{constructor(e,n,r,i,s,o,a){super(e,n,r,i,s,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node)||(this.updateOuterDeco(n),(0!=this.dirty||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=0,0))}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,n,r){let i=this.node.cut(e,n),s=document.createTextNode(i.text);return new ch(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(0==e||n==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class wI extends su{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class i5 extends Oo{constructor(e,n,r,i,s,o,a,l,c,u){super(e,n,r,i,s,o,a,c,u),this.spec=l}update(e,n,r,i){if(3==this.dirty)return!1;if(this.spec.update){let s=this.spec.update(e,n,r);return s&&this.updateInner(e,n,r,i),s}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function bI(t,e,n){let r=t.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],a=o.dom;if(a.parentNode==t){for(;a!=r;)r=DI(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(a,r);if(o instanceof No){let l=r?r.previousSibling:t.lastChild;bI(o.contentDOM,o.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=DI(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const ou=function(t){t&&(this.nodeName=t)};ou.prototype=Object.create(null);const Ro=[new ou];function Kv(t,e,n){if(0==t.length)return Ro;let r=n?Ro[0]:new ou,i=[r];for(let s=0;s<t.length;s++){let o=t[s].type.attrs;if(o){o.nodeName&&i.push(r=new ou(o.nodeName));for(let a in o){let l=o[a];null!=l&&(n&&1==i.length&&i.push(r=new ou(e.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+l:"style"==a?r.style=(r.style?r.style+";":"")+l:"nodeName"!=a&&(r[a]=l))}}}return i}function _I(t,e,n,r){if(n==Ro&&r==Ro)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(s){let l;a&&a.nodeName==o.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=Ro[0]),i=l}s5(i,a||Ro[0],o)}return i}function s5(t,e,n){for(let r in e)"class"!=r&&"style"!=r&&"nodeName"!=r&&!(r in n)&&t.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)-1==i.indexOf(r[s])&&t.classList.remove(r[s]);for(let s=0;s<i.length;s++)-1==r.indexOf(i[s])&&t.classList.add(i[s]);0==t.classList.length&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let i,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function CI(t,e,n){return _I(t,t,Ro,Kv(e,n,1!=t.nodeType))}function Jv(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function DI(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class o5{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function a5(t,e){let n=e,r=n.children.length,i=t.childCount,s=new Map,o=[];e:for(;i>0;){let a;for(;;)if(r){let c=n.children[r-1];if(!(c instanceof No)){a=c,r--;break}n=c,r=c.children.length}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(i-1))break;--i,s.set(a,i),o.push(a)}}return{index:i,matched:s,matches:o.reverse()}}(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&!1!==e[i].type.spec.spanning;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++)if(this.top.children[l].matchesMark(e[s])){a=l;break}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=No.create(this.top,e[s],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,r,i){let o,s=-1;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))s=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,n,r)&&!this.preMatch.matched.has(c)){s=a;break}}return!(s<0||(this.destroyBetween(this.index,s),this.index++,0))}updateNodeAt(e,n,r,i,s){let o=this.top.children[i];return 3==o.dirty&&o.dom==o.contentDOM&&(o.dirty=2),!!o.update(e,n,r,s)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r)for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i;return-1}e=n}}updateNextNode(e,n,r,i,s){for(let o=this.index;o<this.top.children.length;o++){let a=this.top.children[o];if(a instanceof Oo){let l=this.preMatch.matched.get(a);if(null!=l&&l!=s)return!1;let c=a.dom;if((!this.lock||!(c==this.lock||1==c.nodeType&&c.contains(this.lock.parentNode))||e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&Jv(n,a.outerDeco))&&a.update(e,n,r,i))return this.destroyBetween(this.index,o),a.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(e,n,r,i,s){this.top.children.splice(this.index++,0,Oo.create(this.top,e,n,r,i,s)),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(e)||e!=i.widget&&i.widget.type.toDOM.parentNode){let s=new yI(this.top,e,n,r);this.top.children.splice(this.index++,0,s),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof No;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof ch)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((In||Wn)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);"IMG"==e&&(r.className="ProseMirror-separator",r.alt=""),"BR"==e&&(r.className="ProseMirror-trailingBreak");let i=new wI(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}}function l5(t,e){return t.type.side-e.type.side}function Yv(t,e,n,r,i){let s=[];for(let o=0,a=0;o<t.length;o++){let l=t[o],c=a,u=a+=l.size;c>=n||u<=e?s.push(l):(c<e&&s.push(l.slice(0,e-c,r)),i&&(s.push(i),i=void 0),u>n&&s.push(l.slice(n-c,l.size,r)))}return s}function Zv(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),s=i&&0==i.size,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let l,c,a=r.resolve(o);if(ah(n)){for(l=a;i&&!i.node;)i=i.parent;let u=i.node;if(i&&u.isAtom&&Se.isSelectable(u)&&i.parent&&(!u.isInline||!function L4(t,e,n){for(let r=0==e,i=e==bi(t);r||i;){if(t==n)return!0;let s=ar(t);if(!(t=t.parentNode))return!1;r=r&&0==s,i=i&&s==bi(t)}}(n.focusNode,n.focusOffset,i.dom))){let d=i.posBefore;c=new Se(o==d?a:r.resolve(d))}}else{let u=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(u<0)return null;l=r.resolve(u)}return c||(c=Xv(t,l,a,"pointer"==e||t.state.selection.head<a.pos&&!s?1:-1)),c}function SI(t){return t.editable?t.hasFocus():xI(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Xi(t,e=!1){let n=t.state.selection;if(AI(t,n),SI(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Wn){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&xo(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset))return t.input.mouseDown.delayedSelectionSync=!0,void t.domObserver.setCurSelection()}if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function p5(t){let e=t.domSelection(),n=document.createRange(),r=t.cursorWrapper.dom,i="IMG"==r.nodeName;i?n.setEnd(r.parentNode,ar(r)+1):n.setEnd(r,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!i&&!t.state.selection.visible&&Gn&&Ns<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{let s,o,{anchor:r,head:i}=n;EI&&!(n instanceof Ve)&&(n.$from.parent.inlineContent||(s=MI(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=MI(t,n.to))),t.docView.setSelection(r,i,t.root,e),EI&&(s&&TI(s),o&&TI(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function h5(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!SI(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const EI=In||Wn&&U4<63;function MI(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(In&&i&&"false"==i.contentEditable)return Qv(i);if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return Qv(i);if(s)return Qv(s)}}function Qv(t){return t.contentEditable="true",In&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function TI(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function AI(t,e){if(e instanceof Se){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(II(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else II(t)}function II(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Xv(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||Ve.between(e,n,r)}function kI(t){return!(t.editable&&!t.hasFocus())&&xI(t)}function xI(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function ew(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&je.findFrom(s,e)}function Fo(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function NI(t,e,n){let r=t.state.selection;if(!(r instanceof Ve)){if(r instanceof Se&&r.node.isInline)return Fo(t,new Ve(e>0?r.$to:r.$from));{let i=ew(t.state,e);return!!i&&Fo(t,i)}}if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){let i=ew(t.state,e);return!!(i&&i instanceof Se)&&Fo(t,i)}if(!(Dr&&n.indexOf("m")>-1)){let o,i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText)return!1;let a=e<0?i.pos-s.nodeSize:i.pos;return!!(s.isAtom||(o=t.docView.descAt(a))&&!o.contentDOM)&&(Se.isSelectable(s)?Fo(t,new Se(e<0?t.state.doc.resolve(i.pos-s.nodeSize):i)):!!lh&&Fo(t,new Ve(t.state.doc.resolve(e<0?a:a+s.nodeSize))))}}function uh(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function au(t){let e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function tw(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,s,o=!1;for(Kr&&1==n.nodeType&&r<uh(n)&&au(n.childNodes[r])&&(o=!0);;)if(r>0){if(1!=n.nodeType)break;{let a=n.childNodes[r-1];if(au(a))i=n,s=--r;else{if(3!=a.nodeType)break;n=a,r=n.nodeValue.length}}}else{if(OI(n))break;{let a=n.previousSibling;for(;a&&au(a);)i=n.parentNode,s=ar(a),a=a.previousSibling;if(a)n=a,r=uh(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?rw(t,n,r):i&&rw(t,i,s)}function nw(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s,o,i=uh(n);for(;;)if(r<i){if(1!=n.nodeType)break;if(!au(n.childNodes[r]))break;s=n,o=++r}else{if(OI(n))break;{let a=n.nextSibling;for(;a&&au(a);)s=a.parentNode,o=ar(a)+1,a=a.nextSibling;if(a)n=a,r=0,i=uh(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}s&&rw(t,s,o)}function OI(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function rw(t,e,n){let r=t.domSelection();if(ah(r)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Xi(t)},50)}function RI(t,e,n){let r=t.state.selection;if(r instanceof Ve&&!r.empty||n.indexOf("s")>-1||Dr&&n.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=ew(t.state,e);if(o&&o instanceof Se)return Fo(t,o)}if(!i.parent.inlineContent){let o=e<0?i:s,a=r instanceof or?je.near(o,e):je.findFrom(o,e);return!!a&&Fo(t,a)}return!1}function FI(t,e){if(!(t.state.selection instanceof Ve))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let o=t.state.tr;return e<0?o.delete(n.pos-s.nodeSize,n.pos):o.delete(n.pos,n.pos+s.nodeSize),t.dispatch(o),!0}return!1}function PI(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function LI(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&1==r.childCount&&1==r.firstChild.childCount;){i--,s--;let p=r.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let o=t.someProp("clipboardSerializer")||vi.fromSchema(t.state.schema),a=GI(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let u,c=l.firstChild,d=0;for(;c&&1==c.nodeType&&(u=HI[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let m=a.createElement(u[p]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),d++}c=l.firstChild}return c&&1==c.nodeType&&c.setAttribute("data-pm-slice",`${i} ${s}${d?` -${d}`:""} ${JSON.stringify(n)}`),{dom:l,text:t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,"\n\n")}}function VI(t,e,n,r,i){let o,a,s=i.parent.type.spec.code;if(!n&&!e)return null;let l=e&&(r||s||!n);if(l){if(t.someProp("transformPastedText",h=>{e=h(e,s||r,t)}),s)return e?new oe(ee.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0):oe.empty;let d=t.someProp("clipboardTextParser",h=>h(e,i,r,t));if(d)a=d;else{let h=i.marks(),{schema:p}=t.state,m=vi.fromSchema(p);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let w=o.appendChild(document.createElement("p"));v&&w.appendChild(m.serializeNode(p.text(v,h)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),o=function _5(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let i,n=GI().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t);if((i=r&&HI[r[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=t,i)for(let s=0;s<i.length;s++)n=n.querySelector(i[s])||n;return n}(n),lh&&function C5(t){let e=t.querySelectorAll(Wn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=o.firstChild;for(;h&&1!=h.nodeType;)h=h.nextSibling;if(!h)break;o=h}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||Za.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!(!l&&!u),context:i,ruleFromNode:h=>"BR"!=h.nodeName||h.nextSibling||!h.parentNode||w5.test(h.parentNode.nodeName)?null:{ignore:!0}})),u)a=function D5(t,e){if(!t.size)return t;let r,n=t.content.firstChild.type.schema;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:o}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=ee.from(l.create(r[a+1],i)),s++,o++}return new oe(i,s,o)}($I(a,+u[1],+u[2]),u[4]);else if(a=oe.maxOpen(function b5(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let s,i=e.node(n).contentMatchAt(e.index(n)),o=[];if(t.forEach(a=>{if(!o)return;let c,l=i.findWrapping(a.type);if(!l)return o=null;if(c=o.length&&s.length&&UI(l,s,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=jI(o[o.length-1],s.length));let u=BI(a,l);o.push(u),i=i.matchType(u.type),s=l}}),o)return ee.from(o)}return t}(a.content,i),!0),a.openStart||a.openEnd){let d=0,h=0;for(let p=a.content.firstChild;d<a.openStart&&!p.type.spec.isolating;d++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=$I(a,d,h)}return t.someProp("transformPasted",d=>{a=d(a,t)}),a}const w5=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function BI(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,ee.from(t));return t}function UI(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=UI(t,e,n,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(ee.from(BI(n,t,i+1))))}}function jI(t,e){if(0==e)return t;let n=t.content.replaceChild(t.childCount-1,jI(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(ee.empty,!0);return t.copy(n.append(r))}function iw(t,e,n,r,i,s){let o=e<0?t.firstChild:t.lastChild,a=o.content;return i<r-1&&(a=iw(a,e,n,r,i+1,s)),i>=n&&(a=e<0?o.contentMatchAt(0).fillBefore(a,t.childCount>1||s<=i).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(ee.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(a))}function $I(t,e,n){return e<t.openStart&&(t=new oe(iw(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new oe(iw(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const HI={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let zI=null;function GI(){return zI||(zI=document.implementation.createHTMLDocument("title"))}const kn={},xn={},S5={touchstart:!0,touchmove:!0};class E5{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Fs(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function sw(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>ow(t,r))})}function ow(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)})}function A5(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function dh(t){return{left:t.clientX,top:t.clientY}}function aw(t,e,n,r,i){if(-1==r)return!1;let s=t.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(t.someProp(e,a=>o>s.depth?a(t,n,s.nodeAfter,s.before(o),i,!0):a(t,n,s.node(o),s.before(o),i,!1)))return!0;return!1}function ul(t,e,n){t.focused||t.focus();let r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function R5(t,e,n,r){return aw(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function F5(t,e,n,r){return aw(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||function P5(t,e,n){if(0!=n.button)return!1;let r=t.state.doc;if(-1==e)return!!r.inlineContent&&(ul(t,Ve.create(r,0,r.content.size),"pointer"),!0);let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),a=i.before(s);if(o.inlineContent)ul(t,Ve.create(r,a+1,a+1+o.content.size),"pointer");else{if(!Se.isSelectable(o))continue;ul(t,Se.create(r,a),"pointer")}return!0}}(t,n,r)}function lw(t){return fh(t)}xn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=16==n.keyCode||n.shiftKey,!qI(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!_i||!Wn||13!=n.keyCode))if(229!=n.keyCode&&t.domObserver.forceFlush(),!al||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)t.someProp("handleKeyDown",r=>r(t,n))||function v5(t,e){let n=e.keyCode,r=function y5(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||Dr&&72==n&&"c"==r?FI(t,-1)||tw(t):46==n||Dr&&68==n&&"c"==r?FI(t,1)||nw(t):13==n||27==n||(37==n||Dr&&66==n&&"c"==r?NI(t,-1,r)||tw(t):39==n||Dr&&70==n&&"c"==r?NI(t,1,r)||nw(t):38==n||Dr&&80==n&&"c"==r?RI(t,-1,r)||tw(t):40==n||Dr&&78==n&&"c"==r?function m5(t){if(!In||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&1==e.nodeType&&0==n&&e.firstChild&&"false"==e.firstChild.contentEditable){let r=e.firstChild;PI(t,r,"true"),setTimeout(()=>PI(t,r,"false"),20)}return!1}(t)||RI(t,1,r)||nw(t):r==(Dr?"m":"c")&&(66==n||73==n||89==n||90==n))}(t,n)?n.preventDefault():Fs(t,"key");else{let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,ol(13,"Enter"))),t.input.lastIOSEnter=0)},200)}},xn.keyup=(t,e)=>{16==e.keyCode&&(t.input.shiftKey=!1)},xn.keypress=(t,e)=>{let n=e;if(qI(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Dr&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n)))return void n.preventDefault();let r=t.state.selection;if(!(r instanceof Ve&&r.$from.sameParent(r.$to))){let i=String.fromCharCode(n.charCode);t.someProp("handleTextInput",s=>s(t,r.$from.pos,r.$to.pos,i))||t.dispatch(t.state.tr.insertText(i).scrollIntoView()),n.preventDefault()}};const WI=Dr?"metaKey":"ctrlKey";kn.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=lw(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&function k5(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(n,t.input.lastClick)&&!n[WI]&&("singleClick"==t.input.lastClick.type?s="doubleClick":"doubleClick"==t.input.lastClick.type&&(s="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:s};let o=t.posAtCoords(dh(n));!o||("singleClick"==s?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new L5(t,o,n,!!r)):("doubleClick"==s?R5:F5)(t,o.pos,o.inside,n)?n.preventDefault():Fs(t,"pointer"))};class L5{constructor(e,n,r,i){let s,o;if(this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[WI],this.allowDefault=r.shiftKey,n.inside>-1)s=e.state.doc.nodeAt(n.inside),o=n.inside;else{let u=e.state.doc.resolve(n.pos);s=u.parent,o=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l?l.dom:null;let{selection:c}=e.state;(0==r.button&&s.type.spec.draggable&&!1!==s.type.spec.selectable||c instanceof Se&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Kr||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Fs(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Xi(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(dh(e))),this.updateAllowDefault(e),this.allowDefault||!n?Fs(this.view,"pointer"):function O5(t,e,n,r,i){return aw(t,"handleClickOn",e,n,r)||t.someProp("handleClick",s=>s(t,e,r))||(i?function N5(t,e){if(-1==e)return!1;let r,i,n=t.state.selection;n instanceof Se&&(r=n.node);let s=t.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let a=o>s.depth?s.nodeAfter:s.node(o);if(Se.isSelectable(a)){i=r&&n.$from.depth>0&&o>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?s.before(n.$from.depth):s.before(o);break}}return null!=i&&(ul(t,Se.create(t.state.doc,i),"pointer"),!0)}(t,n):function x5(t,e){if(-1==e)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&Se.isSelectable(r))&&(ul(t,new Se(n),"pointer"),!0)}(t,n))}(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||In&&this.mightDrag&&!this.mightDrag.node.isAtom||Wn&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(ul(this.view,je.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):Fs(this.view,"pointer")}move(e){this.updateAllowDefault(e),Fs(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function qI(t,e){return!!t.composing||!!(In&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500)&&(t.input.compositionEndedAt=-2e8,!0)}kn.touchstart=t=>{t.input.lastTouch=Date.now(),lw(t),Fs(t,"pointer")},kn.touchmove=t=>{t.input.lastTouch=Date.now(),Fs(t,"pointer")},kn.contextmenu=t=>lw(t);const V5=_i?5e3:-1;function KI(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>fh(t),e))}function JI(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=function B5(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function fh(t,e=!1){if(!(_i&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),JI(t),e||t.docView&&t.docView.dirty){let n=Zv(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}}xn.compositionstart=xn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>!1===r.type.spec.inclusive)))t.markCursor=t.state.storedMarks||n.marks(),fh(t,!0),t.markCursor=null;else if(fh(t),Kr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&1==i.nodeType&&0!=s;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(3==o.nodeType){t.domSelection().collapse(o,o.nodeValue.length);break}i=o,s=-1}}t.input.composing=!0}KI(t,V5)},xn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,KI(t,20))};const dl=Gn&&Ns<15||al&&j4<604;function cw(t,e,n,r){let i=VI(t,e,n,t.input.shiftKey,t.state.selection.$from);if(t.someProp("handlePaste",a=>a(t,r,i||oe.empty)))return!0;if(!i)return!1;let s=function j5(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(i),o=s?t.state.tr.replaceSelectionWith(s,t.input.shiftKey):t.state.tr.replaceSelection(i);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}kn.copy=xn.cut=(t,e)=>{let n=e,r=t.state.selection,i="cut"==n.type;if(r.empty)return;let s=dl?null:n.clipboardData,o=r.content(),{dom:a,text:l}=LI(t,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):function U5(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}(t,a),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},xn.paste=(t,e)=>{let n=e;if(t.composing&&!_i)return;let r=dl?null:n.clipboardData;r&&cw(t,r.getData("text/plain"),r.getData("text/html"),n)?n.preventDefault():function $5(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?cw(t,r.value,null,e):cw(t,r.textContent,r.innerHTML,e)},50)}(t,n)};class H5{constructor(e,n){this.slice=e,this.move=n}}const YI=Dr?"altKey":"ctrlKey";kn.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(dh(n));if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof Se?i.to-1:i.to)))if(r&&r.mightDrag)t.dispatch(t.state.tr.setSelection(Se.create(t.state.doc,r.mightDrag.pos)));else if(n.target&&1==n.target.nodeType){let c=t.docView.nearestDesc(n.target,!0);c&&c.node.type.spec.draggable&&c!=t.docView&&t.dispatch(t.state.tr.setSelection(Se.create(t.state.doc,c.posBefore)))}let o=t.state.selection.content(),{dom:a,text:l}=LI(t,o);n.dataTransfer.clearData(),n.dataTransfer.setData(dl?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",dl||n.dataTransfer.setData("text/plain",l),t.dragging=new H5(o,!n[YI])},kn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)},xn.dragover=xn.dragenter=(t,e)=>e.preventDefault(),xn.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(dh(n));if(!i)return;let s=t.state.doc.resolve(i.pos),o=r&&r.slice;o?t.someProp("transformPasted",m=>{o=m(o,t)}):o=VI(t,n.dataTransfer.getData(dl?"Text":"text/plain"),dl?null:n.dataTransfer.getData("text/html"),!1,s);let a=!(!r||n[YI]);if(t.someProp("handleDrop",m=>m(t,n,o||oe.empty,a)))return void n.preventDefault();if(!o)return;n.preventDefault();let l=o?HA(t.state.doc,s.pos,o):s.pos;null==l&&(l=s.pos);let c=t.state.tr;a&&c.deleteSelection();let u=c.mapping.map(l),d=0==o.openStart&&0==o.openEnd&&1==o.content.childCount,h=c.doc;if(d?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(h))return;let p=c.doc.resolve(u);if(d&&Se.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new Se(p));else{let m=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((v,w,k,z)=>m=z),c.setSelection(Xv(t,p,c.doc.resolve(m)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))},kn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Xi(t)},20))},kn.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)},kn.beforeinput=(t,e)=>{if(Wn&&_i&&"deleteContentBackward"==e.inputType){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,ol(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in xn)kn[t]=xn[t];function lu(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class uw{constructor(e,n){this.toDOM=e,this.spec=n||Po,this.side=this.spec.side||0}map(e,n,r,i){let{pos:s,deleted:o}=e.mapResult(n.from+i,this.side<0?-1:1);return o?null:new qn(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof uw&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&lu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ps{constructor(e,n){this.attrs=e,this.spec=n||Po}map(e,n,r,i){let s=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new qn(s,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Ps&&lu(this.attrs,e.attrs)&&lu(this.spec,e.spec)}static is(e){return e.type instanceof Ps}destroy(){}}class dw{constructor(e,n){this.attrs=e,this.spec=n||Po}map(e,n,r,i){let s=e.mapResult(n.from+i,1);if(s.deleted)return null;let o=e.mapResult(n.to+i,-1);return o.deleted||o.pos<=s.pos?null:new qn(s.pos-r,o.pos-r,this)}valid(e,n){let s,{index:r,offset:i}=e.content.findIndex(n.from);return i==n.from&&!(s=e.child(r)).isText&&i+s.nodeSize==n.to}eq(e){return this==e||e instanceof dw&&lu(this.attrs,e.attrs)&&lu(this.spec,e.spec)}destroy(){}}class qn{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new qn(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new qn(e,e,new uw(n,r))}static inline(e,n,r,i){return new qn(e,n,new Ps(r,i))}static node(e,n,r,i){return new qn(e,n,new dw(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ps}}const fl=[],Po={};class Rt{constructor(e,n){this.local=e.length?e:fl,this.children=n.length?n:fl}static create(e,n){return n.length?hh(n,e,0,Po):vn}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,s){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=n&&a.to>=e&&(!s||s(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,n-a,r,i+a,s)}}map(e,n,r){return this==vn||0==e.maps.length?this:this.mapInner(e,n,0,0,r||Po)}mapInner(e,n,r,i,s){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(n,l)?(o||(o=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?function z5(t,e,n,r,i,s,o){let a=t.slice();for(let c=0,u=s;c<n.maps.length;c++){let d=0;n.maps[c].forEach((h,p,m,v)=>{let w=v-m-(p-h);for(let k=0;k<a.length;k+=3){let z=a[k+1];if(z<0||h>z+u-d)continue;let B=a[k]+u-d;p>=B?a[k+1]=h<=B?-2:-1:m>=i&&w&&(a[k]+=w,a[k+1]+=w)}d+=w}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(-2==a[c+1]){l=!0,a[c+1]=-1;continue}let u=n.map(t[c]+s),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let p=n.map(t[c+1]+s,-1)-i,{index:m,offset:v}=r.content.findIndex(d),w=r.maybeChild(m);if(w&&v==d&&v+w.nodeSize==p){let k=a[c+2].mapInner(n,w,u+1,t[c]+s+1,o);k!=vn?(a[c]=d,a[c+1]=p,a[c+2]=k):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=function G5(t,e,n,r,i,s,o){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?n.push(d):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<t.length;l+=3)-1==t[l+1]&&a(t[l+2],e[l]+s+1);return n}(a,t,e,n,i,s,o),u=hh(c,r,0,o);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let p=u.children[d];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Rt(e.sort(Lo),a)}(this.children,o||[],e,n,r,i,s):o?new Rt(o.sort(Lo),fl):vn}add(e,n){return n.length?this==vn?Rt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,s=0;e.forEach((a,l)=>{let u,c=l+r;if(u=QI(n,a,c)){for(i||(i=this.children.slice());s<i.length&&i[s]<l;)s+=3;i[s]==l?i[s+2]=i[s+2].addInner(a,u,c+1):i.splice(s,0,l,l+a.nodeSize,hh(u,a,c+1,Po)),s+=3}});let o=ZI(s?XI(n):n,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new Rt(o.length?this.local.concat(o).sort(Lo):this.local,i||this.children)}remove(e){return 0==e.length||this==vn?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,a=r[s]+n,l=r[s+1]+n;for(let d,u=0;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(o,a+1);c!=vn?r[s+2]=c:(r.splice(s,3),s-=3)}if(i.length)for(let o,s=0;s<e.length;s++)if(o=e[s])for(let a=0;a<i.length;a++)i[a].eq(o,n)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1));return r==this.children&&i==this.local?this:i.length||r.length?new Rt(i,r):vn}forChild(e,n){if(this==vn)return this;if(n.isLeaf)return Rt.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let s=e+1,o=s+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>s&&l.type instanceof Ps){let c=Math.max(s,l.from)-s,u=Math.min(o,l.to)-s;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new Rt(i.sort(Lo),fl);return r?new Ls([a,r]):a}return r||vn}eq(e){if(this==e)return!0;if(!(e instanceof Rt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return fw(this.localsInner(e))}localsInner(e){if(this==vn)return fl;if(e.inlineContent||!this.local.some(Ps.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Ps||n.push(this.local[r]);return n}}Rt.empty=new Rt([],[]),Rt.removeOverlap=fw;const vn=Rt.empty;class Ls{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,Po));return Ls.from(r)}forChild(e,n){if(n.isLeaf)return Rt.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,n);s!=vn&&(s instanceof Ls?r=r.concat(s.members):r.push(s))}return Ls.from(r)}eq(e){if(!(e instanceof Ls)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(n){r&&(n=n.slice(),r=!1);for(let o=0;o<s.length;o++)n.push(s[o])}else n=s}return n?fw(r?n:n.sort(Lo)):fl}static from(e){switch(e.length){case 0:return vn;case 1:return e[0];default:return new Ls(e.every(n=>n instanceof Rt)?e:e.reduce((n,r)=>n.concat(r instanceof Rt?r:r.members),[]))}}}function ZI(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new qn(i.from+e,i.to+e,i.type))}return n}function QI(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let o,s=0;s<t.length;s++)(o=t[s])&&o.from>n&&o.to<r&&((i||(i=[])).push(o),t[s]=null);return i}function XI(t){let e=[];for(let n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function hh(t,e,n,r){let i=[],s=!1;e.forEach((a,l)=>{let c=QI(t,a,l+n);if(c){s=!0;let u=hh(c,a,n+l+1,r);u!=vn&&i.push(l,l+a.nodeSize,u)}});let o=ZI(s?XI(t):t,-n).sort(Lo);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||i.length?new Rt(o,i):vn}function Lo(t,e){return t.from-e.from||t.to-e.to}function fw(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let s=e[i];if(s.from!=r.from){s.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,s.from),ek(e,i,r.copy(s.from,r.to)));break}s.to!=r.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,r.to),ek(e,i+1,s.copy(r.to,s.to)))}}return e}function ek(t,e,n){for(;e<t.length&&Lo(n,t[e])>0;)e++;t.splice(e,0,n)}function hw(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=vn&&e.push(r)}),t.cursorWrapper&&e.push(Rt.create(t.state.doc,[t.cursorWrapper.deco])),Ls.from(e)}const W5={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},q5=Gn&&Ns<=11;class K5{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class J5{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new K5,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Gn&&Ns<=11&&r.some(i=>"childList"==i.type&&i.removedNodes.length||"characterData"==i.type&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),q5&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,W5)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(kI(this.view)){if(this.suppressingSelectionUpdates)return Xi(this.view);if(Gn&&Ns<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&xo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let r,n=new Set;for(let s=e.focusNode;s;s=ru(s))n.add(s);for(let s=e.anchorNode;s;s=ru(s))if(n.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);return i&&i.ignoreMutation({type:"selection",target:3==r.nodeType?r.parentNode:r})?(this.setCurSelection(),!0):void 0}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.observer?this.observer.takeRecords():[];this.queue.length&&(n=this.queue.concat(n),this.queue.length=0);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&kI(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<n.length;u++){let d=this.registerMutation(n[u],l);d&&(s=s<0?d.from:Math.min(d.from,s),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(a=!0))}if(Kr&&l.length>1){let u=l.filter(d=>"BR"==d.nodeName);if(2==u.length){let d=u[0],h=u[1];d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}}let c=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&e.input.lastTouch<Date.now()-300&&ah(r)&&(c=Zv(e))&&c.eq(je.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Xi(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),function Y5(t){if(!tk.has(t)&&(tk.set(t,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace))){if(t.requiresGeckoHackNode=Kr,nk)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),nk=!0}}(e)),this.handleDOMChange(s,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Xi(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(r==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if("childList"==e.type){for(let u=0;u<e.addedNodes.length;u++)n.push(e.addedNodes[u]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(Gn&&Ns<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(s=h)}let o=i&&i.parentNode==e.target?ar(i)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=s&&s.parentNode==e.target?ar(s):e.target.childNodes.length;return{from:a,to:r.localPosFromDOM(e.target,l,1)}}return"attributes"==e.type?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let tk=new WeakMap,nk=!1;function X5(t){let e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(In&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(t.parentNode.lastChild==t||In&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}function rk(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Xv(t,e.resolve(n.anchor),e.resolve(n.head))}function pw(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let s=t.node(r).maybeChild(t.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}class iG{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new E5,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(lk),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=ok(this),sk(this),this.nodeViews=ak(this),this.docView=vI(this.state.doc,ik(this),hw(this),this.dom,this),this.domObserver=new J5(this,(r,i,s,o)=>function eG(t,e,n,r,i){if(e<0){let Oe=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,cs=Zv(t,Oe);if(cs&&!t.state.selection.eq(cs)){let Xo=t.state.tr.setSelection(cs);"pointer"==Oe?Xo.setMeta("pointer",!0):"key"==Oe&&Xo.scrollIntoView(),t.dispatch(Xo)}return}let s=t.state.doc.resolve(e),o=s.sharedDepth(n);e=s.before(o+1),n=t.state.doc.resolve(n).after(o+1);let d,h,a=t.state.selection,l=function Q5(t,e,n){let c,{node:r,fromOffset:i,toOffset:s,from:o,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),u=l.anchorNode;if(u&&t.dom.contains(1==u.nodeType?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],ah(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Wn&&8===t.input.lastKeyCode)for(let w=s;w>i;w--){let k=r.childNodes[w-1],z=k.pmViewDesc;if("BR"==k.nodeName&&!z){s=w;break}if(!z||z.size)break}let d=t.state.doc,h=t.someProp("domParser")||Za.fromSchema(t.state.schema),p=d.resolve(o),m=null,v=h.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:s,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:c,ruleFromNode:X5,context:p});if(c&&null!=c[0].pos){let w=c[0].pos,k=c[1]&&c[1].pos;null==k&&(k=w),m={anchor:w+o,head:k+o}}return{doc:v,sel:m,from:o,to:a}}(t,e,n),c=t.state.doc,u=c.slice(l.from,l.to);8===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime?(d=t.state.selection.to,h="end"):(d=t.state.selection.from,h="start"),t.input.lastKeyCode=null;let p=function rG(t,e,n,r,i){let s=t.findDiffStart(e,n);if(null==s)return null;let{a:o,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);return"end"==i&&(r-=o+Math.max(0,s-Math.min(o,a))-s),o<s&&t.size<e.size?(s-=r<=s&&r>=o?s-r:0,a=s+(a-o),o=s):a<s&&(s-=r<=s&&r>=a?s-r:0,o=s+(o-a),a=s),{start:s,endA:o,endB:a}}(u.content,l.doc.content,l.from,d,h);if((al&&t.input.lastIOSEnter>Date.now()-225||_i)&&i.some(Oe=>"DIV"==Oe.nodeName||"P"==Oe.nodeName||"LI"==Oe.nodeName)&&(!p||p.endA>=p.endB)&&t.someProp("handleKeyDown",Oe=>Oe(t,ol(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(!p){if(!(r&&a instanceof Ve&&!a.empty&&a.$head.sameParent(a.$anchor))||t.composing||l.sel&&l.sel.anchor!=l.sel.head){if(l.sel){let Oe=rk(t,t.state.doc,l.sel);Oe&&!Oe.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(Oe))}return}p={start:a.from,endA:a.to,endB:a.to}}if(Wn&&t.cursorWrapper&&l.sel&&l.sel.anchor==t.cursorWrapper.deco.from&&l.sel.head==l.sel.anchor){let Oe=p.endB-p.start;l.sel={anchor:l.sel.anchor+Oe,head:l.sel.anchor+Oe}}t.input.domChangeCount++,t.state.selection.from<t.state.selection.to&&p.start==p.endB&&t.state.selection instanceof Ve&&(p.start>t.state.selection.from&&p.start<=t.state.selection.from+2&&t.state.selection.from>=l.from?p.start=t.state.selection.from:p.endA<t.state.selection.to&&p.endA>=t.state.selection.to-2&&t.state.selection.to<=l.to&&(p.endB+=t.state.selection.to-p.endA,p.endA=t.state.selection.to)),Gn&&Ns<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>l.from&&" \xa0"==l.doc.textBetween(p.start-l.from-1,p.start-l.from+1)&&(p.start--,p.endA--,p.endB--);let z,m=l.doc.resolveNoCache(p.start-l.from),v=l.doc.resolveNoCache(p.endB-l.from),w=c.resolve(p.start),k=m.sameParent(v)&&m.parent.inlineContent&&w.end()>=p.endA;if((al&&t.input.lastIOSEnter>Date.now()-225&&(!k||i.some(Oe=>"DIV"==Oe.nodeName||"P"==Oe.nodeName))||!k&&m.pos<l.doc.content.size&&(z=je.findFrom(l.doc.resolve(m.pos+1),1,!0))&&z.head==v.pos)&&t.someProp("handleKeyDown",Oe=>Oe(t,ol(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(t.state.selection.anchor>p.start&&function nG(t,e,n,r,i){if(!r.parent.isTextblock||n-e<=i.pos-r.pos||pw(r,!0,!1)<i.pos)return!1;let s=t.resolve(e);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=t.resolve(pw(s,!0,!0));return!(!o.parent.isTextblock||o.pos>n||pw(o,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(o.parent.content)}(c,p.start,p.endA,m,v)&&t.someProp("handleKeyDown",Oe=>Oe(t,ol(8,"Backspace"))))return void(_i&&Wn&&t.domObserver.suppressSelectionUpdates());Wn&&_i&&p.endB==p.start&&(t.input.lastAndroidDelete=Date.now()),_i&&!k&&m.start()!=v.start()&&0==v.parentOffset&&m.depth==v.depth&&l.sel&&l.sel.anchor==l.sel.head&&l.sel.head==p.endA&&(p.endB-=2,v=l.doc.resolveNoCache(p.endB-l.from),setTimeout(()=>{t.someProp("handleKeyDown",function(Oe){return Oe(t,ol(13,"Enter"))})},20));let _e,Je,wn,B=p.start,ce=p.endA;if(k)if(m.pos==v.pos)Gn&&Ns<=11&&0==m.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Xi(t),20)),_e=t.state.tr.delete(B,ce),Je=c.resolve(p.start).marksAcross(c.resolve(p.endA));else if(p.endA==p.endB&&(wn=function tG(t,e){let o,a,l,n=t.firstChild.marks,r=e.firstChild.marks,i=n,s=r;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<n.length;u++)s=n[u].removeFromSet(s);if(1==i.length&&0==s.length)a=i[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else{if(0!=i.length||1!=s.length)return null;a=s[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks))}let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(ee.from(c).eq(t))return{mark:a,type:o}}(m.parent.content.cut(m.parentOffset,v.parentOffset),w.parent.content.cut(w.parentOffset,p.endA-w.start()))))_e=t.state.tr,"add"==wn.type?_e.addMark(B,ce,wn.mark):_e.removeMark(B,ce,wn.mark);else if(m.parent.child(m.index()).isText&&m.index()==v.index()-(v.textOffset?0:1)){let Oe=m.parent.textBetween(m.parentOffset,v.parentOffset);if(t.someProp("handleTextInput",cs=>cs(t,B,ce,Oe)))return;_e=t.state.tr.insertText(Oe,B,ce)}if(_e||(_e=t.state.tr.replace(B,ce,l.doc.slice(p.start-l.from,p.endB-l.from))),l.sel){let Oe=rk(t,_e.doc,l.sel);Oe&&!(Wn&&_i&&t.composing&&Oe.empty&&(p.start!=p.endB||t.input.lastAndroidDelete<Date.now()-100)&&(Oe.head==B||Oe.head==_e.mapping.map(ce)-1)||Gn&&Oe.empty&&Oe.head==B)&&_e.setSelection(Oe)}Je&&_e.ensureMarks(Je),t.dispatch(_e.scrollIntoView())}(this,r,i,s,o)),this.domObserver.start(),function M5(t){for(let e in kn){let n=kn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{A5(t,r)&&!ow(t,r)&&(t.editable||!(r.type in xn))&&n(t,r)},S5[e]?{passive:!0}:void 0)}In&&t.dom.addEventListener("input",()=>null),sw(t)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&sw(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(lk),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){let r=this.state,i=!1,s=!1;e.storedMarks&&this.composing&&(JI(this),s=!0),this.state=e;let o=r.plugins!=e.plugins||this._props.plugins!=n.plugins;if(o||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let h=ak(this);(function oG(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r})(h,this.nodeViews)&&(this.nodeViews=h,i=!0)}(o||n.handleDOMEvents!=this._props.handleDOMEvents)&&sw(this),this.editable=ok(this),sk(this);let a=hw(this),l=ik(this),c=r.plugins==e.plugins||r.doc.eq(e.doc)?e.scrollToSelection>r.scrollToSelection?"to selection":"preserve":"reset",u=i||!this.docView.matchesNode(e.doc,l,a);(u||!e.selection.eq(r.selection))&&(s=!0);let d="preserve"==c&&s&&null==this.dom.style.overflowAnchor&&function z4(t){let r,i,e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top);for(let s=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=t.root.elementFromPoint(s,o);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:aI(t.dom)}}(this);if(s){this.domObserver.stop();let h=u&&(Gn||Wn)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&function sG(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}(r.selection,e.selection);if(u){let p=Wn?this.trackWrites=this.domSelectionRange().focusNode:null;(i||!this.docView.update(e.doc,l,a,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=vI(e.doc,l,a,this.dom,this)),p&&!this.trackWrites&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function g5(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return xo(e.node,e.offset,n.anchorNode,n.anchorOffset)}(this))?Xi(this,h):(AI(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():d&&function G4({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;lI(n,0==r?0:r-e)}(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof Se){let n=this.docView.domAfterPos(this.state.selection.from);1==n.nodeType&&oI(this,n.getBoundingClientRect(),e)}else oI(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}}someProp(e,n){let i,r=this._props&&this._props[e];if(null!=r&&(i=n?n(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(null!=a&&(i=n?n(a):a))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let a=s[o].props[e];if(null!=a&&(i=n?n(a):a))return i}}hasFocus(){if(Gn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function W4(t){if(t.setActive)return t.setActive();if(ll)return t.focus(ll);let e=aI(t);t.focus(null==ll?{get preventScroll(){return ll={preventScroll:!0},!0}}:void 0),ll||(ll=!1,lI(e,0))}(this.dom),Xi(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let n=this.dom.parentNode;n;n=n.parentNode)if(9==n.nodeType||11==n.nodeType&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n;return e||document}posAtCoords(e){return Z4(this,e)}coordsAtPos(e,n=1){return dI(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return function n5(t,e,n){return hI==e&&pI==n?gI:(hI=e,pI=n,gI="up"==n||"down"==n?function X4(t,e,n){let r=e.selection,i="up"==n?r.$from:r.$to;return fI(t,e,()=>{let{node:s}=t.docView.domFromPos(i.pos,"up"==n?-1:1);for(;;){let a=t.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.dom;break}s=a.dom.parentNode}let o=dI(t,i.pos,1);for(let a=s.firstChild;a;a=a.nextSibling){let l;if(1==a.nodeType)l=a.getClientRects();else{if(3!=a.nodeType)continue;l=Qi(a,0,a.nodeValue.length).getClientRects()}for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&("up"==n?o.top-u.top>2*(u.bottom-o.top):u.bottom-o.bottom>2*(o.bottom-u.top)))return!1}}return!0})}(t,e,n):function t5(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,a=t.domSelection();return e5.test(r.parent.textContent)&&a.modify?fI(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=t.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",n,"character");let p=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:m,focusOffset:v}=t.domSelectionRange(),w=m&&!p.contains(1==m.nodeType?m:m.parentNode)||l==m&&c==v;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return null!=h&&(a.caretBidiLevel=h),w}):"left"==n||"backward"==n?s:o}(t,e,n))}(this,n||this.state,e)}destroy(){!this.docView||(function T5(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],hw(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function I5(t,e){!ow(t,e)&&kn[e.type]&&(t.editable||!(e.type in xn))&&kn[e.type](t,e)}(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return In&&11===this.root.nodeType&&function B4(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}(this.dom.ownerDocument)==this.dom?function Z5(t){let e;function n(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0);let r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,a=t.domAtPos(t.state.selection.anchor);return xo(a.node,a.offset,s,o)&&([r,i,s,o]=[s,o,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}}(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function ik(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),e.translate="no",t.someProp("attributes",n=>{if("function"==typeof n&&(n=n(t.state)),n)for(let r in n)"class"==r&&(e.class+=" "+n[r]),"style"==r?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&"contenteditable"!=r&&"nodeName"!=r&&(e[r]=String(n[r]))}),[qn.node(0,t.state.doc.content.size,e)]}function sk(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:qn.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function ok(t){return!t.someProp("editable",e=>!1===e(t.state))}function ak(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function lk(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}for(var Vs={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ph={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},ck=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),aG=(typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent),typeof navigator<"u"&&/Mac/.test(navigator.platform)),lG=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),cG=aG||ck&&+ck[1]<57,rn=0;rn<10;rn++)Vs[48+rn]=Vs[96+rn]=String(rn);for(rn=1;rn<=24;rn++)Vs[rn+111]="F"+rn;for(rn=65;rn<=90;rn++)Vs[rn]=String.fromCharCode(rn+32),ph[rn]=String.fromCharCode(rn);for(var gw in Vs)ph.hasOwnProperty(gw)||(ph[gw]=Vs[gw]);const dG=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function fG(t){let r,i,s,o,e=t.split(/-(?!$)/),n=e[e.length-1];"Space"==n&&(n=" ");for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);dG?o=!0:i=!0}}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),o&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function mw(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==n&&e.shiftKey&&(t="Shift-"+t),t}function uk(t){let e=function hG(t){let e=Object.create(null);for(let n in t)e[fG(n)]=t[n];return e}(t);return function(n,r){let o,i=function uG(t){var n=!(cG&&(t.ctrlKey||t.altKey||t.metaKey)||lG&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?ph:Vs)[t.keyCode]||t.key||"Unidentified";return"Esc"==n&&(n="Escape"),"Del"==n&&(n="Delete"),"Left"==n&&(n="ArrowLeft"),"Up"==n&&(n="ArrowUp"),"Right"==n&&(n="ArrowRight"),"Down"==n&&(n="ArrowDown"),n}(r),s=1==i.length&&" "!=i,a=e[mw(i,r,!s)];if(a&&a(n.state,n.dispatch,n))return!0;if(s&&(r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=Vs[r.keyCode])&&o!=i){let l=e[mw(o,r,!0)];if(l&&l(n.state,n.dispatch,n))return!0}else if(s&&r.shiftKey){let l=e[mw(i,r,!0)];if(l&&l(n.state,n.dispatch,n))return!0}return!1}}const yw=(t,e)=>!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0),dk=(t,e,n)=>{let{$cursor:r}=t.selection;if(!r||(n?!n.endOfTextblock("backward",t):r.parentOffset>0))return!1;let i=hk(r);if(!i){let o=r.blockRange(),a=o&&el(o);return null!=a&&(e&&e(t.tr.lift(o,a).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&Ck(t,i,e))return!0;if(0==r.parent.content.size&&(hl(s,"end")||Se.isSelectable(s))){let o=Pv(t.doc,r.before(),r.after(),oe.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=t.tr.step(o);a.setSelection(hl(s,"end")?je.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):Se.create(a.doc,i.pos-s.nodeSize)),e(a.scrollIntoView())}return!0}}return!(!s.isAtom||i.depth!=r.depth-1||(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),0))};function hl(t,e,n=!1){for(let r=t;r;r="start"==e?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}const fk=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;s=hk(r)}let o=s&&s.nodeBefore;return!(!o||!Se.isSelectable(o)||(e&&e(t.tr.setSelection(Se.create(t.doc,s.pos-o.nodeSize)).scrollIntoView()),0))};function hk(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}const pk=(t,e,n)=>{let{$cursor:r}=t.selection;if(!r||(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size))return!1;let i=mk(r);if(!i)return!1;let s=i.nodeAfter;if(Ck(t,i,e))return!0;if(0==r.parent.content.size&&(hl(s,"start")||Se.isSelectable(s))){let o=Pv(t.doc,r.before(),r.after(),oe.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=t.tr.step(o);a.setSelection(hl(s,"start")?je.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):Se.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return!(!s.isAtom||i.depth!=r.depth-1||(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),0))},gk=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;s=mk(r)}let o=s&&s.nodeAfter;return!(!o||!Se.isSelectable(o)||(e&&e(t.tr.setSelection(Se.create(t.doc,s.pos)).scrollIntoView()),0))};function mk(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const yk=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!(!n.parent.type.spec.code||!n.sameParent(r)||(e&&e(t.tr.insertText("\n").scrollIntoView()),0))};function vw(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const vk=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),s=n.indexAfter(-1),o=vw(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,o.createAndFill());l.setSelection(je.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},wk=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof or||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=vw(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=t.tr.insert(o,s.createAndFill());a.setSelection(Ve.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},bk=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(Zi(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let r=n.blockRange(),i=r&&el(r);return null!=i&&(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function Ck(t,e,n){let s,o,r=e.nodeBefore,i=e.nodeAfter;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(function vG(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!(!(r&&i&&r.type.compatibleContent(i.type))||(!r.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),0):!e.parent.canReplace(s,s+1)||!i.isTextblock&&!tl(t.doc,e.pos)||(n&&n(t.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),0)))}(t,e,n))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(s=(o=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(n){let d=e.pos+i.nodeSize,h=ee.empty;for(let v=s.length-1;v>=0;v--)h=ee.from(s[v].create(null,h));h=ee.from(r.copy(h));let p=t.tr.step(new Jt(e.pos-1,d,e.pos,d,new oe(h,1,0),s.length,!0)),m=d+2*s.length;tl(p.doc,m)&&p.join(m),n(p.scrollIntoView())}return!0}let l=je.findFrom(e,1),c=l&&l.$from.blockRange(l.$to),u=c&&el(c);if(null!=u&&u>=e.depth)return n&&n(t.tr.lift(c,u).scrollIntoView()),!0;if(a&&hl(i,"start",!0)&&hl(r,"end")){let d=r,h=[];for(;h.push(d),!d.isTextblock;)d=d.lastChild;let p=i,m=1;for(;!p.isTextblock;p=p.firstChild)m++;if(d.canReplace(d.childCount,d.childCount,p.content)){if(n){let v=ee.empty;for(let k=h.length-1;k>=0;k--)v=ee.from(h[k].copy(v));n(t.tr.step(new Jt(e.pos-h.length,e.pos+i.nodeSize,e.pos+m,e.pos+i.nodeSize-m,new oe(v,h.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Dk(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return!!i.node(s).isTextblock&&(n&&n(e.tr.setSelection(Ve.create(e.doc,t<0?i.start(s):i.end(s)))),!0)}}const Sk=Dk(-1),Ek=Dk(1);function Mk(t,e=null){return function(n,r){let{from:i,to:s}=n.selection,o=!1;return n.doc.nodesBetween(i,s,(a,l)=>{if(o)return!1;if(a.isTextblock&&!a.hasMarkup(t,e))if(a.type==t)o=!0;else{let c=n.doc.resolve(l),u=c.index();o=c.parent.canReplaceWith(u,u+1,t)}}),!!o&&(r&&r(n.tr.setBlockType(i,s,t,e).scrollIntoView()),!0)}}function ww(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}let bw=ww(yw,dk,fk),Tk=ww(yw,pk,gk);const Bs={Enter:ww(yk,wk,bk,(t,e)=>{let{$from:n,$to:r}=t.selection;if(t.selection instanceof Se&&t.selection.node.isBlock)return!(!n.parentOffset||!Zi(t.doc,n.pos)||(e&&e(t.tr.split(n.pos).scrollIntoView()),0));if(!n.parent.isBlock)return!1;if(e){let i=r.parentOffset==r.parent.content.size,s=t.tr;(t.selection instanceof Ve||t.selection instanceof or)&&s.deleteSelection();let o=0==n.depth?null:vw(n.node(-1).contentMatchAt(n.indexAfter(-1))),a=i&&o?[{type:o}]:void 0,l=Zi(s.doc,s.mapping.map(n.pos),1,a);if(!a&&!l&&Zi(s.doc,s.mapping.map(n.pos),1,o?[{type:o}]:void 0)&&(o&&(a=[{type:o}]),l=!0),l&&(s.split(s.mapping.map(n.pos),1,a),!i&&!n.parentOffset&&n.parent.type!=o)){let c=s.mapping.map(n.before()),u=s.doc.resolve(c);o&&n.node(-1).canReplaceWith(u.index(),u.index()+1,o)&&s.setNodeMarkup(s.mapping.map(n.before()),o)}e(s.scrollIntoView())}return!0}),"Mod-Enter":vk,Backspace:bw,"Mod-Backspace":bw,"Shift-Backspace":bw,Delete:Tk,"Mod-Delete":Tk,"Mod-a":(t,e)=>(e&&e(t.tr.setSelection(new or(t.doc))),!0)},CG={"Ctrl-h":Bs.Backspace,"Alt-Backspace":Bs["Mod-Backspace"],"Ctrl-d":Bs.Delete,"Ctrl-Alt-Backspace":Bs["Mod-Delete"],"Alt-Delete":Bs["Mod-Delete"],"Alt-d":Bs["Mod-Delete"],"Ctrl-a":Sk,"Ctrl-e":Ek};for(let t in Bs)CG[t]=Bs[t];function gh(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,s=n.storedMarks,n}}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform();class mh{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:s}=r,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,a=[],l=!!e,c=e||s.tr,d={...Object.fromEntries(Object.entries(r).map(([h,p])=>[h,(...v)=>{const w=this.buildProps(c,n),k=p(...v)(w);return a.push(k),d}])),run:()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(h=>!0===h))};return d}createCan(e){const{rawCommands:n,state:r}=this,s=e||r.tr,o=this.buildProps(s,!1);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,!1)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i;s.storedMarks&&e.setStoredMarks(s.storedMarks);const a={tr:e,editor:i,view:o,state:gh({state:s,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class FG{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function ue(t,e,n){return void 0===t.config[e]&&t.parent?ue(t.parent,e,n):"function"==typeof t.config[e]?t.config[e].bind({...n,parent:t.parent?ue(t.parent,e,n):null}):t.config[e]}function yh(t){return{baseExtensions:t.filter(i=>"extension"===i.type),nodeExtensions:t.filter(i=>"node"===i.type),markExtensions:t.filter(i=>"mark"===i.type)}}function Ak(t){const e=[],{nodeExtensions:n,markExtensions:r}=yh(t),i=[...n,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const l=ue(o,"addGlobalAttributes",{name:o.name,options:o.options,storage:o.storage});l&&l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([h,p])=>{e.push({type:d,name:h,attribute:{...s,...p}})})})})}),i.forEach(o=>{const l=ue(o,"addAttributes",{name:o.name,options:o.options,storage:o.storage});if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const h={...s,...d};d?.isRequired&&void 0===d?.default&&delete h.default,e.push({type:o.name,name:u,attribute:h})})}),e}function Yt(t,e){if("string"==typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function Nn(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,s])=>{r[i]=r[i]?"class"===i?[r[i],s].join(" "):"style"===i?[r[i],s].join("; "):s:s}),r},{})}function Cw(t,e){return e.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Nn(n,r),{})}function Ik(t){return"function"==typeof t}function Be(t,e,...n){return Ik(t)?e?t.bind(e)(...n):t(...n):t}function kk(t,e){return t.style?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===r)return!1;const i=e.reduce((s,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(n):function LG(t){return"string"!=typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}(n.getAttribute(o.name));return null==a?s:{...s,[o.name]:a}},{});return{...r,...i}}}}function xk(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>("attrs"!==e||!function PG(t={}){return 0===Object.keys(t).length&&t.constructor===Object}(n))&&null!=n))}function Dw(t,e){return e.nodes[t]||e.marks[t]||null}function Ok(t,e){return Array.isArray(e)?e.some(n=>("string"==typeof n?n:n.name)===t.name):e}function Sw(t){return"[object RegExp]"===Object.prototype.toString.call(t)}class cu{constructor(e){this.find=e.find,this.handler=e.handler}}function Ew(t){var e;const{editor:n,from:r,to:i,text:s,rules:o,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||null!==(e=c.nodeBefore||c.nodeAfter)&&void 0!==e&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const d=((t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,s,o,a)=>{var l,c;const u=(null===(c=(l=i.type.spec).toText)||void 0===c?void 0:c.call(l,{node:i,pos:s,parent:o,index:a}))||i.textContent||"%leaf%";n+=u.slice(0,Math.max(0,r-s))}),n})(c)+s;return o.forEach(h=>{if(u)return;const p=((t,e)=>{if(Sw(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[];return r.push(n.text),r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r})(d,h.find);if(!p)return;const m=l.state.tr,v=gh({state:l.state,transaction:m}),w={from:r-(p[0].length-s.length),to:i},{commands:k,chain:z,can:B}=new mh({editor:n,state:v});null===h.handler({state:v,range:w,match:p,commands:k,chain:z,can:B})||!m.steps.length||(m.setMeta(a,{transform:m,from:r,to:i,text:s}),l.dispatch(m),u=!0)}),u}function UG(t){const{editor:e,rules:n}=t,r=new An({state:{init:()=>null,apply:(i,s)=>i.getMeta(r)||(i.selectionSet||i.docChanged?null:s)},props:{handleTextInput:(i,s,o,a)=>Ew({editor:e,from:s,to:o,text:a,rules:n,plugin:r}),handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&Ew({editor:e,from:s.pos,to:s.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,s){if("Enter"!==s.key)return!1;const{$cursor:o}=i.state.selection;return!!o&&Ew({editor:e,from:o.pos,to:o.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}class Mw{constructor(e){this.find=e.find,this.handler=e.handler}}function zG(t){const{editor:e,rules:n}=t;let r=null,i=!1,s=!1;return n.map(a=>new An({view(l){const c=u=>{var d;r=null!==(d=l.dom.parentElement)&&void 0!==d&&d.contains(u.target)?l.dom.parentElement:null};return window.addEventListener("dragstart",c),{destroy(){window.removeEventListener("dragstart",c)}}},props:{handleDOMEvents:{drop:l=>(s=r===l.dom.parentElement,!1),paste:(l,c)=>{var u;const d=null===(u=c.clipboardData)||void 0===u?void 0:u.getData("text/html");return i=!!d?.includes("data-pm-slice"),!1}}},appendTransaction:(l,c,u)=>{const d=l[0],h="paste"===d.getMeta("uiEvent")&&!i,p="drop"===d.getMeta("uiEvent")&&!s;if(!h&&!p)return;const m=c.doc.content.findDiffStart(u.doc.content),v=c.doc.content.findDiffEnd(u.doc.content);if(!function jG(t){return"number"==typeof t}(m)||!v||m===v.b)return;const w=u.tr,k=gh({state:u,transaction:w});return function HG(t){const{editor:e,state:n,from:r,to:i,rule:s}=t,{commands:o,chain:a,can:l}=new mh({editor:e,state:n}),c=[];return n.doc.nodesBetween(r,i,(d,h)=>{if(!d.isTextblock||d.type.spec.code)return;const p=Math.max(r,h),m=Math.min(i,h+d.content.size);((t,e)=>{if(Sw(e))return[...t.matchAll(e)];const n=e(t);return n?n.map(r=>{const i=[];return i.push(r.text),i.index=r.index,i.input=t,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]})(d.textBetween(p-h,m-h,void 0,"\ufffc"),s.find).forEach(k=>{if(void 0===k.index)return;const z=p+k.index+1,B=z+k[0].length,ce={from:n.tr.mapping.map(z),to:n.tr.mapping.map(B)},_e=s.handler({state:n,range:ce,match:k,commands:o,chain:a,can:l});c.push(_e)})}),c.every(d=>null!==d)}({editor:e,state:k,from:Math.max(m-1,0),to:v.b-1,rule:a})&&w.steps.length?w:void 0}}))}class Vo{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=Vo.resolve(e),this.schema=function Nk(t){var e;const n=Ak(t),{nodeExtensions:r,markExtensions:i}=yh(t),s=null===(e=r.find(l=>ue(l,"topNode")))||void 0===e?void 0:e.name,o=Object.fromEntries(r.map(l=>{const c=n.filter(w=>w.type===l.name),u={name:l.name,options:l.options,storage:l.storage},h=xk({...t.reduce((w,k)=>{const z=ue(k,"extendNodeSchema",u);return{...w,...z?z(l):{}}},{}),content:Be(ue(l,"content",u)),marks:Be(ue(l,"marks",u)),group:Be(ue(l,"group",u)),inline:Be(ue(l,"inline",u)),atom:Be(ue(l,"atom",u)),selectable:Be(ue(l,"selectable",u)),draggable:Be(ue(l,"draggable",u)),code:Be(ue(l,"code",u)),defining:Be(ue(l,"defining",u)),isolating:Be(ue(l,"isolating",u)),attrs:Object.fromEntries(c.map(w=>{var k;return[w.name,{default:null===(k=w?.attribute)||void 0===k?void 0:k.default}]}))}),p=Be(ue(l,"parseHTML",u));p&&(h.parseDOM=p.map(w=>kk(w,c)));const m=ue(l,"renderHTML",u);m&&(h.toDOM=w=>m({node:w,HTMLAttributes:Cw(w,c)}));const v=ue(l,"renderText",u);return v&&(h.toText=v),[l.name,h]})),a=Object.fromEntries(i.map(l=>{const c=n.filter(v=>v.type===l.name),u={name:l.name,options:l.options,storage:l.storage},h=xk({...t.reduce((v,w)=>{const k=ue(w,"extendMarkSchema",u);return{...v,...k?k(l):{}}},{}),inclusive:Be(ue(l,"inclusive",u)),excludes:Be(ue(l,"excludes",u)),group:Be(ue(l,"group",u)),spanning:Be(ue(l,"spanning",u)),code:Be(ue(l,"code",u)),attrs:Object.fromEntries(c.map(v=>{var w;return[v.name,{default:null===(w=v?.attribute)||void 0===w?void 0:w.default}]}))}),p=Be(ue(l,"parseHTML",u));p&&(h.parseDOM=p.map(v=>kk(v,c)));const m=ue(l,"renderHTML",u);return m&&(h.toDOM=v=>m({mark:v,HTMLAttributes:Cw(v,c)})),[l.name,h]}));return new n4({topNode:s,nodes:o,marks:a})}(this.extensions),this.extensions.forEach(r=>{var i;this.editor.extensionStorage[r.name]=r.storage;const s={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:Dw(r.name,this.schema)};"mark"===r.type&&(null===(i=Be(ue(r,"keepOnSplit",s)))||void 0===i||i)&&this.splittableMarks.push(r.name);const o=ue(r,"onBeforeCreate",s);o&&this.editor.on("beforeCreate",o);const a=ue(r,"onCreate",s);a&&this.editor.on("create",a);const l=ue(r,"onUpdate",s);l&&this.editor.on("update",l);const c=ue(r,"onSelectionUpdate",s);c&&this.editor.on("selectionUpdate",c);const u=ue(r,"onTransaction",s);u&&this.editor.on("transaction",u);const d=ue(r,"onFocus",s);d&&this.editor.on("focus",d);const h=ue(r,"onBlur",s);h&&this.editor.on("blur",h);const p=ue(r,"onDestroy",s);p&&this.editor.on("destroy",p)})}static resolve(e){const n=Vo.sort(Vo.flatten(e)),r=function GG(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return[...new Set(e)]}(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const i=ue(n,"addExtensions",{name:n.name,options:n.options,storage:n.storage});return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const s=ue(r,"priority")||100,o=ue(i,"priority")||100;return s>o?-1:s<o?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const i=ue(n,"addCommands",{name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:Dw(n.name,this.schema)});return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=Vo.sort([...this.extensions].reverse()),r=[],i=[],s=n.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:Dw(o.name,this.schema)},l=[],c=ue(o,"addKeyboardShortcuts",a);let u={};if("mark"===o.type&&o.config.exitable&&(u.ArrowRight=()=>js.handleExit({editor:e,mark:o})),c){const v=Object.fromEntries(Object.entries(c()).map(([w,k])=>[w,()=>k({editor:e})]));u={...u,...v}}const d=function pG(t){return new An({props:{handleKeyDown:uk(t)}})}(u);l.push(d);const h=ue(o,"addInputRules",a);Ok(o,e.options.enableInputRules)&&h&&r.push(...h());const p=ue(o,"addPasteRules",a);Ok(o,e.options.enablePasteRules)&&p&&i.push(...p());const m=ue(o,"addProseMirrorPlugins",a);if(m){const v=m();l.push(...v)}return l}).flat();return[UG({editor:e,rules:r}),...zG({editor:e,rules:i}),...s]}get attributes(){return Ak(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=yh(this.extensions);return Object.fromEntries(n.filter(r=>!!ue(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),s={name:r.name,options:r.options,storage:r.storage,editor:e,type:Yt(r.name,this.schema)},o=ue(r,"addNodeView",s);return o?[r.name,(l,c,u,d)=>{const h=Cw(l,i);return o()({editor:e,node:l,getPos:u,decorations:d,HTMLAttributes:h,extension:r})}]:[]}))}}function Tw(t){return"Object"===function WG(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function vh(t,e){const n={...t};return Tw(t)&&Tw(e)&&Object.keys(e).forEach(r=>{Tw(e[r])?r in t?n[r]=vh(t[r],e[r]):Object.assign(n,{[r]:e[r]}):Object.assign(n,{[r]:e[r]})}),n}class On{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Be(ue(this,"addOptions",{name:this.name}))),this.storage=Be(ue(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new On(e)}configure(e={}){const n=this.extend();return n.options=vh(this.options,e),n.storage=Be(ue(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new On(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Be(ue(n,"addOptions",{name:n.name})),n.storage=Be(ue(n,"addStorage",{name:n.name,options:n.options})),n}}function Rk(t,e,n){const{from:r,to:i}=e,{blockSeparator:s="\n\n",textSerializers:o={}}=n||{};let a="",l=!0;return t.nodesBetween(r,i,(c,u,d,h)=>{var p;const m=o?.[c.type.name];m?(c.isBlock&&!l&&(a+=s,l=!0),d&&(a+=m({node:c,pos:u,parent:d,index:h,range:e}))):c.isText?(a+=null===(p=c?.text)||void 0===p?void 0:p.slice(Math.max(r,u)-u,i-u),l=!1):c.isBlock&&!l&&(a+=s,l=!0)}),a}function Aw(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const qG=On.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new An({key:new qr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:s}=i;return Rk(r,{from:Math.min(...s.map(u=>u.$from.pos)),to:Math.max(...s.map(u=>u.$to.pos))},{textSerializers:Aw(n)})}}})]}});function wh(t,e,n={strict:!0}){const r=Object.keys(e);return!r.length||r.every(i=>n.strict?e[i]===t[i]:Sw(e[i])?e[i].test(t[i]):e[i]===t[i])}function Iw(t,e,n={}){return t.find(r=>r.type===e&&wh(r.attrs,n))}function iW(t,e,n={}){return!!Iw(t,e,n)}function kw(t,e,n={}){if(!t||!e)return;let r=t.parent.childAfter(t.parentOffset);if(t.parentOffset===r.offset&&0!==r.offset&&(r=t.parent.childBefore(t.parentOffset)),!r.node)return;const i=Iw([...r.node.marks],e,n);if(!i)return;let s=r.index,o=t.start()+r.offset,a=s+1,l=o+r.node.nodeSize;for(Iw([...r.node.marks],e,n);s>0&&i.isInSet(t.parent.child(s-1).marks);)s-=1,o-=t.parent.child(s).nodeSize;for(;a<t.parent.childCount&&iW([...t.parent.child(a).marks],e,n);)l+=t.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function Us(t,e){if("string"==typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}function Fk(t){return t instanceof Ve}function es(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Pk(t,e=null){if(!e)return null;const n=je.atStart(t),r=je.atEnd(t);if("start"===e||!0===e)return n;if("end"===e)return r;const i=n.from,s=r.to;return"all"===e?Ve.create(t,es(0,i,s),es(t.content.size,i,s)):Ve.create(t,es(e,i,s),es(e,i,s))}function bh(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function xw(t){const e=`<body>${t}</body>`;return(new window.DOMParser).parseFromString(e,"text/html").body}function _h(t,e,n){if(n={slice:!0,parseOptions:{},...n},"object"==typeof t&&null!==t)try{return Array.isArray(t)?ee.fromArray(t.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(t)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",r),_h("",e,n)}if("string"==typeof t){const r=Za.fromSchema(e);return n.slice?r.parseSlice(xw(t),n.parseOptions).content:r.parse(xw(t),n.parseOptions)}return _h("",e,n)}function Lk(){return typeof navigator<"u"&&/Mac/.test(navigator.platform)}function uu(t,e,n={}){const{from:r,to:i,empty:s}=t.selection,o=e?Yt(e,t.schema):null,a=[];t.doc.nodesBetween(r,i,(d,h)=>{if(d.isText)return;const p=Math.max(r,h),m=Math.min(i,h+d.nodeSize);a.push({node:d,from:p,to:m})});const l=i-r,c=a.filter(d=>!o||o.name===d.node.type.name).filter(d=>wh(d.node.attrs,n,{strict:!1}));return s?!!c.length:c.reduce((d,h)=>d+h.to-h.from,0)>=l}function Ch(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Vk(t,e){const n="string"==typeof e?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}function Bk(t,e,n={}){return _h(t,e,{slice:!1,parseOptions:n})}function Nw(t){return e=>function xW(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}(e.$from,t)}function $k(t,e){const n=Us(e,t.schema),{from:r,to:i,empty:s}=t.selection,o=[];s?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function Hk(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const o=kw(n.resolve(t-1),i.type);!o||r.push({mark:i,...o})}):n.nodesBetween(t,e,(i,s)=>{r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}function Rw(t,e,n={}){const{empty:r,ranges:i}=t.selection,s=e?Us(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>!s||s.name===d.type.name).find(d=>wh(d.attrs,n,{strict:!1}));let o=0;const a=[];if(i.forEach(({$from:d,$to:h})=>{const p=d.pos,m=h.pos;t.doc.nodesBetween(p,m,(v,w)=>{if(!v.isText&&!v.marks.length)return;const k=Math.max(p,w),z=Math.min(m,w+v.nodeSize);o+=z-k,a.push(...v.marks.map(ce=>({mark:ce,from:k,to:z})))})}),0===o)return!1;const l=a.filter(d=>!s||s.name===d.mark.type.name).filter(d=>wh(d.mark.attrs,n,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),c=a.filter(d=>!s||d.mark.type!==s&&d.mark.type.excludes(s)).reduce((d,h)=>d+h.to-h.from,0);return(l>0?l+c:l)>=o}function zk(t,e){const{nodeExtensions:n}=yh(e),r=n.find(o=>o.name===t);if(!r)return!1;const s=Be(ue(r,"group",{name:r.name,options:r.options,storage:r.storage}));return"string"==typeof s&&s.split(" ").includes("list")}function Dh(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(s=>s.type===e&&s.name===r);return!!i&&i.attribute.keepOnSplit}))}function Gk(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e?.includes(i.type.name));t.tr.ensureMarks(r)}}const Wk=(t,e)=>{const n=Nw(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const i=t.doc.nodeAt(r);return n.node.type===i?.type&&tl(t.doc,n.pos)&&t.join(n.pos),!0},qk=(t,e)=>{const n=Nw(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const i=t.doc.nodeAt(r);return n.node.type===i?.type&&tl(t.doc,r)&&t.join(r),!0};var KW=Object.freeze({__proto__:null,blur:()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),null===(n=window?.getSelection())||void 0===n||n.removeAllRanges())}),!0),clearContent:(t=!1)=>({commands:e})=>e.setContent("",t),clearNodes:()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:s,$to:o})=>{t.doc.nodesBetween(s.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),p=d.blockRange(h);if(!p)return;const m=el(p);if(a.type.isTextblock){const{defaultType:v}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(p.start,v)}(m||0===m)&&e.lift(p,m)})}),!0},command:t=>e=>t(e),createParagraphNear:()=>({state:t,dispatch:e})=>wk(t,e),deleteNode:t=>({tr:e,state:n,dispatch:r})=>{const i=Yt(t,n.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const l=s.before(o),c=s.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},deleteRange:t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},deleteSelection:()=>({state:t,dispatch:e})=>yw(t,e),enter:()=>({commands:t})=>t.keyboardShortcut("Enter"),exitCode:()=>({state:t,dispatch:e})=>vk(t,e),extendMarkRange:(t,e={})=>({tr:n,state:r,dispatch:i})=>{const s=Us(t,r.schema),{doc:o,selection:a}=n,{$from:l,from:c,to:u}=a;if(i){const d=kw(l,s,e);if(d&&d.from<=c&&d.to>=u){const h=Ve.create(o,d.from,d.to);n.setSelection(h)}}return!0},first:t=>e=>{const n="function"==typeof t?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1},focus:(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{bh()&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===t||!1===t)return!0;if(s&&null===t&&!Fk(n.state.selection))return o(),!0;const a=Pk(i.doc,t)||n.state.selection,l=n.state.selection.eq(a);return s&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},forEach:(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),insertContent:(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),insertContentAt:(t,e,n)=>({tr:r,dispatch:i,editor:s})=>{if(i){n={parseOptions:{},updateSelection:!0,...n};const o=_h(e,s.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if("<>"===o.toString())return!0;let{from:a,to:l}="number"==typeof t?{from:t,to:t}:t,c=!0,u=!0;if(((t=>t.toString().startsWith("<"))(o)?o:[o]).forEach(h=>{h.check(),c=!!c&&h.isText&&0===h.marks.length,u=!!u&&h.isBlock}),a===l&&u){const{parent:h}=r.doc.resolve(a);h.isTextblock&&!h.type.spec.code&&!h.childCount&&(a-=1,l+=1)}c?r.insertText(e,a,l):r.replaceWith(a,l,o),n.updateSelection&&function uW(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof yn||i instanceof Jt))return;let o=0;t.mapping.maps[r].forEach((a,l,c,u)=>{0===o&&(o=u)}),t.setSelection(je.near(t.doc.resolve(o),n))}(r,r.steps.length-1,-1)}return!0},joinBackward:()=>({state:t,dispatch:e})=>dk(t,e),joinForward:()=>({state:t,dispatch:e})=>pk(t,e),keyboardShortcut:t=>({editor:e,view:n,tr:r,dispatch:i})=>{const s=function gW(t){const e=t.split(/-(?!$)/);let r,i,s,o,n=e[e.length-1];"Space"===n&&(n=" ");for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else{if(!/^mod$/i.test(l))throw new Error(`Unrecognized modifier name: ${l}`);bh()||Lk()?o=!0:i=!0}}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),s&&(n=`Shift-${n}`),n}(t).split(/-(?!$)/),o=s.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:"Space"===o?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0});return e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))})?.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0},lift:(t,e={})=>({state:n,dispatch:r})=>!!uu(n,Yt(t,n.schema),e)&&((t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),s=i&&el(i);return null!=s&&(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)})(n,r),liftEmptyBlock:()=>({state:t,dispatch:e})=>bk(t,e),liftListItem:t=>({state:e,dispatch:n})=>function xG(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return!!s&&(!n||(r.node(s.depth-1).type==t?function NG(t,e,n,r){let i=t.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new Jt(s-1,o,s,o,new oe(ee.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Zf(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const a=el(r);if(null==a)return!1;i.lift(r,a);let l=i.mapping.map(s,-1)-1;return tl(i.doc,l)&&i.join(l),e(i.scrollIntoView()),!0}(e,n,t,s):function OG(t,e,n){let r=t.tr,i=n.parent;for(let p=n.end,m=n.endIndex-1,v=n.startIndex;m>v;m--)p-=i.child(m).nodeSize,r.delete(p-1,p+1);let s=r.doc.resolve(n.start),o=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?ee.empty:ee.from(i))))return!1;let d=s.pos,h=d+o.nodeSize;return r.step(new Jt(d-(a?1:0),h+(l?1:0),d+1,h-1,new oe((a?ee.empty:ee.from(i.copy(ee.empty))).append(l?ee.empty:ee.from(i.copy(ee.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}(e,n,s)))}}(Yt(t,e.schema))(e,n),newlineInCode:()=>({state:t,dispatch:e})=>yk(t,e),resetAttributes:(t,e)=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const a=Ch("string"==typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(s=Yt(t,r.schema)),"mark"===a&&(o=Us(t,r.schema)),i&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{s&&s===c.type&&n.setNodeMarkup(u,void 0,Vk(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&n.addMark(u,u+c.nodeSize,o.create(Vk(d.attrs,e)))})})}),!0)},scrollIntoView:()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),selectAll:()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size}),selectNodeBackward:()=>({state:t,dispatch:e})=>fk(t,e),selectNodeForward:()=>({state:t,dispatch:e})=>gk(t,e),selectParentNode:()=>({state:t,dispatch:e})=>((t,e)=>{let i,{$from:n,to:r}=t.selection,s=n.sharedDepth(r);return 0!=s&&(i=n.before(s),e&&e(t.tr.setSelection(Se.create(t.doc,i))),!0)})(t,e),selectTextblockEnd:()=>({state:t,dispatch:e})=>Ek(t,e),selectTextblockStart:()=>({state:t,dispatch:e})=>Sk(t,e),setContent:(t,e=!1,n={})=>({tr:r,editor:i,dispatch:s})=>{const{doc:o}=r,a=Bk(t,i.schema,n);return s&&r.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!e),!0},setMark:(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:s}=n,{empty:o,ranges:a}=s,l=Us(t,r.schema);if(i)if(o){const c=$k(r,l);n.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(h,p)=>{const m=Math.max(p,u),v=Math.min(p+h.nodeSize,d);h.marks.find(k=>k.type===l)?h.marks.forEach(k=>{l===k.type&&n.addMark(m,v,l.create({...k.attrs,...e}))}):n.addMark(m,v,l.create(e))})});return function BW(t,e,n){var r;const{selection:i}=e;let s=null;if(Fk(i)&&(s=i.$cursor),s){const a=null!==(r=t.storedMarks)&&void 0!==r?r:s.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:o}=i;return o.some(({$from:a,$to:l})=>{let c=0===a.depth&&t.doc.inlineContent&&t.doc.type.allowsMarkType(n);return t.doc.nodesBetween(a.pos,l.pos,(u,d,h)=>{if(c)return!1;if(u.isInline){const p=!h||h.type.allowsMarkType(n),m=!!n.isInSet(u.marks)||!u.marks.some(v=>v.type.excludes(n));c=p&&m}return!c}),c})}(r,n,l)},setMeta:(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),setNode:(t,e={})=>({state:n,dispatch:r,chain:i})=>{const s=Yt(t,n.schema);return s.isTextblock?i().command(({commands:o})=>!!Mk(s,e)(n)||o.clearNodes()).command(({state:o})=>Mk(s,e)(o,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=es(t,0,r.content.size),s=Se.create(r,i);e.setSelection(s)}return!0},setTextSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:s}="number"==typeof t?{from:t,to:t}:t,o=Ve.atStart(r).from,a=Ve.atEnd(r).to,l=es(i,o,a),c=es(s,o,a),u=Ve.create(r,l,c);e.setSelection(u)}return!0},sinkListItem:t=>({state:e,dispatch:n})=>function RG(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==t);if(!s)return!1;let o=s.startIndex;if(0==o)return!1;let a=s.parent,l=a.child(o-1);if(l.type!=t)return!1;if(n){let c=l.lastChild&&l.lastChild.type==a.type,u=ee.from(c?t.create():null),d=new oe(ee.from(t.create(null,ee.from(a.type.create(null,u)))),c?3:1,0),h=s.start,p=s.end;n(e.tr.step(new Jt(h-(c?3:1),p,h,p,d,1,!0)).scrollIntoView())}return!0}}(Yt(t,e.schema))(e,n),splitBlock:({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:s,doc:o}=e,{$from:a,$to:l}=s,u=Dh(i.extensionManager.attributes,a.node().type.name,a.node().attrs);if(s instanceof Se&&s.node.isBlock)return!(!a.parentOffset||!Zi(o,a.pos)||(r&&(t&&Gk(n,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),0));if(!a.parent.isBlock)return!1;if(r){const d=l.parentOffset===l.parent.content.size;s instanceof Ve&&e.deleteSelection();const h=0===a.depth?void 0:function kW(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=d&&h?[{type:h,attrs:u}]:void 0,m=Zi(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!m&&Zi(e.doc,e.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(m=!0,p=h?[{type:h,attrs:u}]:void 0),m&&(e.split(e.mapping.map(a.pos),1,p),h&&!d&&!a.parentOffset&&a.parent.type!==h)){const v=e.mapping.map(a.before()),w=e.doc.resolve(v);a.node(-1).canReplaceWith(w.index(),w.index()+1,h)&&e.setNodeMarkup(e.mapping.map(a.before()),h)}t&&Gk(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return!0},splitListItem:t=>({tr:e,state:n,dispatch:r,editor:i})=>{var s;const o=Yt(t,n.schema),{$from:a,$to:l}=n.selection,c=n.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==o)return!1;const d=i.extensionManager.attributes;if(0===a.parent.content.size&&a.node(-1).childCount===a.indexAfter(-1)){if(2===a.depth||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let w=ee.empty;const k=a.index(-1)?1:a.index(-2)?2:3;for(let wn=a.depth-k;wn>=a.depth-3;wn-=1)w=ee.from(a.node(wn).copy(w));const z=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,B=Dh(d,a.node().type.name,a.node().attrs),ce=(null===(s=o.contentMatch.defaultType)||void 0===s?void 0:s.createAndFill(B))||void 0;w=w.append(ee.from(o.createAndFill(null,ce)||void 0));const _e=a.before(a.depth-(k-1));e.replace(_e,a.after(-z),new oe(w,4-k,0));let Je=-1;e.doc.nodesBetween(_e,e.doc.content.size,(wn,Oe)=>{if(Je>-1)return!1;wn.isTextblock&&0===wn.content.size&&(Je=Oe+1)}),Je>-1&&e.setSelection(Ve.near(e.doc.resolve(Je))),e.scrollIntoView()}return!0}const h=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,p=Dh(d,u.type.name,u.attrs),m=Dh(d,a.node().type.name,a.node().attrs);e.delete(a.pos,l.pos);const v=h?[{type:o,attrs:p},{type:h,attrs:m}]:[{type:o,attrs:p}];return!!Zi(e.doc,a.pos,2)&&(r&&e.split(a.pos,2,v).scrollIntoView(),!0)},toggleList:(t,e)=>({editor:n,tr:r,state:i,dispatch:s,chain:o,commands:a,can:l})=>{const{extensions:c}=n.extensionManager,u=Yt(t,i.schema),d=Yt(e,i.schema),{selection:h}=i,{$from:p,$to:m}=h,v=p.blockRange(m);if(!v)return!1;const w=Nw(k=>zk(k.type.name,c))(h);if(v.depth>=1&&w&&v.depth-w.depth<=1){if(w.node.type===u)return a.liftListItem(d);if(zk(w.node.type.name,c)&&u.validContent(w.node.content)&&s)return o().command(()=>(r.setNodeMarkup(w.pos,u),!0)).command(()=>Wk(r,u)).command(()=>qk(r,u)).run()}return o().command(()=>!!l().wrapInList(u)||a.clearNodes()).wrapInList(u).command(()=>Wk(r,u)).command(()=>qk(r,u)).run()},toggleMark:(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=n,o=Us(t,r.schema);return Rw(r,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},toggleNode:(t,e,n={})=>({state:r,commands:i})=>{const s=Yt(t,r.schema),o=Yt(e,r.schema);return uu(r,s,n)?i.setNode(o):i.setNode(s,n)},toggleWrap:(t,e={})=>({state:n,commands:r})=>{const i=Yt(t,n.schema);return uu(n,i,e)?r.lift(i):r.wrapIn(i,e)},undoInputRule:()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let s;if(i.spec.isInputRules&&(s=i.getState(t))){if(e){const o=t.tr,a=s.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(s.text){const l=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,t.schema.text(s.text,l))}else o.delete(s.from,s.to)}return!0}}return!1},unsetAllMarks:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(s=>{t.removeMark(s.$from.pos,s.$to.pos)}),!0},unsetMark:(t,e={})=>({tr:n,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=n,l=Us(t,r.schema),{$from:c,empty:u,ranges:d}=a;if(!i)return!0;if(u&&o){let{from:h,to:p}=a;const m=null===(s=c.marks().find(w=>w.type===l))||void 0===s?void 0:s.attrs,v=kw(c,l,m);v&&(h=v.from,p=v.to),n.removeMark(h,p,l)}else d.forEach(h=>{n.removeMark(h.$from.pos,h.$to.pos,l)});return n.removeStoredMark(l),!0},updateAttributes:(t,e={})=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const a=Ch("string"==typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(s=Yt(t,r.schema)),"mark"===a&&(o=Us(t,r.schema)),i&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;r.doc.nodesBetween(c,u,(d,h)=>{s&&s===d.type&&n.setNodeMarkup(h,void 0,{...d.attrs,...e}),o&&d.marks.length&&d.marks.forEach(p=>{if(o===p.type){const m=Math.max(h,c),v=Math.min(h+d.nodeSize,u);n.addMark(m,v,o.create({...p.attrs,...e}))}})})}),!0)},wrapIn:(t,e={})=>({state:n,dispatch:r})=>function wG(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),a=o&&Fv(o,t,e);return!!a&&(r&&r(n.tr.wrap(o,a).scrollIntoView()),!0)}}(Yt(t,n.schema),e)(n,r),wrapInList:(t,e={})=>({state:n,dispatch:r})=>function IG(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),a=!1,l=o;if(!o)return!1;if(o.depth>=2&&i.node(o.depth-1).type.compatibleContent(t)&&0==o.startIndex){if(0==i.index(o.depth-1))return!1;let u=n.doc.resolve(o.start-2);l=new Zf(u,u,o.depth),o.endIndex<o.parent.childCount&&(o=new Zf(i,n.doc.resolve(s.end(o.depth)),o.depth)),a=!0}let c=Fv(l,t,e,o);return!!c&&(r&&r(function kG(t,e,n,r,i){let s=ee.empty;for(let u=n.length-1;u>=0;u--)s=ee.from(n[u].type.create(n[u].attrs,s));t.step(new Jt(e.start-(r?2:0),e.end,e.start,e.end,new oe(s,0,0),n.length,!0));let o=0;for(let u=0;u<n.length;u++)n[u].type==i&&(o=u+1);let a=n.length-o,l=e.start+n.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,h=!0;u<d;u++,h=!1)!h&&Zi(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return t}(n.tr,o,c,a,t).scrollIntoView()),!0)}}(Yt(t,n.schema),e)(n,r)});const JW=On.create({name:"commands",addCommands:()=>({...KW})}),YW=On.create({name:"editable",addProseMirrorPlugins(){return[new An({key:new qr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),ZW=On.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new An({key:new qr("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),QW=On.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:h,parent:p}=d,m=je.atStart(c).from===h;return!(!(u&&m&&p.type.isTextblock)||p.textContent.length)&&o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return bh()||Lk()?s:i},addProseMirrorPlugins(){return[new An({key:new qr("clearDocument"),appendTransaction:(t,e,n)=>{if(!t.some(m=>m.docChanged)||e.doc.eq(n.doc))return;const{empty:i,from:s,to:o}=e.selection,a=je.atStart(e.doc).from,l=je.atEnd(e.doc).to,c=s===a&&o===l,u=0===n.doc.textBetween(0,n.doc.content.size," "," ").length;if(i||!c||!u)return;const d=n.tr,h=gh({state:n,transaction:d}),{commands:p}=new mh({editor:this.editor,state:h});return p.clearNodes(),d.steps.length?d:void 0}})]}}),XW=On.create({name:"tabindex",addProseMirrorPlugins(){return[new An({key:new qr("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var eq=Object.freeze({__proto__:null,ClipboardTextSerializer:qG,Commands:JW,Editable:YW,FocusEvents:ZW,Keymap:QW,Tabindex:XW});class rq extends FG{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function nq(t,e){const n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e){this.setOptions({editable:e}),this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=Ik(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});this.view.updateState(i)}unregisterPlugin(e){if(this.isDestroyed)return;const n="string"==typeof e?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(n))});this.view.updateState(r)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(eq):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r?.type));this.extensionManager=new Vo(n,this)}createCommandManager(){this.commandManager=new mh({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=Bk(this.options.content,this.schema,this.options.parseOptions),n=Pk(e,this.options.autofocus);this.view=new iG(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:sl.create({doc:e,selection:n||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(o=>{var a;return null===(a=this.capturedTransaction)||void 0===a?void 0:a.step(o)}):void(this.capturedTransaction=e);const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),s=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return function OW(t,e){const n=Ch("string"==typeof e?e:e.name,t.schema);return"node"===n?function NW(t,e){const n=Yt(e,t.schema),{from:r,to:i}=t.selection,s=[];t.doc.nodesBetween(r,i,a=>{s.push(a)});const o=s.reverse().find(a=>a.type.name===n.name);return o?{...o.attrs}:{}}(t,e):"mark"===n?$k(t,e):{}}(this.state,e)}isActive(e,n){return function LW(t,e,n={}){if(!e)return uu(t,null,n)||Rw(t,null,n);const r=Ch(e,t.schema);return"node"===r?uu(t,e,n):"mark"===r&&Rw(t,e,n)}(this.state,"string"==typeof e?e:null,"string"==typeof e?n:e)}getJSON(){return this.state.doc.toJSON()}getHTML(){return function Uk(t,e){const n=vi.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n="\n\n",textSerializers:r={}}=e||{};return function jk(t,e){return Rk(t,{from:0,to:t.content.size},e)}(this.state.doc,{blockSeparator:n,textSerializers:{...r,...Aw(this.schema)}})}get isEmpty(){return function VW(t){var e;const n=null===(e=t.type.createAndFill())||void 0===e?void 0:e.toJSON(),r=t.toJSON();return JSON.stringify(n)===JSON.stringify(r)}(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(null!==(e=this.view)&&void 0!==e&&e.docView)}}function pl(t){return new cu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Be(t.getAttributes,void 0,r);if(!1===i||null===i)return null;const{tr:s}=e,o=r[r.length-1],a=r[0];let l=n.to;if(o){const c=a.search(/\S/),u=n.from+a.indexOf(o),d=u+o.length;if(Hk(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(v=>v===t.type&&v!==p.mark.type)).filter(p=>p.to>u).length)return null;d<n.to&&s.delete(d,n.to),u>n.from&&s.delete(n.from+c,u),l=n.from+c+o.length,s.addMark(n.from+c,l,t.type.create(i||{})),s.removeStoredMark(t.type)}}})}function Fw(t){return new cu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),s=Be(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)}})}function Pw(t){return new cu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Be(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),a=s.doc.resolve(n.from).blockRange(),l=a&&Fv(a,t.type,i);if(!l)return null;s.wrap(a,l);const c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&tl(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,c))&&s.join(n.from-1)}})}class js{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Be(ue(this,"addOptions",{name:this.name}))),this.storage=Be(ue(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new js(e)}configure(e={}){const n=this.extend();return n.options=vh(this.options,e),n.storage=Be(ue(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new js(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Be(ue(n,"addOptions",{name:n.name})),n.storage=Be(ue(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!o.find(c=>c?.type.name===n.name))return!1;const l=o.find(c=>c?.type.name===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}class Kn{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Be(ue(this,"addOptions",{name:this.name}))),this.storage=Be(ue(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Kn(e)}configure(e={}){const n=this.extend();return n.options=vh(this.options,e),n.storage=Be(ue(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new Kn(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Be(ue(n,"addOptions",{name:n.name})),n.storage=Be(ue(n,"addStorage",{name:n.name,options:n.options})),n}}function gl(t){return new Mw({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Be(t.getAttributes,void 0,r);if(!1===i||null===i)return null;const{tr:s}=e,o=r[r.length-1],a=r[0];let l=n.to;if(o){const c=a.search(/\S/),u=n.from+a.indexOf(o),d=u+o.length;if(Hk(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(v=>v===t.type&&v!==p.mark.type)).filter(p=>p.to>u).length)return null;d<n.to&&s.delete(d,n.to),u>n.from&&s.delete(n.from+c,u),l=n.from+c+o.length,s.addMark(n.from+c,l,t.type.create(i||{})),s.removeStoredMark(t.type)}}})}const sq=/^\s*>\s$/,oq=Kn.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:t}){return["blockquote",Nn(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Pw({find:sq,type:this.type})]}}),aq=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,lq=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,cq=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,uq=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,dq=js.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],renderHTML({HTMLAttributes:t}){return["strong",Nn(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[pl({find:aq,type:this.type}),pl({find:cq,type:this.type})]},addPasteRules(){return[gl({find:lq,type:this.type}),gl({find:uq,type:this.type})]}}),fq=/^\s*([-+*])\s$/,hq=Kn.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:t}){return["ul",Nn(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[Pw({find:fq,type:this.type})]}}),pq=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,gq=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,mq=js.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:t}){return["code",Nn(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[pl({find:pq,type:this.type})]},addPasteRules(){return[gl({find:gq,type:this.type})]}}),yq=/^```([a-z]+)?[\s\n]$/,vq=/^~~~([a-z]+)?[\s\n]$/,wq=Kn.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;return[...(null===(e=t.firstElementChild)||void 0===e?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:t,HTMLAttributes:e}){return["pre",Nn(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection;return!(!t||e.parent.type.name!==this.name)&&!(1!==e.pos&&e.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith("\n\n");return!(!s||!o)&&t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:s}=n;if(!s||i.parent.type!==this.type||i.parentOffset!==i.parent.nodeSize-2)return!1;const a=i.after();return void 0!==a&&!r.nodeAt(a)&&t.commands.exitCode()}}},addInputRules(){return[Fw({find:yq,type:this.type,getAttributes:t=>({language:t[1]})}),Fw({find:vq,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new An({key:new qr("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=(r?JSON.parse(r):void 0)?.mode;if(!n||!s)return!1;const{tr:o}=t.state;return o.replaceSelectionWith(this.type.create({language:s})),o.setSelection(Ve.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(n.replace(/\r\n?/g,"\n")),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),bq=Kn.create({name:"doc",topNode:!0,content:"block+"});function _q(t={}){return new An({view:e=>new Cq(e,t)})}class Cq{constructor(e,n){this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=n.width||1,this.color=n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let i=s=>{this[r](s)};return e.dom.addEventListener(r,i),{name:r,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){null!=this.cursorPos&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let n,e=this.editorView.state.doc.resolve(this.cursorPos);if(!e.parent.inlineContent){let o=e.nodeBefore,a=e.nodeAfter;if(o||a){let l=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0)).getBoundingClientRect(),c=o?l.bottom:l.top;o&&a&&(c=(c+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),n={left:l.left,right:l.right,top:c-this.width/2,bottom:c+this.width/2}}}if(!n){let o=this.editorView.coordsAtPos(this.cursorPos);n={left:o.left-this.width/2,right:o.left+this.width/2,top:o.top,bottom:o.bottom}}let i,s,r=this.editorView.dom.offsetParent;if(this.element||(this.element=r.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!r||r==document.body&&"static"==getComputedStyle(r).position)i=-pageXOffset,s=-pageYOffset;else{let o=r.getBoundingClientRect();i=o.left-r.scrollLeft,s=o.top-r.scrollTop}this.element.style.left=n.left-i+"px",this.element.style.top=n.top-s+"px",this.element.style.width=n.right-n.left+"px",this.element.style.height=n.bottom-n.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,s="function"==typeof i?i(this.editorView,n):i;if(n&&!s){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(o=HA(this.editorView.state.doc,o,this.editorView.dragging.slice),null==o))return this.setCursor(null);this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const Dq=On.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[_q(this.options)]}});class It extends je{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return It.valid(r)?new It(r):je.near(r)}content(){return oe.empty}eq(e){return e instanceof It&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new It(e.resolve(n.pos))}getBookmark(){return new Lw(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!function Sq(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(0!=n)for(let i=r.child(n-1);;i=i.lastChild){if(0==i.childCount&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e)||!function Eq(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(let i=r.child(n);;i=i.firstChild){if(0==i.childCount&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e))return!1;let r=n.type.spec.allowGapCursor;if(null!=r)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&It.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let a=e.node(o);if(n>0?e.indexAfter(o)<a.childCount:e.index(o)>0){s=a.child(n>0?e.indexAfter(o):e.index(o)-1);break}if(0==o)return null;i+=n;let l=e.doc.resolve(i);if(It.valid(l))return l}for(;;){let o=n>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!Se.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*n),r=!1;continue e}break}s=o,i+=n;let a=e.doc.resolve(i);if(It.valid(a))return a}return null}}}It.prototype.visible=!1,It.findFrom=It.findGapCursorFrom,je.jsonID("gapcursor",It);class Lw{constructor(e){this.pos=e}map(e){return new Lw(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return It.valid(n)?new It(n):je.near(n)}}const Tq=uk({ArrowLeft:Sh("horiz",-1),ArrowRight:Sh("horiz",1),ArrowUp:Sh("vert",-1),ArrowDown:Sh("vert",1)});function Sh(t,e){const n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof Ve){if(!s.endOfTextblock(n)||0==a.depth)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=It.findGapCursorFrom(a,e,l);return!!c&&(i&&i(r.tr.setSelection(new It(c))),!0)}}function Aq(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!It.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return!(i&&i.inside>-1&&Se.isSelectable(t.state.doc.nodeAt(i.inside))||(t.dispatch(t.state.tr.setSelection(new It(r))),0))}function Iq(t,e){if("insertCompositionText"!=e.inputType||!(t.state.selection instanceof It))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=ee.empty;for(let o=r.length-1;o>=0;o--)i=ee.from(r[o].createAndFill(null,i));let s=t.state.tr.replace(n.pos,n.pos,new oe(i,0,0));return s.setSelection(Ve.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function kq(t){if(!(t.selection instanceof It))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Rt.create(t.doc,[qn.widget(t.selection.head,e,{key:"gapcursor"})])}const xq=On.create({name:"gapCursor",addProseMirrorPlugins:()=>[new An({props:{decorations:kq,createSelectionBetween:(t,e,n)=>e.pos==n.pos&&It.valid(n)?new It(n):null,handleClick:Aq,handleKeyDown:Tq,handleDOMEvents:{beforeinput:Iq}}})],extendNodeSchema(t){var e;return{allowGapCursor:null!==(e=Be(ue(t,"allowGapCursor",{name:t.name,options:t.options,storage:t.storage})))&&void 0!==e?e:null}}}),Nq=Kn.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:t}){return["br",Nn(this.options.HTMLAttributes,t)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:s}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const d=l.filter(h=>a.includes(h.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Oq=Kn.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Nn(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.setNode(this.name,t),toggleHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>Fw({find:new RegExp(`^(#{1,${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var sn=function(){};sn.prototype.append=function(e){return e.length?(e=sn.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},sn.prototype.prepend=function(e){return e.length?sn.from(e).append(this):this},sn.prototype.appendInner=function(e){return new Rq(this,e)},sn.prototype.slice=function(e,n){return void 0===e&&(e=0),void 0===n&&(n=this.length),e>=n?sn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))},sn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},sn.prototype.forEach=function(e,n,r){void 0===n&&(n=0),void 0===r&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)},sn.prototype.map=function(e,n,r){void 0===n&&(n=0),void 0===r&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},n,r),i},sn.from=function(e){return e instanceof sn?e:e&&e.length?new Kk(e):sn.empty};var Kk=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return 0==i&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,a){for(var l=s;l<o;l++)if(!1===i(this.values[l],a+l))return!1},e.prototype.forEachInvertedInner=function(i,s,o,a){for(var l=s-1;l>=o;l--)if(!1===i(this.values[l],a+l))return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=200)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=200)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(sn);sn.empty=new Kk([]);var Rq=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var a=this.left.length;if(i<a&&!1===this.left.forEachInner(r,i,Math.min(s,a),o)||s>a&&!1===this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,s)-a,o+a))return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var a=this.left.length;if(i>a&&!1===this.right.forEachInvertedInner(r,i-a,Math.max(s,a)-a,o+a)||s<a&&!1===this.left.forEachInvertedInner(r,Math.min(i,a),s,o))return!1},e.prototype.sliceInner=function(r,i){if(0==r&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(sn);const Jk=sn;class Yr{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(0==this.eventCount)return null;let i,s,r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}n&&(i=this.remapping(r,this.items.length),s=i.maps.length);let a,l,o=e.tr,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step)return i||(i=this.remapping(r,h+1),s=i.maps.length),s--,void u.push(d);if(i){u.push(new Di(d.map));let m,p=d.step.map(i.slice(s));p&&o.maybeStep(p).doc&&(m=o.mapping.maps[o.mapping.maps.length-1],c.push(new Di(m,void 0,void 0,c.length+u.length))),s--,m&&i.appendMap(m,s)}else o.maybeStep(d.step);return d.selection?(a=i?d.selection.map(i.slice(s)):d.selection,l=new Yr(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,n,r,i){let s=[],o=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let p,d=e.steps[u].invert(e.docs[u]),h=new Di(e.mapping.maps[u],d,n);(p=l&&l.merge(h))&&(h=p,u?s.pop():a=a.slice(0,a.length-1)),s.push(h),n&&(o++,n=void 0),i||(l=h)}let c=o-r.depth;return c>Vq&&(a=function Lq(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&0==e--)return n=i,!1}),t.slice(n)}(a,c),o-=c),new Yr(a.append(s),o)}remapping(e,n){let r=new Qa;return this.items.forEach((i,s)=>{r.appendMap(i.map,null!=i.mirrorOffset&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0)},e,n),r}addMaps(e){return 0==this.eventCount?this:new Yr(this.items.append(e.map(n=>new Di(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),s=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},i);let l=n;this.items.forEach(h=>{let p=s.getMirror(--l);if(null==p)return;o=Math.min(o,p);let m=s.maps[p];if(h.step){let v=e.steps[p].invert(e.docs[p]),w=h.selection&&h.selection.map(s.slice(l+1,p));w&&a++,r.push(new Di(m,v,w))}else r.push(new Di(m))},i);let c=[];for(let h=n;h<o;h++)c.push(new Di(s.maps[h]));let u=this.items.slice(0,i).append(c).append(r),d=new Yr(u,a);return d.emptyItemCount()>500&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],s=0;return this.items.forEach((o,a)=>{if(a>=e)i.push(o),o.selection&&s++;else if(o.step){let l=o.step.map(n.slice(r)),c=l&&l.getMap();if(r--,c&&n.appendMap(c,r),l){let u=o.selection&&o.selection.map(n.slice(r));u&&s++;let h,d=new Di(c.invert(),l,u),p=i.length-1;(h=i.length&&i[p].merge(d))?i[p]=h:i.push(d)}}else o.map&&r--},this.items.length,0),new Yr(Jk.from(i.reverse()),s)}}Yr.empty=new Yr(Jk.empty,0);class Di{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Di(n.getMap().invert(),n,this.selection)}}}class $s{constructor(e,n,r,i){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i}}const Vq=20;function Yk(t){let e=[];return t.forEach((n,r,i,s)=>e.push(i,s)),e}function Vw(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),s=e.map(t[r+1],-1);i<=s&&n.push(i,s)}return n}function Zk(t,e,n,r){let i=Mh(e),s=Si.get(e).spec.config,o=(r?t.undone:t.done).popEvent(e,i);if(!o)return;let a=o.selection.resolve(o.transform.doc),l=(r?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),s,i),c=new $s(r?l:o.remaining,r?o.remaining:l,null,0);n(o.transform.setSelection(a).setMeta(Si,{redo:r,historyState:c}).scrollIntoView())}let Bw=!1,Qk=null;function Mh(t){let e=t.plugins;if(Qk!=e){Bw=!1,Qk=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Bw=!0;break}}return Bw}const Si=new qr("history"),Xk=new qr("closeHistory");function jq(t={}){return new An({key:Si,state:{init:()=>new $s(Yr.empty,Yr.empty,null,0),apply:(e,n,r)=>function Bq(t,e,n,r){let s,i=n.getMeta(Si);if(i)return i.historyState;n.getMeta(Xk)&&(t=new $s(t.done,t.undone,null,0));let o=n.getMeta("appendedTransaction");if(0==n.steps.length)return t;if(o&&o.getMeta(Si))return o.getMeta(Si).redo?new $s(t.done.addTransform(n,void 0,r,Mh(e)),t.undone,Yk(n.mapping.maps[n.steps.length-1]),t.prevTime):new $s(t.done,t.undone.addTransform(n,void 0,r,Mh(e)),null,t.prevTime);if(!1===n.getMeta("addToHistory")||o&&!1===o.getMeta("addToHistory"))return(s=n.getMeta("rebased"))?new $s(t.done.rebased(n,s),t.undone.rebased(n,s),Vw(t.prevRanges,n.mapping),t.prevTime):new $s(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Vw(t.prevRanges,n.mapping),t.prevTime);{let a=0==t.prevTime||!o&&(t.prevTime<(n.time||0)-r.newGroupDelay||!function Uq(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(n=!0)}),n}(n,t.prevRanges)),l=o?Vw(t.prevRanges,n.mapping):Yk(n.mapping.maps[n.steps.length-1]);return new $s(t.done.addTransform(n,a?e.selection.getBookmark():void 0,r,Mh(e)),Yr.empty,l,n.time)}}(n,r,e,t)},config:t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i="historyUndo"==r?ex:"historyRedo"==r?tx:null;return!!i&&(n.preventDefault(),i(e.state,e.dispatch))}}}})}const ex=(t,e)=>{let n=Si.getState(t);return!(!n||0==n.done.eventCount||(e&&Zk(n,t,e,!1),0))},tx=(t,e)=>{let n=Si.getState(t);return!(!n||0==n.undone.eventCount||(e&&Zk(n,t,e,!0),0))},$q=On.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:t,dispatch:e})=>ex(t,e),redo:()=>({state:t,dispatch:e})=>tx(t,e)}),addProseMirrorPlugins(){return[jq(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),Hq=Kn.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:t}){return["hr",Nn(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t})=>t().insertContent({type:this.name}).command(({tr:e,dispatch:n})=>{var r;if(n){const{$to:i}=e.selection,s=i.end();if(i.nodeAfter)e.setSelection(Ve.create(e.doc,i.pos));else{const o=null===(r=i.parent.type.contentMatch.defaultType)||void 0===r?void 0:r.create();o&&(e.insert(s,o),e.setSelection(Ve.create(e.doc,s)))}e.scrollIntoView()}return!0}).run()}},addInputRules(){return[(t={find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type},new cu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Be(t.getAttributes,void 0,r)||{},{tr:s}=e,o=n.from;let a=n.to;if(r[1]){let c=o+r[0].lastIndexOf(r[1]);c>a?c=a:a=c+r[1].length,s.insertText(r[0][r[0].length-1],o+r[0].length-1),s.replaceWith(c,a,t.type.create(i))}else r[0]&&s.replaceWith(o,a,t.type.create(i))}}))];var t}}),zq=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,Gq=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,Wq=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,qq=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,Kq=js.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:t=>"normal"!==t.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:t}){return["em",Nn(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[pl({find:zq,type:this.type}),pl({find:Wq,type:this.type})]},addPasteRules(){return[gl({find:Gq,type:this.type}),gl({find:qq,type:this.type})]}}),Jq=Kn.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:t}){return["li",Nn(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Yq=/^(\d+)\.\s$/,Zq=Kn.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return 1===e?["ol",Nn(this.options.HTMLAttributes,n),0]:["ol",Nn(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[Pw({find:Yq,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]})]}}),Qq=Kn.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:t}){return["p",Nn(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Xq=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,e9=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,t9=js.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("line-through")&&{}}],renderHTML({HTMLAttributes:t}){return["s",Nn(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[pl({find:Xq,type:this.type})]},addPasteRules(){return[gl({find:e9,type:this.type})]}}),n9=Kn.create({name:"text",group:"inline"}),r9=On.create({name:"starterKit",addExtensions(){var t,e,n,r,i,s,o,a,l,c,u,d,h,p,m,v,w,k;const z=[];return!1!==this.options.blockquote&&z.push(oq.configure(null===(t=this.options)||void 0===t?void 0:t.blockquote)),!1!==this.options.bold&&z.push(dq.configure(null===(e=this.options)||void 0===e?void 0:e.bold)),!1!==this.options.bulletList&&z.push(hq.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&z.push(mq.configure(null===(r=this.options)||void 0===r?void 0:r.code)),!1!==this.options.codeBlock&&z.push(wq.configure(null===(i=this.options)||void 0===i?void 0:i.codeBlock)),!1!==this.options.document&&z.push(bq.configure(null===(s=this.options)||void 0===s?void 0:s.document)),!1!==this.options.dropcursor&&z.push(Dq.configure(null===(o=this.options)||void 0===o?void 0:o.dropcursor)),!1!==this.options.gapcursor&&z.push(xq.configure(null===(a=this.options)||void 0===a?void 0:a.gapcursor)),!1!==this.options.hardBreak&&z.push(Nq.configure(null===(l=this.options)||void 0===l?void 0:l.hardBreak)),!1!==this.options.heading&&z.push(Oq.configure(null===(c=this.options)||void 0===c?void 0:c.heading)),!1!==this.options.history&&z.push($q.configure(null===(u=this.options)||void 0===u?void 0:u.history)),!1!==this.options.horizontalRule&&z.push(Hq.configure(null===(d=this.options)||void 0===d?void 0:d.horizontalRule)),!1!==this.options.italic&&z.push(Kq.configure(null===(h=this.options)||void 0===h?void 0:h.italic)),!1!==this.options.listItem&&z.push(Jq.configure(null===(p=this.options)||void 0===p?void 0:p.listItem)),!1!==this.options.orderedList&&z.push(Zq.configure(null===(m=this.options)||void 0===m?void 0:m.orderedList)),!1!==this.options.paragraph&&z.push(Qq.configure(null===(v=this.options)||void 0===v?void 0:v.paragraph)),!1!==this.options.strike&&z.push(t9.configure(null===(w=this.options)||void 0===w?void 0:w.strike)),!1!==this.options.text&&z.push(n9.configure(null===(k=this.options)||void 0===k?void 0:k.text)),z}}),Zr=()=>new Map,Th=t=>{const e=Zr();return t.forEach((n,r)=>{e.set(r,n)}),e},lr=(t,e,n)=>{let r=t.get(e);return void 0===r&&t.set(e,r=n()),r},ml=()=>new Set,Uw=t=>t[t.length-1],o9=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},nx=Array.from,rx=Array.isArray;class du{constructor(){this._observers=Zr()}on(e,n){lr(this._observers,e,ml).add(n)}once(e,n){const r=(...i)=>{this.off(e,r),n(...i)};this.on(e,r)}off(e,n){const r=this._observers.get(e);void 0!==r&&(r.delete(n),0===r.size&&this._observers.delete(e))}emit(e,n){return nx((this._observers.get(e)||Zr()).values()).forEach(r=>r(...n))}destroy(){this._observers=Zr()}}const Qr=Math.floor,Ah=(Math,Math.abs),l9=(Math,Math,Math.log10),Hs=(Math,Math,Math,(t,e)=>t<e?t:e),ts=(t,e)=>t>e?t:e,ix=(Math,Math,t=>0!==t?t<0:1/t<0),c9=String.fromCharCode,d9=/^\s*/g,h9=/([A-Z])/g,sx=(t,e)=>(t=>t.replace(d9,""))(t.replace(h9,n=>`${e}${(t=>t.toLowerCase())(n)}`)),fu=typeof TextEncoder<"u"?new TextEncoder:null,jw=fu?t=>fu.encode(t):t=>{const e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=e.codePointAt(i);return r};let yl=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});yl&&1===yl.decode(new Uint8Array).length&&(yl=null);let ax=new class g9{constructor(){this.map=new Map}setItem(e,n){this.map.set(e,n)}getItem(e){return this.map.get(e)}},lx=!0;try{typeof localStorage<"u"&&(ax=localStorage,lx=!1)}catch{}const cx=ax,ux=Object.keys,Ih=t=>ux(t).length,dx=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),$w=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&$w(t,e,n+1)}},w9=()=>{},hu=(t,e)=>{if(null==t||null==e)return((t,e)=>t===e)(t,e);if(t.constructor!==e.constructor)return!1;if(t===e)return!0;switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;break;case Set:if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;break;case Map:if(t.size!==e.size)return!1;for(const n of t.keys())if(!e.has(n)||!hu(t.get(n),e.get(n)))return!1;break;case Object:if(Ih(t)!==Ih(e))return!1;for(const n in t)if(!dx(t,n)||!hu(t[n],e[n]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!hu(t[n],e[n]))return!1;break;default:return!1}return!0},Bo=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name),Hw=typeof window<"u"&&!Bo;let Ei;typeof navigator<"u"&&/Mac/.test(navigator.platform);const C9=[],Gw=t=>(()=>{if(void 0===Ei)if(Bo){Ei=Zr();const t=process.argv;let e=null;for(let n=0;n<t.length;n++){const r=t[n];"-"===r[0]?(null!==e&&Ei.set(e,""),e=r):null!==e?(Ei.set(e,r),e=null):C9.push(r)}null!==e&&Ei.set(e,"")}else"object"==typeof location?(Ei=Zr(),(location.search||"?").slice(1).split("&").forEach(t=>{if(0!==t.length){const[e,n]=t.split("=");Ei.set(`--${sx(e,"-")}`,n),Ei.set(`-${sx(e,"-")}`,n)}})):Ei=Zr();return Ei})().has(t),pu=t=>(t=>void 0===t?null:t)(Bo?process.env[t.toUpperCase()]:cx.getItem(t)),fx=(Gw("--"+"production")||pu("production"),Bo&&((t,e)=>["true","1","2"].includes(t))(process.env.FORCE_COLOR)),D9=!Gw("no-colors")&&(!Bo||process.stdout.isTTY||fx)&&(!Bo||Gw("color")||fx||null!==pu("COLORTERM")||(pu("TERM")||"").includes("color")),hx=t=>new Uint8Array(t),Ww=(t,e,n)=>new Uint8Array(t,e,n),px=Hw?t=>{let e="";for(let n=0;n<t.byteLength;n++)e+=c9(t[n]);return btoa(e)}:t=>Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("base64"),gx=Hw?t=>{const e=atob(t),n=hx(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}:t=>{const e=Buffer.from(t,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},cr=128,wx=Number.MAX_SAFE_INTEGER,z9=Number.isInteger||(t=>"number"==typeof t&&isFinite(t)&&Qr(t)===t);class vl{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Zt=()=>new vl,_t=t=>{const e=new Uint8Array((t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e})(t));let n=0;for(let r=0;r<t.bufs.length;r++){const i=t.bufs[r];e.set(i,n),n+=i.length}return e.set(Ww(t.cbuf.buffer,0,t.cpos),n),e},kt=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(2*n),t.cpos=0),t.cbuf[t.cpos++]=e},mu=kt,he=(t,e)=>{for(;e>127;)kt(t,cr|127&e),e=Qr(e/128);kt(t,127&e)},yu=(t,e)=>{const n=ix(e);for(n&&(e=-e),kt(t,(e>63?cr:0)|(n?64:0)|63&e),e=Qr(e/64);e>0;)kt(t,(e>127?cr:0)|127&e),e=Qr(e/128)},Zw=new Uint8Array(3e4),q9=Zw.length/3,Mi=fu&&fu.encodeInto?(t,e)=>{if(e.length<q9){const n=fu.encodeInto(e,Zw).written||0;he(t,n);for(let r=0;r<n;r++)kt(t,Zw[r])}else xt(t,jw(e))}:(t,e)=>{const n=unescape(encodeURIComponent(e)),r=n.length;he(t,r);for(let i=0;i<r;i++)kt(t,n.codePointAt(i))},vu=(t,e)=>{const n=t.cbuf.length,r=t.cpos,i=Hs(n-r,e.length),s=e.length-i;t.cbuf.set(e.subarray(0,i),r),t.cpos+=i,s>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(ts(2*n,s)),t.cbuf.set(e.subarray(i)),t.cpos=s)},xt=(t,e)=>{he(t,e.byteLength),vu(t,e)},xh=(t,e)=>{((t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(Ww(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(2*ts(n,e)),t.cpos=0)})(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},bx=new DataView(new ArrayBuffer(4)),wl=(t,e)=>{switch(typeof e){case"string":kt(t,119),Mi(t,e);break;case"number":z9(e)&&Ah(e)<=2147483647?(kt(t,125),yu(t,e)):(t=>(bx.setFloat32(0,t),bx.getFloat32(0)===t))(e)?(kt(t,124),((t,e)=>{xh(t,4).setFloat32(0,e,!1)})(t,e)):(kt(t,123),((t,e)=>{xh(t,8).setFloat64(0,e,!1)})(t,e));break;case"bigint":kt(t,122),((t,e)=>{xh(t,8).setBigInt64(0,e,!1)})(t,e);break;case"object":if(null===e)kt(t,126);else if(e instanceof Array){kt(t,117),he(t,e.length);for(let n=0;n<e.length;n++)wl(t,e[n])}else if(e instanceof Uint8Array)kt(t,116),xt(t,e);else{kt(t,118);const n=Object.keys(e);he(t,n.length);for(let r=0;r<n.length;r++){const i=n[r];Mi(t,i),wl(t,e[i])}}break;case"boolean":kt(t,e?120:121);break;default:kt(t,127)}};class _x extends vl{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&he(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const Nh=t=>{t.count>0&&(yu(t.encoder,1===t.count?t.s:-t.s),t.count>1&&he(t.encoder,t.count-2))};class Oh{constructor(){this.encoder=new vl,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Nh(this),this.count=1,this.s=e)}toUint8Array(){return Nh(this),_t(this.encoder)}}const Cx=t=>{t.count>0&&(yu(t.encoder,2*t.diff+(1===t.count?0:1)),t.count>1&&he(t.encoder,t.count-2))};class Qw{constructor(){this.encoder=new vl,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Cx(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Cx(this),_t(this.encoder)}}class e7{constructor(){this.sarr=[],this.s="",this.lensE=new Oh}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new vl;return this.sarr.push(this.s),this.s="",Mi(e,this.sarr.join("")),vu(e,this.lensE.toUint8Array()),_t(e)}}const zs=t=>new Error(t),Xr=()=>{throw zs("Method unimplemented")},Sr=()=>{throw zs("Unexpected case")},Dx=zs("Unexpected end of array"),Sx=zs("Integer out of Range");class Rh{constructor(e){this.arr=e,this.pos=0}}const ei=t=>new Rh(t),Qt=t=>((t,e)=>{const n=Ww(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n})(t,Ee(t)),jo=t=>t.arr[t.pos++],Ee=t=>{let e=0,n=1;const r=t.arr.length;for(;t.pos<r;){const i=t.arr[t.pos++];if(e+=(127&i)*n,n*=128,i<cr)return e;if(e>wx)throw Sx}throw Dx},$o=t=>{let e=t.arr[t.pos++],n=63&e,r=64;const i=(64&e)>0?-1:1;if(0==(e&cr))return i*n;const s=t.arr.length;for(;t.pos<s;){if(e=t.arr[t.pos++],n+=(127&e)*r,r*=128,e<cr)return i*n;if(n>wx)throw Sx}throw Dx},Ti=yl?t=>yl.decode(Qt(t)):t=>{let e=Ee(t);if(0===e)return"";{let n=String.fromCodePoint(jo(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(jo(t));else for(;e>0;){const r=e<1e4?e:1e4,i=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(n))}},Fh=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},i7=[t=>{},t=>null,$o,t=>Fh(t,4).getFloat32(0,!1),t=>Fh(t,8).getFloat64(0,!1),t=>Fh(t,8).getBigInt64(0,!1),t=>!1,t=>!0,Ti,t=>{const e=Ee(t),n={};for(let r=0;r<e;r++)n[Ti(t)]=bl(t);return n},t=>{const e=Ee(t),n=[];for(let r=0;r<e;r++)n.push(bl(t));return n},Qt],bl=t=>i7[127-jo(t)](t);class Tx extends Rh{constructor(e,n){super(e),this.reader=n,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),this.count=(t=>t.pos!==t.arr.length)(this)?Ee(this)+1:-1),this.count--,this.s}}class Ph extends Rh{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=$o(this);const e=ix(this.s);this.count=1,e&&(this.s=-this.s,this.count=Ee(this)+2)}return this.count--,this.s}}class Xw extends Rh{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){const e=$o(this),n=1&e;this.diff=Qr(e/2),this.count=1,n&&(this.count=Ee(this)+2)}return this.s+=this.diff,this.count--,this.s}}class s7{constructor(e){this.decoder=new Ph(e),this.str=Ti(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),n=this.str.slice(this.spos,e);return this.spos=e,n}}typeof window>"u"||typeof window.performance<"u"&&window;const Ax=typeof crypto>"u"?null:crypto,o7=null!==Ax?t=>{const e=new ArrayBuffer(t),n=new Uint8Array(e);return Ax.getRandomValues(n),e}:t=>{const e=new ArrayBuffer(t),n=new Uint8Array(e);for(let r=0;r<t;r++)n[r]=Math.ceil(4294967295*Math.random()>>>0);return e},Ix=Math.random,kx=()=>new Uint32Array(o7(4))[0],l7=[1e7]+-1e3+-4e3+-8e3+-1e11,xx=()=>l7.replace(/[018]/g,t=>(t^kx()&15>>t/4).toString(16)),tb=t=>Promise.resolve(t),rs=Symbol;class Nx{constructor(e,n){this.left=e,this.right=n}}const is=(t,e)=>new Nx(t,e),Er=typeof document<"u"?document:{},y7=(typeof DOMParser<"u"&&new DOMParser,t=>((t,e)=>{const n=[];for(const[r,i]of t)n.push(e(i,r));return n})(t,(e,n)=>`${n}:${e};`).join("")),Ai=Date.now,Jn=rs(),Gs=rs(),nb=rs(),Lh=rs(),rb=rs(),Vh=rs(),ib=rs(),wu=rs(),bu=rs(),Lx={[Jn]:is("font-weight","bold"),[Gs]:is("font-weight","normal"),[nb]:is("color","blue"),[rb]:is("color","green"),[Lh]:is("color","grey"),[Vh]:is("color","red"),[ib]:is("color","purple"),[wu]:is("color","orange"),[bu]:is("color","black")},Vx={[Jn]:"\x1b[1m",[Gs]:"\x1b[2m",[nb]:"\x1b[34m",[rb]:"\x1b[32m",[Lh]:"\x1b[37m",[Vh]:"\x1b[31m",[ib]:"\x1b[35m",[wu]:"\x1b[38;5;208m",[bu]:"\x1b[0m"},Bh=D9?Bo?t=>{const e=[],n=[];let r=0;for(;r<t.length;r++){const i=t[r],s=Vx[i];if(void 0!==s)e.push(s);else{if(i.constructor!==String&&i.constructor!==Number)break;e.push(i)}}for(r>0&&(e.push("\x1b[0m"),n.push(e.join("")));r<t.length;r++){const i=t[r];i instanceof Symbol||n.push(i)}return n}:t=>{const e=[],n=[],r=Zr();let i=[],s=0;for(;s<t.length;s++){const o=t[s],a=Lx[o];if(void 0!==a)r.set(a.left,a.right);else{if(o.constructor!==String&&o.constructor!==Number)break;{const l=y7(r);s>0||l.length>0?(e.push("%c"+o),n.push(l)):e.push(o)}}}for(s>0&&(i=n,i.unshift(e.join("")));s<t.length;s++){const o=t[s];o instanceof Symbol||i.push(o)}return i}:t=>{const e=[],n=[];let r=0;for(;r<t.length;r++){const i=t[r];if(void 0===Vx[i]){if(i.constructor!==String&&i.constructor!==Number)break;e.push(i)}}for(r>0&&n.push(e.join(""));r<t.length;r++){const i=t[r];i instanceof Symbol||n.push(i.constructor===Object?JSON.stringify(i):i)}return n},Bx=(...t)=>{console.log(...Bh(t)),Ii.forEach(e=>e.print(t))},Ii=new Set,Hx=[rb,ib,wu,nb];let sb=0,zx=Ai();const Gx=t=>({[Symbol.iterator](){return this},next:t}),ob=(t,e)=>Gx(()=>{const{done:n,value:r}=t.next();return{done:n,value:n?void 0:e(r)}});class ab{constructor(e,n){this.clock=e,this.len=n}}class _l{constructor(){this.clients=new Map}}const ss=(t,e,n)=>e.clients.forEach((r,i)=>{const s=t.doc.store.clients.get(i);for(let o=0;o<r.length;o++){const a=r[o];cN(t,s,a.clock,a.len,n)}}),Cl=(t,e)=>{const n=t.clients.get(e.client);return void 0!==n&&null!==((t,e)=>{let n=0,r=t.length-1;for(;n<=r;){const i=Qr((n+r)/2),s=t[i],o=s.clock;if(o<=e){if(e<o+s.len)return i;n=i+1}else r=i-1}return null})(n,e.clock)},lb=t=>{t.clients.forEach(e=>{let n,r;for(e.sort((i,s)=>i.clock-s.clock),n=1,r=1;n<e.length;n++){const i=e[r-1],s=e[n];i.clock+i.len>=s.clock?i.len=ts(i.len,s.clock+s.len-i.clock):(r<n&&(e[r]=s),r++)}e.length=r})},_u=t=>{const e=new _l;for(let n=0;n<t.length;n++)t[n].clients.forEach((r,i)=>{if(!e.clients.has(i)){const s=r.slice();for(let o=n+1;o<t.length;o++)o9(s,t[o].clients.get(i)||[]);e.clients.set(i,s)}});return lb(e),e},Cu=(t,e,n,r)=>{lr(t.clients,e,()=>[]).push(new ab(n,r))},Uh=()=>new _l,Wx=t=>{const e=Uh();return t.clients.forEach((n,r)=>{const i=[];for(let s=0;s<n.length;s++){const o=n[s];if(o.deleted){const a=o.id.clock;let l=o.length;if(s+1<n.length)for(let c=n[s+1];s+1<n.length&&c.deleted;c=n[1+ ++s])l+=c.length;i.push(new ab(a,l))}}i.length>0&&e.clients.set(r,i)}),e},ki=(t,e)=>{he(t.restEncoder,e.clients.size),e.clients.forEach((n,r)=>{t.resetDsCurVal(),he(t.restEncoder,r);const i=n.length;he(t.restEncoder,i);for(let s=0;s<i;s++){const o=n[s];t.writeDsClock(o.clock),t.writeDsLen(o.len)}})},Ws=t=>{const e=new _l,n=Ee(t.restDecoder);for(let r=0;r<n;r++){t.resetDsCurVal();const i=Ee(t.restDecoder),s=Ee(t.restDecoder);if(s>0){const o=lr(e.clients,i,()=>[]);for(let a=0;a<s;a++)o.push(new ab(t.readDsClock(),t.readDsLen()))}}return e},qx=(t,e,n)=>{const r=new _l,i=Ee(t.restDecoder);for(let s=0;s<i;s++){t.resetDsCurVal();const o=Ee(t.restDecoder),a=Ee(t.restDecoder),l=n.clients.get(o)||[],c=Nt(n,o);for(let u=0;u<a;u++){const d=t.readDsClock(),h=d+t.readDsLen();if(d<c){c<h&&Cu(r,o,c,h-c);let p=ti(l,d),m=l[p];for(!m.deleted&&m.id.clock<d&&(l.splice(p+1,0,rp(e,m,d-m.id.clock)),p++);p<l.length&&(m=l[p++],m.id.clock<h);)m.deleted||(h<m.id.clock+m.length&&l.splice(p,0,rp(e,m,h-m.id.clock)),m.delete(e))}else Cu(r,o,d,h-d)}}if(r.clients.size>0){const s=new ls;return he(s.restEncoder,0),ki(s,r),s.toUint8Array()}return null},Kx=kx;class Ho extends du{constructor({guid:e=xx(),collectionid:n=null,gc:r=!0,gcFilter:i=(()=>!0),meta:s=null,autoLoad:o=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=Kx(),this.guid=e,this.collectionid=n,this.share=new Map,this.store=new oN,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=o,this.meta=s,this.isLoaded=!1,this.whenLoaded=(t=>new Promise(t))(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})})}load(){const e=this._item;null!==e&&!this.shouldLoad&&ft(e.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Array.from(this.subdocs).map(e=>e.guid))}transact(e,n=null){ft(this,e,n)}get(e,n=on){const r=lr(this.share,e,()=>{const s=new n;return s._integrate(this,null),s}),i=r.constructor;if(n!==on&&i!==n){if(i===on){const s=new n;s._map=r._map,r._map.forEach(o=>{for(;null!==o;o=o.left)o.parent=s}),s._start=r._start;for(let o=s._start;null!==o;o=o.right)o.parent=s;return s._length=r._length,this.share.set(e,s),s._integrate(this,null),s}throw new Error(`Type with the name ${e} has already been defined with a different constructor`)}return r}getArray(e=""){return this.get(e,Ks)}getText(e=""){return this.get(e,qo)}getMap(e=""){return this.get(e,Wo)}getXmlFragment(e=""){return this.get(e,Ko)}toJSON(){const e={};return this.share.forEach((n,r)=>{e[r]=n.toJSON()}),e}destroy(){nx(this.subdocs).forEach(n=>n.destroy());const e=this._item;if(null!==e){this._item=null;const n=e.content;n.doc=new Ho({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=e,ft(e.parent.doc,r=>{e.deleted||r.subdocsAdded.add(n.doc),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(e,n){super.on(e,n)}off(e,n){super.off(e,n)}}class Du{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Ee(this.restDecoder)}readDsLen(){return Ee(this.restDecoder)}}class as extends Du{readLeftID(){return Ae(Ee(this.restDecoder),Ee(this.restDecoder))}readRightID(){return Ae(Ee(this.restDecoder),Ee(this.restDecoder))}readClient(){return Ee(this.restDecoder)}readInfo(){return jo(this.restDecoder)}readString(){return Ti(this.restDecoder)}readParentInfo(){return 1===Ee(this.restDecoder)}readTypeRef(){return Ee(this.restDecoder)}readLen(){return Ee(this.restDecoder)}readAny(){return bl(this.restDecoder)}readBuf(){return(t=>{const e=hx(t.byteLength);return e.set(t),e})(Qt(this.restDecoder))}readJSON(){return JSON.parse(Ti(this.restDecoder))}readKey(){return Ti(this.restDecoder)}}class Jx{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Ee(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Ee(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class xi extends Jx{constructor(e){super(e),this.keys=[],Ee(e),this.keyClockDecoder=new Xw(Qt(e)),this.clientDecoder=new Ph(Qt(e)),this.leftClockDecoder=new Xw(Qt(e)),this.rightClockDecoder=new Xw(Qt(e)),this.infoDecoder=new Tx(Qt(e),jo),this.stringDecoder=new s7(Qt(e)),this.parentInfoDecoder=new Tx(Qt(e),jo),this.typeRefDecoder=new Ph(Qt(e)),this.lenDecoder=new Ph(Qt(e))}readLeftID(){return new El(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new El(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return bl(this.restDecoder)}readBuf(){return Qt(this.restDecoder)}readJSON(){return bl(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class Dl{constructor(){this.restEncoder=Zt()}toUint8Array(){return _t(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){he(this.restEncoder,e)}writeDsLen(e){he(this.restEncoder,e)}}class Sl extends Dl{writeLeftID(e){he(this.restEncoder,e.client),he(this.restEncoder,e.clock)}writeRightID(e){he(this.restEncoder,e.client),he(this.restEncoder,e.clock)}writeClient(e){he(this.restEncoder,e)}writeInfo(e){mu(this.restEncoder,e)}writeString(e){Mi(this.restEncoder,e)}writeParentInfo(e){he(this.restEncoder,e?1:0)}writeTypeRef(e){he(this.restEncoder,e)}writeLen(e){he(this.restEncoder,e)}writeAny(e){wl(this.restEncoder,e)}writeBuf(e){xt(this.restEncoder,e)}writeJSON(e){Mi(this.restEncoder,JSON.stringify(e))}writeKey(e){Mi(this.restEncoder,e)}}class jh{constructor(){this.restEncoder=Zt(),this.dsCurrVal=0}toUint8Array(){return _t(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const n=e-this.dsCurrVal;this.dsCurrVal=e,he(this.restEncoder,n)}writeDsLen(e){0===e&&Sr(),he(this.restEncoder,e-1),this.dsCurrVal+=e}}class ls extends jh{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Qw,this.clientEncoder=new Oh,this.leftClockEncoder=new Qw,this.rightClockEncoder=new Qw,this.infoEncoder=new _x(mu),this.stringEncoder=new e7,this.parentInfoEncoder=new _x(mu),this.typeRefEncoder=new Oh,this.lenEncoder=new Oh}toUint8Array(){const e=Zt();return he(e,0),xt(e,this.keyClockEncoder.toUint8Array()),xt(e,this.clientEncoder.toUint8Array()),xt(e,this.leftClockEncoder.toUint8Array()),xt(e,this.rightClockEncoder.toUint8Array()),xt(e,_t(this.infoEncoder)),xt(e,this.stringEncoder.toUint8Array()),xt(e,_t(this.parentInfoEncoder)),xt(e,this.typeRefEncoder.toUint8Array()),xt(e,this.lenEncoder.toUint8Array()),vu(e,_t(this.restEncoder)),_t(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){wl(this.restEncoder,e)}writeBuf(e){xt(this.restEncoder,e)}writeJSON(e){wl(this.restEncoder,e)}writeKey(e){const n=this.keyMap.get(e);void 0===n?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(n)}}const cb=(t,e,n)=>{const r=new Map;n.forEach((i,s)=>{Nt(e,s)>i&&r.set(s,i)}),Tu(e).forEach((i,s)=>{n.has(s)||r.set(s,0)}),he(t.restEncoder,r.size),Array.from(r.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{((t,e,n,r)=>{r=ts(r,e[0].id.clock);const i=ti(e,r);he(t.restEncoder,e.length-i),t.writeClient(n),he(t.restEncoder,r);const s=e[i];s.write(t,r-s.id.clock);for(let o=i+1;o<e.length;o++)e[o].write(t,0)})(t,e.clients.get(i),i,s)})},ub=(t,e,n,r=xi)=>{const i=ei(e);((t,e,n,r=new xi(t))=>{ft(e,i=>{i.local=!1;let s=!1;const o=i.doc,a=o.store,l=((t,e)=>{const n=Zr(),r=Ee(t.restDecoder);for(let i=0;i<r;i++){const s=Ee(t.restDecoder),o=new Array(s),a=t.readClient();let l=Ee(t.restDecoder);n.set(a,{i:0,refs:o});for(let c=0;c<s;c++){const u=t.readInfo();switch(31&u){case 0:{const d=t.readLen();o[c]=new Mr(Ae(a,l),d),l+=d;break}case 10:{const d=Ee(t.restDecoder);o[c]=new dr(Ae(a,l),d),l+=d;break}default:{const d=0==(192&u),h=new it(Ae(a,l),null,(u&cr)===cr?t.readLeftID():null,null,64==(64&u)?t.readRightID():null,d?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,d&&32==(32&u)?t.readString():null,jN(t,u));o[c]=h,l+=h.length}}}}return n})(r,o),c=((t,e,n)=>{const r=[];let i=Array.from(n.keys()).sort((p,m)=>p-m);if(0===i.length)return null;const s=()=>{if(0===i.length)return null;let p=n.get(i[i.length-1]);for(;p.refs.length===p.i;){if(i.pop(),!(i.length>0))return null;p=n.get(i[i.length-1])}return p};let o=s();if(null===o&&0===r.length)return null;const a=new oN,l=new Map,c=(p,m)=>{const v=l.get(p);(null==v||v>m)&&l.set(p,m)};let u=o.refs[o.i++];const d=new Map,h=()=>{for(const p of r){const m=p.id.client,v=n.get(m);v?(v.i--,a.clients.set(m,v.refs.slice(v.i)),n.delete(m),v.i=0,v.refs=[]):a.clients.set(m,[p]),i=i.filter(w=>w!==m)}r.length=0};for(;;){if(u.constructor!==dr){const m=lr(d,u.id.client,()=>Nt(e,u.id.client))-u.id.clock;if(m<0)r.push(u),c(u.id.client,u.id.clock-1),h();else{const v=u.getMissing(t,e);if(null!==v){r.push(u);const w=n.get(v)||{refs:[],i:0};if(w.refs.length!==w.i){u=w.refs[w.i++];continue}c(v,Nt(e,v)),h()}else(0===m||m<u.length)&&(u.integrate(t,m),d.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(null!==o&&o.i<o.refs.length)u=o.refs[o.i++];else{if(o=s(),null===o)break;u=o.refs[o.i++]}}if(a.clients.size>0){const p=new ls;return cb(p,a,new Map),he(p.restEncoder,0),{missing:l,update:p.toUint8Array()}}return null})(i,a,l),u=a.pendingStructs;if(u){for(const[h,p]of u.missing)if(p<Nt(a,h)){s=!0;break}if(c){for(const[h,p]of c.missing){const m=u.missing.get(h);(null==m||m>p)&&u.missing.set(h,p)}u.update=qh([u.update,c.update])}}else a.pendingStructs=c;const d=qx(r,i,a);if(a.pendingDs){const h=new xi(ei(a.pendingDs));Ee(h.restDecoder);const p=qx(h,i,a);a.pendingDs=d&&p?qh([d,p]):d||p}else a.pendingDs=d;if(s){const h=a.pendingStructs.update;a.pendingStructs=null,ub(i.doc,h)}},n,!1)})(i,t,n,new r(i))},Qx=t=>(t=>{const e=new Map,n=Ee(t.restDecoder);for(let r=0;r<n;r++){const i=Ee(t.restDecoder),s=Ee(t.restDecoder);e.set(i,s)}return e})(new Du(ei(t))),db=(t,e)=>(he(t.restEncoder,e.size),Array.from(e.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{he(t.restEncoder,n),he(t.restEncoder,r)}),t);class O7{constructor(){this.l=[]}}const Xx=()=>new O7,eN=(t,e)=>t.l.push(e),tN=(t,e)=>{const n=t.l,r=n.length;t.l=n.filter(i=>e!==i),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},nN=(t,e,n)=>$w(t.l,[e,n]);class El{constructor(e,n){this.client=e,this.clock=n}}const Ml=(t,e)=>t===e||null!==t&&null!==e&&t.client===e.client&&t.clock===e.clock,Ae=(t,e)=>new El(t,e),Su=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw Sr()},Eu=(t,e)=>{for(;null!==e;){if(e.parent===t)return!0;e=e.parent._item}return!1};class Tl{constructor(e,n,r,i=0){this.type=e,this.tname=n,this.item=r,this.assoc=i}}const Mu=t=>new Tl(null==t.type?null:Ae(t.type.client,t.type.clock),t.tname||null,null==t.item?null:Ae(t.item.client,t.item.clock),t.assoc??0);class R7{constructor(e,n,r=0){this.type=e,this.index=n,this.assoc=r}}const $h=(t,e,n)=>{let r=null,i=null;return null===t._item?i=Su(t):r=Ae(t._item.id.client,t._item.id.clock),new Tl(r,i,e,n)},fb=(t,e,n=0)=>{let r=t._start;if(n<0){if(0===e)return $h(t,null,n);e--}for(;null!==r;){if(!r.deleted&&r.countable){if(r.length>e)return $h(t,Ae(r.id.client,r.id.clock+e),n);e-=r.length}if(null===r.right&&n<0)return $h(t,r.lastId,n);r=r.right}return $h(t,null,n)},sN=(t,e)=>t===e||null!==t&&null!==e&&t.tname===e.tname&&Ml(t.item,e.item)&&Ml(t.type,e.type)&&t.assoc===e.assoc;class Hh{constructor(e,n){this.ds=e,this.sv=n}}const hb=(t,e)=>new Hh(t,e),zo=(hb(Uh(),new Map),(t,e)=>void 0===e?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!Cl(e.ds,t.id)),zh=(t,e)=>{const n=lr(t.meta,zh,ml),r=t.doc.store;n.has(e)||(e.sv.forEach((i,s)=>{i<Nt(r,s)&&Rn(t,Ae(s,i))}),ss(t,e.ds,i=>{}),n.add(e))};class oN{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Tu=t=>{const e=new Map;return t.clients.forEach((n,r)=>{const i=n[n.length-1];e.set(r,i.id.clock+i.length)}),e},Nt=(t,e)=>{const n=t.clients.get(e);if(void 0===n)return 0;const r=n[n.length-1];return r.id.clock+r.length},aN=(t,e)=>{let n=t.clients.get(e.id.client);if(void 0===n)n=[],t.clients.set(e.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==e.id.clock)throw Sr()}n.push(e)},ti=(t,e)=>{let n=0,r=t.length-1,i=t[r],s=i.id.clock;if(s===e)return r;let o=Qr(e/(s+i.length-1)*r);for(;n<=r;){if(i=t[o],s=i.id.clock,s<=e){if(e<s+i.length)return o;n=o+1}else r=o-1;o=Qr((n+r)/2)}throw Sr()},Gh=(t,e)=>{const n=t.clients.get(e.client);return n[ti(n,e.clock)]},pb=(t,e,n)=>{const r=ti(e,n),i=e[r];return i.id.clock<n&&i instanceof it?(e.splice(r+1,0,rp(t,i,n-i.id.clock)),r+1):r},Rn=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[pb(t,n,e.clock)]},lN=(t,e,n)=>{const r=e.clients.get(n.client),i=ti(r,n.clock),s=r[i];return n.clock!==s.id.clock+s.length-1&&s.constructor!==Mr&&r.splice(i+1,0,rp(t,s,n.clock-s.id.clock+1)),s},cN=(t,e,n,r,i)=>{if(0===r)return;const s=n+r;let a,o=pb(t,e,n);do{a=e[o++],s<a.id.clock+a.length&&pb(t,e,s),i(a)}while(o<e.length&&e[o].id.clock<s)};class H7{constructor(e,n,r){this.doc=e,this.deleteSet=new _l,this.beforeState=Tu(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set}}const uN=(t,e)=>!(0===e.deleteSet.clients.size&&!((t,e)=>{for(const[n,r]of t)if(e(r,n))return!0;return!1})(e.afterState,(n,r)=>e.beforeState.get(r)!==n)||(lb(e.deleteSet),((t,e)=>{cb(t,e.doc.store,e.beforeState)})(t,e),ki(t,e.deleteSet),0)),dN=(t,e,n)=>{const r=e._item;(null===r||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&lr(t.changed,e,ml).add(n)},Wh=(t,e)=>{const n=t[e-1],r=t[e];n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)&&(t.splice(e,1),r instanceof it&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n))},pN=(t,e)=>{if(e<t.length){const n=t[e],r=n.doc,i=r.store,s=n.deleteSet,o=n._mergeStructs;try{lb(s),n.afterState=Tu(n.doc.store),r._transaction=null,r.emit("beforeObserverCalls",[n,r]);const a=[];n.changed.forEach((l,c)=>a.push(()=>{(null===c._item||!c._item.deleted)&&c._callObserver(n,l)})),a.push(()=>{n.changedParentTypes.forEach((l,c)=>a.push(()=>{(null===c._item||!c._item.deleted)&&((l=l.filter(u=>null===u.target._item||!u.target._item.deleted)).forEach(u=>{u.currentTarget=c}),l.sort((u,d)=>u.path.length-d.path.length),nN(c._dEH,l,n))})),a.push(()=>r.emit("afterTransaction",[n,r]))}),$w(a,[])}finally{r.gc&&((t,e,n)=>{for(const[r,i]of t.clients.entries()){const s=e.clients.get(r);for(let o=i.length-1;o>=0;o--){const a=i[o],l=a.clock+a.len;for(let c=ti(s,a.clock),u=s[c];c<s.length&&u.id.clock<l;u=s[++c]){const d=s[c];if(a.clock+a.len<=d.id.clock)break;d instanceof it&&d.deleted&&!d.keep&&n(d)&&d.gc(e,!1)}}}})(s,i,r.gcFilter),((t,e)=>{t.clients.forEach((n,r)=>{const i=e.clients.get(r);for(let s=n.length-1;s>=0;s--){const o=n[s];for(let l=Hs(i.length-1,1+ti(i,o.clock+o.len-1)),c=i[l];l>0&&c.id.clock>=o.clock;c=i[--l])Wh(i,l)}})})(s,i),n.afterState.forEach((u,d)=>{const h=n.beforeState.get(d)||0;if(h!==u){const p=i.clients.get(d),m=ts(ti(p,h),1);for(let v=p.length-1;v>=m;v--)Wh(p,v)}});for(let u=0;u<o.length;u++){const{client:d,clock:h}=o[u].id,p=i.clients.get(d),m=ti(p,h);m+1<p.length&&Wh(p,m+1),m>0&&Wh(p,m)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(Bx(wu,Jn,"[yjs] ",Gs,Vh,"Changed the client-id because another client seems to be using it."),r.clientID=Kx()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const u=new Sl;uN(u,n)&&r.emit("update",[u.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const u=new ls;uN(u,n)&&r.emit("updateV2",[u.toUint8Array(),n.origin,r,n])}const{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:c}=n;(a.size>0||c.size>0||l.size>0)&&(a.forEach(u=>{u.clientID=r.clientID,null==u.collectionid&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),c.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:l,added:a,removed:c},r,n]),c.forEach(u=>u.destroy())),t.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,t])):pN(t,e+1)}}},ft=(t,e,n=null,r=!0)=>{const i=t._transactionCleanups;let s=!1;null===t._transaction&&(s=!0,t._transaction=new H7(t,n,r),i.push(t._transaction),1===i.length&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{e(t._transaction)}finally{s&&i[0]===t._transaction&&pN(i,0)}};class z7{constructor(e,n){this.insertions=n,this.deletions=e,this.meta=new Map}}const gN=(t,e,n)=>{ss(t,n.deletions,r=>{r instanceof it&&e.scope.some(i=>Eu(i,r))&&Eb(r,!1)})},mN=(t,e,n)=>{let r=null,i=null;const s=t.doc,o=t.scope;return ft(s,a=>{for(;e.length>0&&null===r;){const l=s.store,c=e.pop(),u=new Set,d=[];let h=!1;ss(a,c.insertions,p=>{if(p instanceof it){if(null!==p.redone){let{item:m,diff:v}=Sb(l,p.id);v>0&&(m=Rn(a,Ae(m.id.client,m.id.clock+v))),p=m}!p.deleted&&o.some(m=>Eu(m,p))&&d.push(p)}}),ss(a,c.deletions,p=>{p instanceof it&&o.some(m=>Eu(m,p))&&!Cl(c.insertions,p.id)&&u.add(p)}),u.forEach(p=>{h=null!==UN(a,p,u,c.insertions,t.ignoreRemoteMapChanges)||h});for(let p=d.length-1;p>=0;p--){const m=d[p];t.deleteFilter(m)&&(m.delete(a),h=!0)}r=h?c:null}a.changed.forEach((l,c)=>{l.has(null)&&c._searchMarker&&(c._searchMarker.length=0)}),i=a},t),null!=r&&t.emit("stack-item-popped",[{stackItem:r,type:n,changedParentTypes:i.changedParentTypes},t]),r};class G7 extends du{constructor(e,{captureTimeout:n=500,captureTransaction:r=(l=>!0),deleteFilter:i=(()=>!0),trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:o=!1,doc:a=(rx(e)?e[0].doc:e.doc)}={}){super(),this.scope=[],this.addToScope(e),this.deleteFilter=i,s.add(this),this.trackedOrigins=s,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.doc=a,this.lastChange=0,this.ignoreRemoteMapChanges=o,this.captureTimeout=n,this.afterTransactionHandler=l=>{if(!(this.captureTransaction(l)&&this.scope.some(w=>l.changedParentTypes.has(w))&&(this.trackedOrigins.has(l.origin)||l.origin&&this.trackedOrigins.has(l.origin.constructor))))return;const c=this.undoing,u=this.redoing,d=c?this.redoStack:this.undoStack;c?this.stopCapturing():u||this.clear(!1,!0);const h=new _l;l.afterState.forEach((w,k)=>{const z=l.beforeState.get(k)||0,B=w-z;B>0&&Cu(h,k,z,B)});const p=Ai();let m=!1;if(this.lastChange>0&&p-this.lastChange<this.captureTimeout&&d.length>0&&!c&&!u){const w=d[d.length-1];w.deletions=_u([w.deletions,l.deleteSet]),w.insertions=_u([w.insertions,h])}else d.push(new z7(l.deleteSet,h)),m=!0;!c&&!u&&(this.lastChange=p),ss(l,l.deleteSet,w=>{w instanceof it&&this.scope.some(k=>Eu(k,w))&&Eb(w,!0)});this.emit(m?"stack-item-added":"stack-item-updated",[{stackItem:d[d.length-1],origin:l.origin,type:c?"redo":"undo",changedParentTypes:l.changedParentTypes},this])},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){(e=rx(e)?e:[e]).forEach(n=>{this.scope.every(r=>r!==n)&&this.scope.push(n)})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,n=!0){(e&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(r=>{e&&(this.undoStack.forEach(i=>gN(r,this,i)),this.undoStack=[]),n&&(this.redoStack.forEach(i=>gN(r,this,i)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){let e;this.undoing=!0;try{e=mN(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){let e;this.redoing=!0;try{e=mN(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}class Go{constructor(e,n){this.gen=function*W7(t){const e=Ee(t.restDecoder);for(let n=0;n<e;n++){const r=Ee(t.restDecoder),i=t.readClient();let s=Ee(t.restDecoder);for(let o=0;o<r;o++){const a=t.readInfo();if(10===a){const l=Ee(t.restDecoder);yield new dr(Ae(i,s),l),s+=l}else if(0!=(31&a)){const l=0==(192&a),c=new it(Ae(i,s),null,(a&cr)===cr?t.readLeftID():null,null,64==(64&a)?t.readRightID():null,l?t.readParentInfo()?t.readString():t.readLeftID():null,l&&32==(32&a)?t.readString():null,jN(t,a));yield c,s+=c.length}else{const l=t.readLen();yield new Mr(Ae(i,s),l),s+=l}}}}(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===dr);return this.curr}}class gb{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const J7=t=>qh(t,as,Sl),Q7=(t,e)=>{if(t.constructor===Mr){const{client:n,clock:r}=t.id;return new Mr(Ae(n,r+e),t.length-e)}if(t.constructor===dr){const{client:n,clock:r}=t.id;return new dr(Ae(n,r+e),t.length-e)}{const n=t,{client:r,clock:i}=n.id;return new it(Ae(r,i+e),null,Ae(r,i+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},qh=(t,e=xi,n=ls)=>{if(1===t.length)return t[0];const r=t.map(u=>new e(ei(u)));let i=r.map(u=>new Go(u,!0)),s=null;const o=new n,a=new gb(o);for(;i=i.filter(h=>null!==h.curr),i.sort((h,p)=>{if(h.curr.id.client===p.curr.id.client){const m=h.curr.id.clock-p.curr.id.clock;return 0===m?h.curr.constructor===p.curr.constructor?0:h.curr.constructor===dr?1:-1:m}return p.curr.id.client-h.curr.id.client}),0!==i.length;){const u=i[0],d=u.curr.id.client;if(null!==s){let h=u.curr,p=!1;for(;null!==h&&h.id.clock+h.length<=s.struct.id.clock+s.struct.length&&h.id.client>=s.struct.id.client;)h=u.next(),p=!0;if(null===h||h.id.client!==d||p&&h.id.clock>s.struct.id.clock+s.struct.length)continue;if(d!==s.struct.id.client)qs(a,s.struct,s.offset),s={struct:h,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<h.id.clock)if(s.struct.constructor===dr)s.struct.length=h.id.clock+h.length-s.struct.id.clock;else{qs(a,s.struct,s.offset);const m=h.id.clock-s.struct.id.clock-s.struct.length;s={struct:new dr(Ae(d,s.struct.id.clock+s.struct.length),m),offset:0}}else{const m=s.struct.id.clock+s.struct.length-h.id.clock;m>0&&(s.struct.constructor===dr?s.struct.length-=m:h=Q7(h,m)),s.struct.mergeWith(h)||(qs(a,s.struct,s.offset),s={struct:h,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let h=u.curr;null!==h&&h.id.client===d&&h.id.clock===s.struct.id.clock+s.struct.length&&h.constructor!==dr;h=u.next())qs(a,s.struct,s.offset),s={struct:h,offset:0}}null!==s&&(qs(a,s.struct,s.offset),s=null),mb(a);const l=r.map(u=>Ws(u)),c=_u(l);return ki(o,c),o.toUint8Array()},yN=(t,e,n=xi,r=ls)=>{const i=Qx(e),s=new r,o=new gb(s),a=new n(ei(t)),l=new Go(a,!1);for(;l.curr;){const u=l.curr,d=u.id.client,h=i.get(d)||0;if(l.curr.constructor!==dr)if(u.id.clock+u.length>h)for(qs(o,u,ts(h-u.id.clock,0)),l.next();l.curr&&l.curr.id.client===d;)qs(o,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===d&&l.curr.id.clock+l.curr.length<=h;)l.next();else l.next()}mb(o);const c=Ws(a);return ki(s,c),s.toUint8Array()},vN=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:_t(t.encoder.restEncoder)}),t.encoder.restEncoder=Zt(),t.written=0)},qs=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&vN(t),0===t.written&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),he(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},mb=t=>{vN(t);const e=t.encoder.restEncoder;he(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const r=t.clientStructs[n];he(e,r.written),vu(e,r.restEncoder)}},X7=t=>((t,e,n)=>{const r=new e(ei(t)),i=new Go(r,!1),s=new n,o=new gb(s);for(let l=i.curr;null!==l;l=i.next())qs(o,l,0);mb(o);const a=Ws(r);return ki(s,a),s.toUint8Array()})(t,xi,Sl);class Kh{constructor(e,n){this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null}get path(){return eK(this.currentTarget,this.target)}deletes(e){return Cl(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){const e=new Map,n=this.target;this.transaction.changed.get(n).forEach(i=>{if(null!==i){const s=n._map.get(i);let o,a;if(this.adds(s)){let l=s.left;for(;null!==l&&this.adds(l);)l=l.left;if(this.deletes(s)){if(null===l||!this.deletes(l))return;o="delete",a=Uw(l.content.getContent())}else null!==l&&this.deletes(l)?(o="update",a=Uw(l.content.getContent())):(o="add",a=void 0)}else{if(!this.deletes(s))return;o="delete",a=Uw(s.content.getContent())}e.set(i,{action:o,oldValue:a})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){const n=this.target,r=ml(),i=ml(),s=[];if(e={added:r,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let a=null;const l=()=>{a&&s.push(a)};for(let c=n._start;null!==c;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((null===a||void 0===a.delete)&&(l(),a={delete:0}),a.delete+=c.length,i.add(c)):this.adds(c)?((null===a||void 0===a.insert)&&(l(),a={insert:[]}),a.insert=a.insert.concat(c.content.getContent()),r.add(c)):((null===a||void 0===a.retain)&&(l(),a={retain:0}),a.retain+=c.length);null!==a&&void 0===a.retain&&l()}this._changes=e}return e}}const eK=(t,e)=>{const n=[];for(;null!==e._item&&e!==t;){if(null!==e._item.parentSub)n.unshift(e._item.parentSub);else{let r=0,i=e._item.parent._start;for(;i!==e._item&&null!==i;)i.deleted||r++,i=i.right;n.unshift(r)}e=e._item.parent}return n};let yb=0;class tK{constructor(e,n){e.marker=!0,this.p=e,this.index=n,this.timestamp=yb++}}const _N=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=yb++},Jh=(t,e)=>{if(null===t._start||0===e||null===t._searchMarker)return null;const n=0===t._searchMarker.length?null:t._searchMarker.reduce((s,o)=>Ah(e-s.index)<Ah(e-o.index)?s:o);let r=t._start,i=0;for(null!==n&&(r=n.p,i=n.index,(t=>{t.timestamp=yb++})(n));null!==r.right&&i<e;){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}for(;null!==r.left&&i>e;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return null!==n&&Ah(n.index-i)<r.parent.length/80?(_N(n,r,i),n):((t,e,n)=>{if(t.length>=80){const r=t.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return _N(r,e,n),r}{const r=new tK(e,n);return t.push(r),r}})(t._searchMarker,r,i)},Au=(t,e,n)=>{for(let r=t.length-1;r>=0;r--){const i=t[r];if(n>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(null===s||!0===s.marker){t.splice(r,1);continue}i.p=s,s.marker=!0}(e<i.index||n>0&&e===i.index)&&(i.index=ts(e,i.index+n))}},Yh=(t,e,n)=>{const r=t,i=e.changedParentTypes;for(;lr(i,t,()=>[]).push(n),null!==t._item;)t=t._item.parent;nN(r._eH,n,e)};class on{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Xx(),this._dEH=Xx(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,n){this.doc=e,this._item=n}_copy(){throw Xr()}clone(){throw Xr()}_write(e){}get _first(){let e=this._start;for(;null!==e&&e.deleted;)e=e.right;return e}_callObserver(e,n){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){eN(this._eH,e)}observeDeep(e){eN(this._dEH,e)}unobserve(e){tN(this._eH,e)}unobserveDeep(e){tN(this._dEH,e)}toJSON(){}}const CN=(t,e,n)=>{e<0&&(e=t._length+e),n<0&&(n=t._length+n);let r=n-e;const i=[];let s=t._start;for(;null!==s&&r>0;){if(s.countable&&!s.deleted){const o=s.content.getContent();if(o.length<=e)e-=o.length;else{for(let a=e;a<o.length&&r>0;a++)i.push(o[a]),r--;e=0}}s=s.right}return i},DN=t=>{const e=[];let n=t._start;for(;null!==n;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let i=0;i<r.length;i++)e.push(r[i])}n=n.right}return e},SN=(t,e)=>{const n=[];let r=t._start;for(;null!==r;){if(r.countable&&zo(r,e)){const i=r.content.getContent();for(let s=0;s<i.length;s++)n.push(i[s])}r=r.right}return n},Iu=(t,e)=>{let n=0,r=t._start;for(;null!==r;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let s=0;s<i.length;s++)e(i[s],n++,t)}r=r.right}},EN=(t,e)=>{const n=[];return Iu(t,(r,i)=>{n.push(e(r,i,t))}),n},iK=t=>{let e=t._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(null===n){for(;null!==e&&e.deleted;)e=e.right;if(null===e)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}const i=n[r++];return n.length<=r&&(n=null),{done:!1,value:i}}}},MN=(t,e)=>{const n=Jh(t,e);let r=t._start;for(null!==n&&(r=n.p,e-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},Zh=(t,e,n,r)=>{let i=n;const s=t.doc,o=s.clientID,a=s.store,l=null===n?e._start:n.right;let c=[];const u=()=>{c.length>0&&(i=new it(Ae(o,Nt(a,o)),i,i&&i.lastId,l,l&&l.id,e,null,new Yo(c)),i.integrate(t,0),c=[])};r.forEach(d=>{if(null===d)c.push(d);else switch(d.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(d);break;default:switch(u(),d.constructor){case Uint8Array:case ArrayBuffer:i=new it(Ae(o,Nt(a,o)),i,i&&i.lastId,l,l&&l.id,e,null,new ku(new Uint8Array(d))),i.integrate(t,0);break;case Ho:i=new it(Ae(o,Nt(a,o)),i,i&&i.lastId,l,l&&l.id,e,null,new Nu(d)),i.integrate(t,0);break;default:if(!(d instanceof on))throw new Error("Unexpected content type in insert operation");i=new it(Ae(o,Nt(a,o)),i,i&&i.lastId,l,l&&l.id,e,null,new ri(d)),i.integrate(t,0)}}}),u()},TN=zs("Length exceeded!"),AN=(t,e,n,r)=>{if(n>e._length)throw TN;if(0===n)return e._searchMarker&&Au(e._searchMarker,n,r.length),Zh(t,e,null,r);const i=n,s=Jh(e,n);let o=e._start;for(null!==s&&(o=s.p,0==(n-=s.index)&&(o=o.prev,n+=o&&o.countable&&!o.deleted?o.length:0));null!==o;o=o.right)if(!o.deleted&&o.countable){if(n<=o.length){n<o.length&&Rn(t,Ae(o.id.client,o.id.clock+n));break}n-=o.length}return e._searchMarker&&Au(e._searchMarker,i,r.length),Zh(t,e,o,r)},IN=(t,e,n,r)=>{if(0===r)return;const i=n,s=r,o=Jh(e,n);let a=e._start;for(null!==o&&(a=o.p,n-=o.index);null!==a&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&Rn(t,Ae(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&null!==a;)a.deleted||(r<a.length&&Rn(t,Ae(a.id.client,a.id.clock+r)),a.delete(t),r-=a.length),a=a.right;if(r>0)throw TN;e._searchMarker&&Au(e._searchMarker,i,-s+r)},Qh=(t,e,n)=>{const r=e._map.get(n);void 0!==r&&r.delete(t)},vb=(t,e,n,r)=>{const i=e._map.get(n)||null,s=t.doc,o=s.clientID;let a;if(null==r)a=new Yo([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new Yo([r]);break;case Uint8Array:a=new ku(r);break;case Ho:a=new Nu(r);break;default:if(!(r instanceof on))throw new Error("Unexpected content type");a=new ri(r)}new it(Ae(o,Nt(s.store,o)),i,i&&i.lastId,null,null,e,n,a).integrate(t,0)},wb=(t,e)=>{const n=t._map.get(e);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},kN=t=>{const e={};return t._map.forEach((n,r)=>{n.deleted||(e[r]=n.content.getContent()[n.length-1])}),e},xN=(t,e)=>{const n=t._map.get(e);return void 0!==n&&!n.deleted},Xh=t=>((t,e)=>Gx(()=>{let n;do{n=t.next()}while(!n.done&&!e(n.value));return n}))(t.entries(),e=>!e[1].deleted);class oK extends Kh{constructor(e,n){super(e,n),this._transaction=n}}class Ks extends on{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const n=new Ks;return n.push(e),n}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ks}clone(){const e=new Ks;return e.insert(0,this.toArray().map(n=>n instanceof on?n.clone():n)),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(e,n){super._callObserver(e,n),Yh(this,e,new oK(this,e))}insert(e,n){null!==this.doc?ft(this.doc,r=>{AN(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}push(e){null!==this.doc?ft(this.doc,n=>{((t,e,n)=>{let i=(e._searchMarker||[]).reduce((s,o)=>o.index>s.index?o:s,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;Zh(t,e,i,n)})(n,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,n=1){null!==this.doc?ft(this.doc,r=>{IN(r,this,e,n)}):this._prelimContent.splice(e,n)}get(e){return MN(this,e)}toArray(){return DN(this)}slice(e=0,n=this.length){return CN(this,e,n)}toJSON(){return this.map(e=>e instanceof on?e.toJSON():e)}map(e){return EN(this,e)}forEach(e){Iu(this,e)}[Symbol.iterator](){return iK(this)}_write(e){e.writeTypeRef(IK)}}class lK extends Kh{constructor(e,n,r){super(e,n),this.keysChanged=r}}class Wo extends on{constructor(e){super(),this._prelimContent=null,this._prelimContent=void 0===e?new Map:new Map(e)}_integrate(e,n){super._integrate(e,n),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new Wo}clone(){const e=new Wo;return this.forEach((n,r)=>{e.set(r,n instanceof on?n.clone():n)}),e}_callObserver(e,n){Yh(this,e,new lK(this,e,n))}toJSON(){const e={};return this._map.forEach((n,r)=>{if(!n.deleted){const i=n.content.getContent()[n.length-1];e[r]=i instanceof on?i.toJSON():i}}),e}get size(){return[...Xh(this._map)].length}keys(){return ob(Xh(this._map),e=>e[0])}values(){return ob(Xh(this._map),e=>e[1].content.getContent()[e[1].length-1])}entries(){return ob(Xh(this._map),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this._map.forEach((n,r)=>{n.deleted||e(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?ft(this.doc,n=>{Qh(n,this,e)}):this._prelimContent.delete(e)}set(e,n){return null!==this.doc?ft(this.doc,r=>{vb(r,this,e,n)}):this._prelimContent.set(e,n),n}get(e){return wb(this,e)}has(e){return xN(this,e)}clear(){null!==this.doc?ft(this.doc,e=>{this.forEach(function(n,r,i){Qh(e,i,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(kK)}}const Js=(t,e)=>t===e||"object"==typeof t&&"object"==typeof e&&t&&e&&((t,e)=>t===e||Ih(t)===Ih(e)&&((t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0})(t,(n,r)=>(void 0!==n||dx(e,r))&&e[r]===n))(t,e);class bb{constructor(e,n,r,i){this.left=e,this.right=n,this.index=r,this.currentAttributes=i}forward(){null===this.right&&Sr(),this.right.content.constructor===Ut?this.right.deleted||Al(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}const NN=(t,e,n)=>{for(;null!==e.right&&n>0;)e.right.content.constructor===Ut?e.right.deleted||Al(e.currentAttributes,e.right.content):e.right.deleted||(n<e.right.length&&Rn(t,Ae(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length),e.left=e.right,e.right=e.right.right;return e},ep=(t,e,n)=>{const r=new Map,i=Jh(e,n);if(i){const s=new bb(i.p.left,i.p,i.index,r);return NN(t,s,n-i.index)}{const s=new bb(null,e._start,0,r);return NN(t,s,n)}},ON=(t,e,n,r)=>{for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===Ut&&Js(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const i=t.doc,s=i.clientID;r.forEach((o,a)=>{const l=n.left,c=n.right,u=new it(Ae(s,Nt(i.store,s)),l,l&&l.lastId,c,c&&c.id,e,null,new Ut(a,o));u.integrate(t,0),n.right=u,n.forward()})},Al=(t,e)=>{const{key:n,value:r}=e;null===r?t.delete(n):t.set(n,r)},RN=(t,e)=>{for(;null!==t.right&&(t.right.deleted||t.right.content.constructor===Ut&&Js(e[t.right.content.key]||null,t.right.content.value));)t.forward()},FN=(t,e,n,r)=>{const i=t.doc,s=i.clientID,o=new Map;for(const a in r){const l=r[a],c=n.currentAttributes.get(a)||null;if(!Js(c,l)){o.set(a,c);const{left:u,right:d}=n;n.right=new it(Ae(s,Nt(i.store,s)),u,u&&u.lastId,d,d&&d.id,e,null,new Ut(a,l)),n.right.integrate(t,0),n.forward()}}return o},_b=(t,e,n,r,i)=>{n.currentAttributes.forEach((h,p)=>{void 0===i[p]&&(i[p]=null)});const s=t.doc,o=s.clientID;RN(n,i);const a=FN(t,e,n,i),l=r.constructor===String?new ni(r):r instanceof on?new ri(r):new Jo(r);let{left:c,right:u,index:d}=n;e._searchMarker&&Au(e._searchMarker,n.index,l.getLength()),u=new it(Ae(o,Nt(s.store,o)),c,c&&c.lastId,u,u&&u.id,e,null,l),u.integrate(t,0),n.right=u,n.index=d,n.forward(),ON(t,e,n,a)},PN=(t,e,n,r,i)=>{const s=t.doc,o=s.clientID;RN(n,i);const a=FN(t,e,n,i);e:for(;null!==n.right&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===Ut));){if(!n.right.deleted)switch(n.right.content.constructor){case Ut:{const{key:l,value:c}=n.right.content,u=i[l];if(void 0!==u){if(Js(u,c))a.delete(l);else{if(0===r)break e;a.set(l,c)}n.right.delete(t)}else n.currentAttributes.set(l,c);break}default:r<n.right.length&&Rn(t,Ae(n.right.id.client,n.right.id.clock+r)),r-=n.right.length}n.forward()}if(r>0){let l="";for(;r>0;r--)l+="\n";n.right=new it(Ae(o,Nt(s.store,o)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new ni(l)),n.right.integrate(t,0),n.forward()}ON(t,e,n,a)},LN=(t,e,n,r,i)=>{let s=n;const o=Th(i);for(;s&&(!s.countable||s.deleted);)!s.deleted&&s.content.constructor===Ut&&Al(o,s.content),s=s.right;let a=0,l=!1;for(;e!==s;){if(n===e&&(l=!0),!e.deleted){const c=e.content;switch(c.constructor){case Ut:{const{key:u,value:d}=c;((o.get(u)||null)!==d||(r.get(u)||null)===d)&&(e.delete(t),a++,!l&&(i.get(u)||null)===d&&(r.get(u)||null)!==d&&i.delete(u));break}}}e=e.right}return a},VN=(t,e,n)=>{const r=n,i=Th(e.currentAttributes),s=e.right;for(;n>0&&null!==e.right;){if(!1===e.right.deleted)switch(e.right.content.constructor){case ri:case Jo:case ni:n<e.right.length&&Rn(t,Ae(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t)}e.forward()}s&&LN(t,s,e.right,i,e.currentAttributes);const o=(e.left||e.right).parent;return o._searchMarker&&Au(o._searchMarker,e.index,-r+n),e};class fK extends Kh{constructor(e,n,r){super(e,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{null===i?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){return null===this._changes&&(this._changes={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set}),this._changes}get delta(){if(null===this._delta){const n=[];ft(this.target.doc,r=>{const i=new Map,s=new Map;let o=this.target._start,a=null;const l={};let c="",u=0,d=0;const h=()=>{if(null!==a){let p;switch(a){case"delete":p={delete:d},d=0;break;case"insert":p={insert:c},i.size>0&&(p.attributes={},i.forEach((m,v)=>{null!==m&&(p.attributes[v]=m)})),c="";break;case"retain":if(p={retain:u},Object.keys(l).length>0){p.attributes={};for(const m in l)p.attributes[m]=l[m]}u=0}n.push(p),a=null}};for(;null!==o;){switch(o.content.constructor){case ri:case Jo:this.adds(o)?this.deletes(o)||(h(),a="insert",c=o.content.getContent()[0],h()):this.deletes(o)?("delete"!==a&&(h(),a="delete"),d+=1):o.deleted||("retain"!==a&&(h(),a="retain"),u+=1);break;case ni:this.adds(o)?this.deletes(o)||("insert"!==a&&(h(),a="insert"),c+=o.content.str):this.deletes(o)?("delete"!==a&&(h(),a="delete"),d+=o.length):o.deleted||("retain"!==a&&(h(),a="retain"),u+=o.length);break;case Ut:{const{key:p,value:m}=o.content;if(this.adds(o)){if(!this.deletes(o)){const v=i.get(p)||null;Js(v,m)?null!==m&&o.delete(r):("retain"===a&&h(),Js(m,s.get(p)||null)?delete l[p]:l[p]=m)}}else if(this.deletes(o)){s.set(p,m);const v=i.get(p)||null;Js(v,m)||("retain"===a&&h(),l[p]=v)}else if(!o.deleted){s.set(p,m);const v=l[p];void 0!==v&&(Js(v,m)?null!==v&&o.delete(r):("retain"===a&&h(),null===m?delete l[p]:l[p]=m))}o.deleted||("insert"===a&&h(),Al(i,o.content));break}}o=o.right}for(h();n.length>0;){const p=n[n.length-1];if(void 0===p.retain||void 0!==p.attributes)break;n.pop()}}),this._delta=n}return this._delta}}class qo extends on{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[]}get length(){return this._length}_integrate(e,n){super._integrate(e,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new qo}clone(){const e=new qo;return e.applyDelta(this.toDelta()),e}_callObserver(e,n){super._callObserver(e,n);const r=new fK(this,e,n),i=e.doc;if(Yh(this,e,r),!e.local){let s=!1;for(const[o,a]of e.afterState.entries()){const l=e.beforeState.get(o)||0;if(a!==l&&(cN(e,i.store.clients.get(o),l,a,c=>{!c.deleted&&c.content.constructor===Ut&&(s=!0)}),s))break}s||ss(e,e.deleteSet,o=>{o instanceof Mr||s||o.parent===this&&o.content.constructor===Ut&&(s=!0)}),ft(i,o=>{s?(t=>{let e=0;ft(t.doc,n=>{let r=t._start,i=t._start,s=Zr();const o=Th(s);for(;i;)!1===i.deleted&&(i.content.constructor===Ut?Al(o,i.content):(e+=LN(n,r,i,s,o),s=Th(o),r=i)),i=i.right})})(this):ss(o,o.deleteSet,a=>{a instanceof Mr||a.parent===this&&((t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const n=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Ut){const r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}})(o,a)})})}}toString(){let e="",n=this._start;for(;null!==n;)!n.deleted&&n.countable&&n.content.constructor===ni&&(e+=n.content.str),n=n.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:n=!0}={}){null!==this.doc?ft(this.doc,r=>{const i=new bb(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const o=e[s];if(void 0!==o.insert){const a=n||"string"!=typeof o.insert||s!==e.length-1||null!==i.right||"\n"!==o.insert.slice(-1)?o.insert:o.insert.slice(0,-1);("string"!=typeof a||a.length>0)&&_b(r,this,i,a,o.attributes||{})}else void 0!==o.retain?PN(r,this,i,o.retain,o.attributes||{}):void 0!==o.delete&&VN(r,i,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,n,r){const i=[],s=new Map;let a="",l=this._start;function c(){if(a.length>0){const u={};let d=!1;s.forEach((p,m)=>{d=!0,u[m]=p});const h={insert:a};d&&(h.attributes=u),i.push(h),a=""}}return ft(this.doc,u=>{for(e&&zh(u,e),n&&zh(u,n);null!==l;){if(zo(l,e)||void 0!==n&&zo(l,n))switch(l.content.constructor){case ni:{const d=s.get("ychange");void 0===e||zo(l,e)?void 0===n||zo(l,n)?void 0!==d&&(c(),s.delete("ychange")):(void 0===d||d.user!==l.id.client||"added"!==d.type)&&(c(),s.set("ychange",r?r("added",l.id):{type:"added"})):(void 0===d||d.user!==l.id.client||"removed"!==d.type)&&(c(),s.set("ychange",r?r("removed",l.id):{type:"removed"})),a+=l.content.str;break}case ri:case Jo:{c();const d={insert:l.content.getContent()[0]};if(s.size>0){const h={};d.attributes=h,s.forEach((p,m)=>{h[m]=p})}i.push(d);break}case Ut:zo(l,e)&&(c(),Al(s,l.content))}l=l.right}c()},zh),i}insert(e,n,r){if(n.length<=0)return;const i=this.doc;null!==i?ft(i,s=>{const o=ep(s,this,e);r||(r={},o.currentAttributes.forEach((a,l)=>{r[l]=a})),_b(s,this,o,n,r)}):this._pending.push(()=>this.insert(e,n,r))}insertEmbed(e,n,r={}){const i=this.doc;null!==i?ft(i,s=>{const o=ep(s,this,e);_b(s,this,o,n,r)}):this._pending.push(()=>this.insertEmbed(e,n,r))}delete(e,n){if(0===n)return;const r=this.doc;null!==r?ft(r,i=>{VN(i,ep(i,this,e),n)}):this._pending.push(()=>this.delete(e,n))}format(e,n,r){if(0===n)return;const i=this.doc;null!==i?ft(i,s=>{const o=ep(s,this,e);null!==o.right&&PN(s,this,o,n,r)}):this._pending.push(()=>this.format(e,n,r))}removeAttribute(e){null!==this.doc?ft(this.doc,n=>{Qh(n,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,n){null!==this.doc?ft(this.doc,r=>{vb(r,this,e,n)}):this._pending.push(()=>this.setAttribute(e,n))}getAttribute(e){return wb(this,e)}getAttributes(e){return kN(this)}_write(e){e.writeTypeRef(xK)}}class Cb{constructor(e,n=(()=>!0)){this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,n=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(n)))do{if(n=e.content.type,e.deleted||n.constructor!==Yn&&n.constructor!==Ko||null===n._start)for(;null!==e;){if(null!==e.right){e=e.right;break}e=e.parent===this._root?null:e.parent._item}else e=n._start}while(null!==e&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,null===e?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Ko extends on{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ko}clone(){const e=new Ko;return e.insert(0,this.toArray().map(n=>n instanceof on?n.clone():n)),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new Cb(this,e)}querySelector(e){e=e.toUpperCase();const r=new Cb(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),Array.from(new Cb(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e))}_callObserver(e,n){Yh(this,e,new mK(this,n,e))}toString(){return EN(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,n={},r){const i=e.createDocumentFragment();return void 0!==r&&r._createAssociation(i,this),Iu(this,s=>{i.insertBefore(s.toDOM(e,n,r),null)}),i}insert(e,n){null!==this.doc?ft(this.doc,r=>{AN(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}insertAfter(e,n){if(null!==this.doc)ft(this.doc,r=>{Zh(r,this,e&&e instanceof on?e._item:e,n)});else{const r=this._prelimContent,i=null===e?0:r.findIndex(s=>s===e)+1;if(0===i&&null!==e)throw zs("Reference item not found");r.splice(i,0,...n)}}delete(e,n=1){null!==this.doc?ft(this.doc,r=>{IN(r,this,e,n)}):this._prelimContent.splice(e,n)}toArray(){return DN(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return MN(this,e)}slice(e=0,n=this.length){return CN(this,e,n)}forEach(e){Iu(this,e)}_write(e){e.writeTypeRef(OK)}}class Yn extends Ko{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,n){super._integrate(e,n),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new Yn(this.nodeName)}clone(){const e=new Yn(this.nodeName),n=this.getAttributes();for(const r in n)e.setAttribute(r,n[r]);return e.insert(0,this.toArray().map(r=>r instanceof on?r.clone():r)),e}toString(){const e=this.getAttributes(),n=[],r=[];for(const a in e)r.push(a);r.sort();const i=r.length;for(let a=0;a<i;a++){const l=r[a];n.push(l+'="'+e[l]+'"')}const s=this.nodeName.toLocaleLowerCase();return`<${s}${n.length>0?" "+n.join(" "):""}>${super.toString()}</${s}>`}removeAttribute(e){null!==this.doc?ft(this.doc,n=>{Qh(n,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,n){null!==this.doc?ft(this.doc,r=>{vb(r,this,e,n)}):this._prelimAttrs.set(e,n)}getAttribute(e){return wb(this,e)}hasAttribute(e){return xN(this,e)}getAttributes(e){return kN(this)}toDOM(e=document,n={},r){const i=e.createElement(this.nodeName),s=this.getAttributes();for(const o in s)i.setAttribute(o,s[o]);return Iu(this,o=>{i.appendChild(o.toDOM(e,n,r))}),void 0!==r&&r._createAssociation(i,this),i}_write(e){e.writeTypeRef(NK),e.writeKey(this.nodeName)}}class mK extends Kh{constructor(e,n,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(i=>{null===i?this.childListChanged=!0:this.attributesChanged.add(i)})}}class tp extends Wo{constructor(e){super(),this.hookName=e}_copy(){return new tp(this.hookName)}clone(){const e=new tp(this.hookName);return this.forEach((n,r)=>{e.set(r,n)}),e}toDOM(e=document,n={},r){const i=n[this.hookName];let s;return s=void 0!==i?i.createDom(this):document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),void 0!==r&&r._createAssociation(s,this),s}_write(e){e.writeTypeRef(RK),e.writeKey(this.hookName)}}class ur extends qo{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new ur}clone(){const e=new ur;return e.applyDelta(this.toDelta()),e}toDOM(e=document,n,r){const i=e.createTextNode(this.toString());return void 0!==r&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{const n=[];for(const i in e.attributes){const s=[];for(const o in e.attributes[i])s.push({key:o,value:e.attributes[i][o]});s.sort((o,a)=>o.key<a.key?-1:1),n.push({nodeName:i,attrs:s})}n.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let r="";for(let i=0;i<n.length;i++){const s=n[i];r+=`<${s.nodeName}`;for(let o=0;o<s.attrs.length;o++){const a=s.attrs[o];r+=` ${a.key}="${a.value}"`}r+=">"}r+=e.insert;for(let i=n.length-1;i>=0;i--)r+=`</${n[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(FK)}}class Db{constructor(e,n){this.id=e,this.length=n}get deleted(){throw Xr()}mergeWith(e){return!1}write(e,n,r){throw Xr()}integrate(e,n){throw Xr()}}class Mr extends Db{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,n){n>0&&(this.id.clock+=n,this.length-=n),aN(e.doc.store,this)}write(e,n){e.writeInfo(0),e.writeLen(this.length-n)}getMissing(e,n){return null}}class ku{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new ku(this.content)}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeBuf(this.content)}getRef(){return 3}}class xu{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new xu(this.len)}splice(e){const n=new xu(this.len-e);return this.len=e,n}mergeWith(e){return this.len+=e.len,!0}integrate(e,n){Cu(e.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(e){}gc(e){}write(e,n){e.writeLen(this.len-n)}getRef(){return 1}}const BN=(t,e)=>new Ho({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Nu{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),null!==e.meta&&(n.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Nu(BN(this.doc.guid,this.opts))}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,n){this.doc._item=n,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,n){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class Jo{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Jo(this.embed)}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeJSON(this.embed)}getRef(){return 5}}class Ut{constructor(e,n){this.key=e,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Ut(this.key,this.value)}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,n){n.parent._searchMarker=null}delete(e){}gc(e){}write(e,n){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}class np{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new np(this.arr)}splice(e){const n=new np(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];e.writeString(void 0===s?"undefined":JSON.stringify(s))}}getRef(){return 2}}class Yo{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Yo(this.arr)}splice(e){const n=new Yo(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let i=n;i<r;i++)e.writeAny(this.arr[i])}getRef(){return 8}}class ni{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ni(this.str)}splice(e){const n=new ni(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"\ufffd",n.str="\ufffd"+n.str.slice(1)),n}mergeWith(e){return this.str+=e.str,!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeString(0===n?this.str:this.str.slice(n))}getRef(){return 4}}const AK=[t=>new Ks,t=>new Wo,t=>new qo,t=>new Yn(t.readKey()),t=>new Ko,t=>new tp(t.readKey()),t=>new ur],IK=0,kK=1,xK=2,NK=3,OK=4,RK=5,FK=6;class ri{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ri(this.type._copy())}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,n){this.type._integrate(e.doc,n)}delete(e){let n=this.type._start;for(;null!==n;)n.deleted?e._mergeStructs.push(n):n.delete(e),n=n.right;this.type._map.forEach(r=>{r.deleted?e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let n=this.type._start;for(;null!==n;)n.gc(e,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;null!==r;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,n){this.type._write(e)}getRef(){return 7}}const Sb=(t,e)=>{let i,n=e,r=0;do{r>0&&(n=Ae(n.client,n.clock+r)),i=Gh(t,n),r=n.clock-i.id.clock,n=i.redone}while(null!==n&&i instanceof it);return{item:i,diff:r}},Eb=(t,e)=>{for(;null!==t&&t.keep!==e;)t.keep=e,t=t.parent._item},rp=(t,e,n)=>{const{client:r,clock:i}=e.id,s=new it(Ae(r,i+n),e,Ae(r,i+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),null!==e.redone&&(s.redone=Ae(e.redone.client,e.redone.clock+n)),e.right=s,null!==s.right&&(s.right.left=s),t._mergeStructs.push(s),null!==s.parentSub&&null===s.right&&s.parent._map.set(s.parentSub,s),e.length=n,s},UN=(t,e,n,r,i)=>{const s=t.doc,o=s.store,a=s.clientID,l=e.redone;if(null!==l)return Rn(t,l);let d,c=e.parent._item,u=null;if(null!==c&&!0===c.deleted){if(null===c.redone&&(!n.has(c)||null===UN(t,c,n,r,i)))return null;for(;null!==c.redone;)c=Rn(t,c.redone)}const h=null===c?e.parent:c.content.type;if(null===e.parentSub){for(u=e.left,d=e;null!==u;){let w=u;for(;null!==w&&w.parent._item!==c;)w=null===w.redone?null:Rn(t,w.redone);if(null!==w&&w.parent._item===c){u=w;break}u=u.left}for(;null!==d;){let w=d;for(;null!==w&&w.parent._item!==c;)w=null===w.redone?null:Rn(t,w.redone);if(null!==w&&w.parent._item===c){d=w;break}d=d.right}}else if(d=null,e.right&&!i){for(u=e;null!==u&&null!==u.right&&Cl(r,u.right.id);)u=u.right;for(;null!==u&&null!==u.redone;)u=Rn(t,u.redone);if(u&&null!==u.right)return null}else u=h._map.get(e.parentSub)||null;const p=Nt(o,a),m=Ae(a,p),v=new it(m,u,u&&u.lastId,d,d&&d.id,h,e.parentSub,e.content.copy());return e.redone=m,Eb(v,!0),v.integrate(t,0),v};class it extends Db{constructor(e,n,r,i,s,o,a,l){super(e,l.getLength()),this.origin=r,this.left=n,this.right=i,this.rightOrigin=s,this.parent=o,this.parentSub=a,this.redone=null,this.content=l,this.info=this.content.isCountable()?2:0}set marker(e){(8&this.info)>0!==e&&(this.info^=8)}get marker(){return(8&this.info)>0}get keep(){return(1&this.info)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(2&this.info)>0}get deleted(){return(4&this.info)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Nt(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Nt(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===El&&this.id.client!==this.parent.client&&this.parent.clock>=Nt(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=lN(e,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Rn(e,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===Mr||this.right&&this.right.constructor===Mr)&&(this.parent=null),this.parent){if(this.parent.constructor===El){const r=Gh(n,this.parent);this.parent=r.constructor===Mr?null:r.content.type}}else this.left&&this.left.constructor===it&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===it&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,n){if(n>0&&(this.id.clock+=n,this.left=lN(e,e.doc.store,Ae(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let i,r=this.left;if(null!==r)i=r.right;else if(null!==this.parentSub)for(i=this.parent._map.get(this.parentSub)||null;null!==i&&null!==i.left;)i=i.left;else i=this.parent._start;const s=new Set,o=new Set;for(;null!==i&&i!==this.right;){if(o.add(i),s.add(i),Ml(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,s.clear();else if(Ml(this.rightOrigin,i.rightOrigin))break}else{if(null===i.origin||!o.has(Gh(e.doc.store,i.origin)))break;s.has(Gh(e.doc.store,i.origin))||(r=i,s.clear())}i=i.right}this.left=r}if(null!==this.left)this.right=this.left.right,this.left.right=this;else{let r;if(null!==this.parentSub)for(r=this.parent._map.get(this.parentSub)||null;null!==r&&null!==r.left;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),aN(e.doc.store,this),this.content.integrate(e,this),dN(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new Mr(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;null!==e&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;null!==e&&e.deleted;)e=e.left;return e}get lastId(){return 1===this.length?this.id:Ae(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&Ml(e.origin,this.lastId)&&this.right===e&&Ml(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const n=this.parent;this.countable&&null===this.parentSub&&(n._length-=this.length),this.markDeleted(),Cu(e.deleteSet,this.id.client,this.id.clock,this.length),dN(e,n,this.parentSub),this.content.delete(e)}}gc(e,n){if(!this.deleted)throw Sr();this.content.gc(e),n?((t,e,n)=>{const r=t.clients.get(e.id.client);r[ti(r,e.id.clock)]=n})(e,this,new Mr(this.id,this.length)):this.content=new xu(this.length)}write(e,n){const r=n>0?Ae(this.id.client,this.id.clock+n-1):this.origin,i=this.rightOrigin,s=this.parentSub,o=31&this.content.getRef()|(null===r?0:cr)|(null===i?0:64)|(null===s?0:32);if(e.writeInfo(o),null!==r&&e.writeLeftID(r),null!==i&&e.writeRightID(i),null===r&&null===i){const a=this.parent;if(void 0!==a._item){const l=a._item;if(null===l){const c=Su(a);e.writeParentInfo(!0),e.writeString(c)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===El?(e.writeParentInfo(!1),e.writeLeftID(a)):Sr();null!==s&&e.writeString(s)}this.content.write(e,n)}}const jN=(t,e)=>LK[31&e](t),LK=[()=>{Sr()},t=>new xu(t.readLen()),t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++){const i=t.readString();n.push("undefined"===i?void 0:JSON.parse(i))}return new np(n)},t=>new ku(t.readBuf()),t=>new ni(t.readString()),t=>new Jo(t.readJSON()),t=>new Ut(t.readKey(),t.readJSON()),t=>new ri(AK[t.readTypeRef()](t)),t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++)n.push(t.readAny());return new Yo(n)},t=>new Nu(BN(t.readString(),t.readAny())),()=>{Sr()}];class dr extends Db{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,n){Sr()}write(e,n){e.writeInfo(10),he(e.restEncoder,this.length-n)}getMissing(e,n){return null}}const $N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},HN="__ $YJS$ __";!0===$N[HN]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),$N[HN]=!0;const ip=3e4,Mb=t=>{if(t.shouldConnect&&null===t.ws){const e=new WebSocket(t.url),n=t.binaryType;let r=null;n&&(e.binaryType=n),t.ws=e,t.connecting=!0,t.connected=!1,e.onmessage=o=>{t.lastMessageReceived=Ai();const a=o.data,l="string"==typeof a?JSON.parse(a):a;l&&"pong"===l.type&&(clearTimeout(r),r=setTimeout(s,ip/2)),t.emit("message",[l,t])};const i=o=>{null!==t.ws&&(t.ws=null,t.connecting=!1,t.connected?(t.connected=!1,t.emit("disconnect",[{type:"disconnect",error:o},t])):t.unsuccessfulReconnects++,setTimeout(Mb,Hs(1200*l9(t.unsuccessfulReconnects+1),2500),t)),clearTimeout(r)},s=()=>{t.ws===e&&t.send({type:"ping"})};e.onclose=()=>i(null),e.onerror=o=>i(o),e.onopen=()=>{t.lastMessageReceived=Ai(),t.connecting=!1,t.connected=!0,t.unsuccessfulReconnects=0,t.emit("connect",[{type:"connect"},t]),r=setTimeout(s,ip/2)}}};class jK extends du{constructor(e,{binaryType:n}={}){super(),this.url=e,this.ws=null,this.binaryType=n||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&ip<Ai()-this.lastMessageReceived&&this.ws.close()},ip/2),Mb(this)}send(e){this.ws&&this.ws.send(JSON.stringify(e))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&null===this.ws&&Mb(this)}}const $K=new Map,zK=typeof BroadcastChannel>"u"?class HK{constructor(e){this.room=e,this.onmessage=null,(t=>{lx||addEventListener("storage",t)})(n=>n.key===e&&null!==this.onmessage&&this.onmessage({data:gx(n.newValue||"")}))}postMessage(e){cx.setItem(this.room,px((t=>new Uint8Array(t))(e)))}}:BroadcastChannel,Tb=t=>lr($K,t,()=>{const e=new Set,n=new zK(t);return n.onmessage=r=>e.forEach(i=>i(r.data,"broadcastchannel")),{bc:n,subs:e}}),zN=()=>{let t=!0;return(e,n)=>{if(t){t=!1;try{e()}finally{t=!0}}else void 0!==n&&n()}};var KK=ds(753);const WN=(t,e)=>{he(t,0);const n=(t=>((t,e=new jh)=>(t instanceof Map?db(e,t):((t,e)=>{db(t,Tu(e.store))})(e,t),e.toUint8Array()))(t,new Dl))(e);xt(t,n)},qN=(t,e,n)=>{he(t,1),xt(t,((t,e)=>((t,e=new Uint8Array([0]),n=new ls)=>{((t,e,n=new Map)=>{cb(t,e.store,n),ki(t,Wx(e.store))})(n,t,Qx(e));const i=[n.toUint8Array()];if(t.store.pendingDs&&i.push(t.store.pendingDs),t.store.pendingStructs&&i.push(yN(t.store.pendingStructs.update,e)),i.length>1){if(n.constructor===Sl)return J7(i.map((s,o)=>0===o?s:X7(s)));if(n.constructor===ls)return qh(i)}return i[0]})(t,e,new Sl))(e,n))},KN=(t,e,n)=>{try{((t,e,n)=>{ub(t,e,n,as)})(e,Qt(t),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},ZK=KN;class XK extends du{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const n=Ai();null!==this.getLocalState()&&15e3<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const r=[];this.meta.forEach((i,s)=>{s!==this.clientID&&3e4<=n-i.lastUpdated&&this.states.has(s)&&r.push(s)}),r.length>0&&xb(this,r,"timeout")},Qr(3e3)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const n=this.clientID,r=this.meta.get(n),i=void 0===r?0:r.clock+1,s=this.states.get(n);null===e?this.states.delete(n):this.states.set(n,e),this.meta.set(n,{clock:i,lastUpdated:Ai()});const o=[],a=[],l=[],c=[];null===e?c.push(n):null==s?null!=e&&o.push(n):(a.push(n),hu(s,e)||l.push(n)),(o.length>0||l.length>0||c.length>0)&&this.emit("change",[{added:o,updated:l,removed:c},"local"]),this.emit("update",[{added:o,updated:a,removed:c},"local"])}setLocalStateField(e,n){const r=this.getLocalState();null!==r&&this.setLocalState({...r,[e]:n})}getStates(){return this.states}}const xb=(t,e,n)=>{const r=[];for(let i=0;i<e.length;i++){const s=e[i];if(t.states.has(s)){if(t.states.delete(s),s===t.clientID){const o=t.meta.get(s);t.meta.set(s,{clock:o.clock+1,lastUpdated:Ai()})}r.push(s)}}r.length>0&&(t.emit("change",[{added:[],updated:[],removed:r},n]),t.emit("update",[{added:[],updated:[],removed:r},n]))},sp=(t,e,n=t.states)=>{const r=e.length,i=Zt();he(i,r);for(let s=0;s<r;s++){const o=e[s],a=n.get(o)||null,l=t.meta.get(o).clock;he(i,o),he(i,l),Mi(i,JSON.stringify(a))}return _t(i)},JN=(t,e)=>{if(!e)return tb(t);const n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},e,t).then(r=>{const i=Zt();return Mi(i,"AES-GCM"),xt(i,n),xt(i,new Uint8Array(r)),_t(i)})},YN=(t,e)=>{if(!e)return tb(t);const n=ei(t);"AES-GCM"!==Ti(n)&&(t=>{Promise.reject(t)})(zs("Unknown encryption algorithm"));const i=Qt(n),s=Qt(n);return crypto.subtle.decrypt({name:"AES-GCM",iv:i},e,s).then(o=>new Uint8Array(o))},ii=(t=>{const e=Hx[sb],n=pu("log"),r=null!==n&&("*"===n||"true"===n||new RegExp(n,"gi").test(t));return sb=(sb+1)%Hx.length,t+=": ",r?(...i)=>{const s=Ai(),o=s-zx;zx=s,Bx(e,t,bu,...i.map(a=>"string"==typeof a||"symbol"==typeof a?a:JSON.stringify(a)),e," +"+o+"ms")}:w9})("y-webrtc"),op=new Map,Zo=new Map,QN=t=>{let e=!0;t.webrtcConns.forEach(n=>{n.synced||(e=!1)}),(!e&&t.synced||e&&!t.synced)&&(t.synced=e,t.provider.emit("synced",[{synced:e}]),ii("synced ",Jn,t.name,Gs," with all peers"))},XN=(t,e,n)=>{const r=ei(e),i=Zt(),s=Ee(r);if(void 0===t)return null;const o=t.awareness,a=t.doc;let l=!1;switch(s){case 0:{he(i,0);const c=((t,e,n,r)=>{const i=Ee(t);switch(i){case 0:((t,e,n)=>{qN(e,n,Qt(t))})(t,e,n);break;case 1:KN(t,n,r);break;case 2:ZK(t,n,r);break;default:throw new Error("Unknown message type")}return i})(r,i,a,t);1===c&&!t.synced&&n(),0===c&&(l=!0);break}case 3:he(i,1),xt(i,sp(o,Array.from(o.getStates().keys()))),l=!0;break;case 1:((t,e,n)=>{const r=ei(e),i=Ai(),s=[],o=[],a=[],l=[],c=Ee(r);for(let u=0;u<c;u++){const d=Ee(r);let h=Ee(r);const p=JSON.parse(Ti(r)),m=t.meta.get(d),v=t.states.get(d),w=void 0===m?0:m.clock;(w<h||w===h&&null===p&&t.states.has(d))&&(null===p?d===t.clientID&&null!=t.getLocalState()?h++:t.states.delete(d):t.states.set(d,p),t.meta.set(d,{clock:h,lastUpdated:i}),void 0===m&&null!==p?s.push(d):void 0!==m&&null===p?l.push(d):null!==p&&(hu(p,v)||a.push(d),o.push(d)))}(s.length>0||a.length>0||l.length>0)&&t.emit("change",[{added:s,updated:a,removed:l},n]),(s.length>0||o.length>0||l.length>0)&&t.emit("update",[{added:s,updated:o,removed:l},n])})(o,Qt(r),t);break;case 4:{const c=1===jo(r),u=Ti(r);if(u!==t.peerId&&(t.bcConns.has(u)&&!c||!t.bcConns.has(u)&&c)){const d=[],h=[];c?(t.bcConns.add(u),h.push(u)):(t.bcConns.delete(u),d.push(u)),t.provider.emit("peers",[{added:h,removed:d,webrtcPeers:Array.from(t.webrtcConns.keys()),bcPeers:Array.from(t.bcConns)}]),nO(t)}break}default:return console.error("Unable to compute message"),i}return l?i:null},Ob=(t,e)=>{ii("send message to ",Jn,t.remotePeerId,Gs,Lh," (",t.room.name,")",bu);try{t.peer.send(_t(e))}catch{}};class eO{constructor(e,n,r,i){ii("establishing connection to ",Jn,r),this.room=i,this.remotePeerId=r,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new KK({initiator:n,...i.provider.peerOpts}),this.peer.on("signal",s=>{Fb(e,i,{to:r,from:i.peerId,type:"signal",signal:s})}),this.peer.on("connect",()=>{ii("connected to ",Jn,r),this.connected=!0;const o=i.provider.doc,a=i.awareness,l=Zt();he(l,0),WN(l,o),Ob(this,l);const c=a.getStates();if(c.size>0){const u=Zt();he(u,1),xt(u,sp(a,Array.from(c.keys()))),Ob(this,u)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,i.webrtcConns.has(this.remotePeerId)&&(i.webrtcConns.delete(this.remotePeerId),i.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}])),QN(i),this.peer.destroy(),ii("closed connection to ",Jn,r),Rb(i)}),this.peer.on("error",s=>{ii("Error in connection to ",Jn,r,": ",s),Rb(i)}),this.peer.on("data",s=>{const o=((t,e)=>{const n=t.room;return ii("received message from ",Jn,t.remotePeerId,Lh," (",n.name,")",Gs,bu),XN(n,e,()=>{t.synced=!0,ii("synced ",Jn,n.name,Gs," with ",Jn,t.remotePeerId),QN(n)})})(this,s);null!==o&&Ob(this,o)})}destroy(){this.peer.destroy()}}const Ys=(t,e)=>JN(e,t.key).then(n=>t.mux(()=>((t,e,n=null)=>{const r=Tb(t);r.bc.postMessage(e),r.subs.forEach(i=>i(e,n))})(t.name,n))),tO=(t,e)=>{t.bcconnected&&Ys(t,e),((t,e)=>{ii("broadcast message in ",Jn,t.name,Gs),t.webrtcConns.forEach(n=>{try{n.peer.send(e)}catch{}})})(t,e)},Rb=t=>{op.forEach(e=>{e.connected&&(e.send({type:"subscribe",topics:[t.name]}),t.webrtcConns.size<t.provider.maxConns&&Fb(e,t,{type:"announce",from:t.peerId}))})},nO=t=>{if(t.provider.filterBcConns){const e=Zt();he(e,4),mu(e,1),Mi(e,t.peerId),Ys(t,_t(e))}};class oJ{constructor(e,n,r,i){this.peerId=xx(),this.doc=e,this.awareness=n.awareness,this.provider=n,this.synced=!1,this.name=r,this.key=i,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=zN(),this.bcconnected=!1,this._bcSubscriber=s=>YN(new Uint8Array(s),i).then(o=>this.mux(()=>{const a=XN(this,o,()=>{});a&&Ys(this,_t(a))})),this._docUpdateHandler=(s,o)=>{const a=Zt();he(a,0),((t,e)=>{he(t,2),xt(t,e)})(a,s),tO(this,_t(a))},this._awarenessUpdateHandler=({added:s,updated:o,removed:a},l)=>{const c=s.concat(o).concat(a),u=Zt();he(u,1),xt(u,sp(this.awareness,c)),tO(this,_t(u))},this._beforeUnloadHandler=()=>{xb(this.awareness,[e.clientID],"window unload"),Zo.forEach(s=>{s.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),Rb(this),((t,e)=>{Tb(this.name).subs.add(e)})(0,this._bcSubscriber),this.bcconnected=!0,nO(this);const n=Zt();he(n,0),WN(n,this.doc),Ys(this,_t(n));const r=Zt();he(r,0),qN(r,this.doc),Ys(this,_t(r));const i=Zt();he(i,3),Ys(this,_t(i));const s=Zt();he(s,1),xt(s,sp(this.awareness,[this.doc.clientID])),Ys(this,_t(s))}disconnect(){op.forEach(n=>{n.connected&&n.send({type:"unsubscribe",topics:[this.name]})}),xb(this.awareness,[this.doc.clientID],"disconnect");const e=Zt();he(e,4),mu(e,0),Mi(e,this.peerId),Ys(this,_t(e)),((t,e)=>{Tb(this.name).subs.delete(e)})(0,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(n=>n.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const Fb=(t,e,n)=>{e.key?((t,e)=>{const n=Zt();return wl(n,t),JN(_t(n),e)})(n,e.key).then(r=>{t.send({type:"publish",topic:e.name,data:px(r)})}):t.send({type:"publish",topic:e.name,data:n})};class lJ extends jK{constructor(e){super(e),this.providers=new Set,this.on("connect",()=>{ii(`connected (${e})`);const n=Array.from(Zo.keys());this.send({type:"subscribe",topics:n}),Zo.forEach(r=>Fb(this,r,{type:"announce",from:r.peerId}))}),this.on("message",n=>{if("publish"===n.type){const r=n.topic,i=Zo.get(r);if(null==i||"string"!=typeof r)return;const s=o=>{const a=i.webrtcConns,l=i.peerId;if(null==o||o.from===l||void 0!==o.to&&o.to!==l||i.bcConns.has(o.from))return;const c=a.has(o.from)?()=>{}:()=>i.provider.emit("peers",[{removed:[],added:[o.from],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}]);switch(o.type){case"announce":a.size<i.provider.maxConns&&(lr(a,o.from,()=>new eO(this,!0,o.from,i)),c());break;case"signal":o.to===l&&(lr(a,o.from,()=>new eO(this,!1,o.from,i)).peer.signal(o.signal),c())}};i.key?"string"==typeof n.data&&((t,e)=>YN(t,e).then(n=>bl(ei(new Uint8Array(n)))))(gx(n.data),i.key).then(s):s(n.data)}}),this.on("disconnect",()=>ii(`disconnect (${e})`))}}class cJ extends du{constructor(e,n,{signaling:r=["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com","wss://y-webrtc-signaling-us.herokuapp.com"],password:i=null,awareness:s=new XK(n),maxConns:o=20+Qr(15*Ix()),filterBcConns:a=!0,peerOpts:l={}}={}){super(),this.roomName=e,this.doc=n,this.filterBcConns=a,this.awareness=s,this.shouldConnect=!1,this.signalingUrls=r,this.signalingConns=[],this.maxConns=o,this.peerOpts=l,this.key=i?((t,e)=>{const n=jw(t).buffer,r=jw(e).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then(i=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))})(i,e):tb(null),this.room=null,this.key.then(c=>{this.room=((t,e,n,r)=>{if(Zo.has(n))throw zs(`A Yjs Doc connected to room "${n}" already exists!`);const i=new oJ(t,e,n,r);return Zo.set(n,i),i})(n,this,e,c),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}get connected(){return null!==this.room&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(e=>{const n=lr(op,e,()=>new lJ(e));this.signalingConns.push(n),n.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(e=>{e.providers.delete(this),0===e.providers.size&&(e.destroy(),op.delete(e.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),Zo.delete(this.roomName)}),super.destroy()}}const Et=new qr("y-sync"),Qo=new qr("y-undo"),ap=new qr("yjs-cursor"),lp=t=>class{constructor(n){this._=n}destroy(){t(this._)}},fJ=lp(clearTimeout),kl=(t,e)=>new fJ(setTimeout(e,t));lp(clearInterval),lp(t=>typeof requestAnimationFrame<"u"&&cancelAnimationFrame(t)),lp(t=>typeof cancelIdleCallback<"u"&&cancelIdleCallback(t));let Fu=null;const mJ=()=>{const t=Fu;Fu=null,t.forEach((e,n)=>{const r=n.state.tr,i=Et.getState(n.state);i&&i.binding&&!i.binding.isDestroyed&&(e.forEach((s,o)=>{r.setMeta(o,s)}),n.dispatch(r))})},cp=(t,e,n)=>{if(0===t)return fb(e,0);let r=null===e._first?null:e._first.content.type;for(;null!==r&&e!==r;){if(r instanceof ur){if(r._length>=t)return fb(r,t);if(t-=r._length,null!==r._item&&null!==r._item.next)r=r._item.next.content.type;else{do{r=null===r._item?null:r._item.parent,t--}while(r!==e&&null!==r&&null!==r._item&&null===r._item.next);null!==r&&r!==e&&(r=null===r._item?null:r._item.next.content.type)}}else{const i=(n.get(r)||{nodeSize:0}).nodeSize;if(null!==r._first&&t<i)r=r._first.content.type,t--;else{if(1===t&&0===r._length&&i>1)return new Tl(null===r._item?null:r._item.id,null===r._item?Su(r):null,null);if(t-=i,null!==r._item&&null!==r._item.next)r=r._item.next.content.type;else{if(0===t)return r=null===r._item?r:r._item.parent,new Tl(null===r._item?null:r._item.id,null===r._item?Su(r):null,null);do{r=r._item.parent,t--}while(r!==e&&null===r._item.next);r!==e&&(r=r._item.next.content.type)}}}if(null===r)throw Sr();if(0===t&&r.constructor!==ur&&r!==e)return vJ(r._item.parent,r._item)}return fb(e,e._length)},vJ=(t,e)=>{let n=null,r=null;return null===t._item?r=Su(t):n=Ae(t._item.id.client,t._item.id.clock),new Tl(n,r,e.id)},Pu=(t,e,n,r)=>{const i=((t,e)=>{const n=e.store,r=t.item,i=t.type,s=t.tname,o=t.assoc;let a=null,l=0;if(null!==r){if(Nt(n,r.client)<=r.clock)return null;const c=Sb(n,r),u=c.item;if(!(u instanceof it))return null;if(a=u.parent,null===a._item||!a._item.deleted){l=u.deleted||!u.countable?0:c.diff+(o>=0?0:1);let d=u.left;for(;null!==d;)!d.deleted&&d.countable&&(l+=d.length),d=d.left}}else{if(null!==s)a=e.get(s);else{if(null===i)throw Sr();{if(Nt(n,i.client)<=i.clock)return null;const{item:c}=Sb(n,i);if(!(c instanceof it&&c.content instanceof ri))return null;a=c.content.type}}l=o>=0?a._length:0}return((t,e,n=0)=>new R7(t,e,n))(a,l,t.assoc)})(n,t);if(null===i||i.type!==e&&!Eu(e,i.type._item))return null;let s=i.type,o=0;if(s.constructor===ur)o=i.index;else if(null===s._item||!s._item.deleted){let a=s._first,l=0;for(;l<s._length&&l<i.index&&null!==a;){if(!a.deleted){const c=a.content.type;l++,o+=c instanceof ur?c._length:r.get(c).nodeSize}a=a.right}o+=1}for(;s!==e&&null!==s._item;){const a=s._item.parent;if(null===a._item||!a._item.deleted){o+=1;let l=a._first;for(;null!==l;){const c=l.content.type;if(c===s)break;l.deleted||(o+=c instanceof ur?c._length:r.get(c).nodeSize),l=l.right}}s=a}return o-1},up=(t,e)=>void 0===e?!t.deleted:e.sv.has(t.id.client)&&e.sv.get(t.id.client)>t.id.clock&&!Cl(e.ds,t.id),_J=[{light:"#ecd44433",dark:"#ecd444"}],CJ=(t,e,n)=>{if(!t.has(n)){if(t.size<e.length){const r=ml();t.forEach(i=>r.add(i)),e=e.filter(i=>!r.has(i))}t.set(n,(t=>t[Qr(Ix()*t.length)])(e))}return t.get(n)},DJ=(t,{colors:e=_J,colorMapping:n=new Map,permanentUserData:r=null,onFirstRender:i=(()=>{})}={})=>{let o,s=!1;const a=new An({props:{editable:l=>{const c=Et.getState(l);return null==c.snapshot&&null==c.prevSnapshot}},key:Et,state:{init:(l,c)=>({type:t,doc:t.doc,binding:null,snapshot:null,prevSnapshot:null,isChangeOrigin:!1,colors:e,colorMapping:n,permanentUserData:r}),apply:(l,c)=>{const u=l.getMeta(Et);if(void 0!==u){c=Object.assign({},c);for(const d in u)c[d]=u[d]}return c.isChangeOrigin=void 0!==u&&!!u.isChangeOrigin,null!==c.binding&&void 0!==u&&(null!=u.snapshot||null!=u.prevSnapshot)&&kl(0,()=>{null==c.binding||c.binding.isDestroyed||(null==u.restore?c.binding._renderSnapshot(u.snapshot,u.prevSnapshot,c):(c.binding._renderSnapshot(u.snapshot,u.snapshot,c),delete c.restore,delete c.snapshot,delete c.prevSnapshot,c.binding._prosemirrorChanged(c.binding.prosemirrorView.state.doc)))}),c}},view:l=>{const c=new EJ(t,l);return null!=o&&clearTimeout(o),o=kl(0,()=>{c._forceRerender(),l.dispatch(l.state.tr.setMeta(Et,{binding:c})),i()}),{update:()=>{const u=a.getState(l.state);null==u.snapshot&&null==u.prevSnapshot&&(s||null!==l.state.doc.content.findDiffStart(l.state.doc.type.createAndFill().content))&&(s=!0,c._prosemirrorChanged(l.state.doc))},destroy:()=>{clearTimeout(o),c.destroy()}}}});return a},Pb=(t,e)=>({anchor:cp(e.selection.anchor,t.type,t.mapping),head:cp(e.selection.head,t.type,t.mapping)});class EJ{constructor(e,n){this.type=e,this.prosemirrorView=n,this.mux=zN(),this.isDestroyed=!1,this.mapping=new Map,this._observeFunction=this._typeChanged.bind(this),this.doc=e.doc,this.beforeTransactionSelection=null,this.beforeAllTransactions=()=>{null===this.beforeTransactionSelection&&(this.beforeTransactionSelection=Pb(this,n.state))},this.afterAllTransactions=()=>{this.beforeTransactionSelection=null},this.doc.on("beforeAllTransactions",this.beforeAllTransactions),this.doc.on("afterAllTransactions",this.afterAllTransactions),e.observeDeep(this._observeFunction),this._domSelectionInView=null}get _tr(){return this.prosemirrorView.state.tr.setMeta("addToHistory",!1)}_isLocalCursorInView(){return!!this.prosemirrorView.hasFocus()&&(Hw&&null===this._domSelectionInView&&(kl(0,()=>{this._domSelectionInView=null}),this._domSelectionInView=this._isDomSelectionInView()),this._domSelectionInView)}_isDomSelectionInView(){const e=this.prosemirrorView._root.getSelection(),n=this.prosemirrorView._root.createRange();n.setStart(e.anchorNode,e.anchorOffset),n.setEnd(e.focusNode,e.focusOffset),0===n.getClientRects().length&&n.startContainer&&n.collapsed&&n.selectNodeContents(n.startContainer);const i=n.getBoundingClientRect(),s=Er.documentElement;return i.bottom>=0&&i.right>=0&&i.left<=(window.innerWidth||s.clientWidth||0)&&i.top<=(window.innerHeight||s.clientHeight||0)}renderSnapshot(e,n){n||(n=hb(Uh(),new Map)),this.prosemirrorView.dispatch(this._tr.setMeta(Et,{snapshot:e,prevSnapshot:n}))}unrenderSnapshot(){this.mapping=new Map,this.mux(()=>{const e=this.type.toArray().map(r=>dp(r,this.prosemirrorView.state.schema,this.mapping)).filter(r=>null!==r),n=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new oe(new ee(e),0,0));n.setMeta(Et,{snapshot:null,prevSnapshot:null}),this.prosemirrorView.dispatch(n)})}_forceRerender(){this.mapping=new Map,this.mux(()=>{const e=this.type.toArray().map(r=>dp(r,this.prosemirrorView.state.schema,this.mapping)).filter(r=>null!==r),n=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new oe(new ee(e),0,0));this.prosemirrorView.dispatch(n.setMeta(Et,{isChangeOrigin:!0}))})}_renderSnapshot(e,n,r){e||(e=(t=>hb(Wx(t.store),Tu(t.store)))(this.doc)),this.mapping=new Map,this.mux(()=>{this.doc.transact(i=>{const s=r.permanentUserData;s&&s.dss.forEach(c=>{ss(i,c,u=>{})});const o=(c,u)=>{const d="added"===c?s.getUserByClientId(u.client):s.getUserByDeletedId(u);return{user:d,type:c,color:CJ(r.colorMapping,r.colors,d)}},a=SN(this.type,new Hh(n.ds,e.sv)).map(c=>!c._item.deleted||up(c._item,e)||up(c._item,n)?dp(c,this.prosemirrorView.state.schema,new Map,e,n,o):null).filter(c=>null!==c),l=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new oe(new ee(a),0,0));this.prosemirrorView.dispatch(l.setMeta(Et,{isChangeOrigin:!0}))},Et)})}_typeChanged(e,n){const r=Et.getState(this.prosemirrorView.state);0!==e.length&&null==r.snapshot&&null==r.prevSnapshot?this.mux(()=>{const i=(a,l)=>this.mapping.delete(l);ss(n,n.deleteSet,a=>a.constructor===it&&this.mapping.delete(a.content.type)),n.changed.forEach(i),n.changedParentTypes.forEach(i);const s=this.type.toArray().map(a=>sO(a,this.prosemirrorView.state.schema,this.mapping)).filter(a=>null!==a);let o=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new oe(new ee(s),0,0));((t,e,n)=>{if(null!==e&&null!==e.anchor&&null!==e.head){const r=Pu(n.doc,n.type,e.anchor,n.mapping),i=Pu(n.doc,n.type,e.head,n.mapping);null!==r&&null!==i&&(t=t.setSelection(Ve.create(t.doc,r,i)))}})(o,this.beforeTransactionSelection,this),o=o.setMeta(Et,{isChangeOrigin:!0}),null!==this.beforeTransactionSelection&&this._isLocalCursorInView()&&o.scrollIntoView(),this.prosemirrorView.dispatch(o)}):this.renderSnapshot(r.snapshot,r.prevSnapshot)}_prosemirrorChanged(e){this.mux(()=>{this.doc.transact(()=>{Bb(this.doc,this.type,e,this.mapping),this.beforeTransactionSelection=Pb(this,this.prosemirrorView.state)},Et)})}destroy(){this.isDestroyed=!0,this.type.unobserveDeep(this._observeFunction),this.doc.off("beforeAllTransactions",this.beforeAllTransactions),this.doc.off("afterAllTransactions",this.afterAllTransactions)}}const sO=(t,e,n,r,i,s)=>{const o=n.get(t);if(void 0===o){if(t instanceof Yn)return dp(t,e,n,r,i,s);throw Xr()}return o},dp=(t,e,n,r,i,s)=>{const o=[],a=l=>{if(l.constructor===Yn){const c=sO(l,e,n,r,i,s);null!==c&&o.push(c)}else{const c=MJ(l,e,n,r,i,s);null!==c&&c.forEach(u=>{null!==u&&o.push(u)})}};void 0===r||void 0===i?t.toArray().forEach(a):SN(t,new Hh(i.ds,r.sv)).forEach(a);try{const l=t.getAttributes(r);void 0!==r&&(up(t._item,r)?up(t._item,i)||(l.ychange=s?s("added",t._item.id):{type:"added"}):l.ychange=s?s("removed",t._item.id):{type:"removed"});const c=e.node(t.nodeName,l,o);return n.set(t,c),c}catch{return t.doc.transact(c=>{t._item.delete(c)},Et),n.delete(t),null}},MJ=(t,e,n,r,i,s)=>{const o=[],a=t.toDelta(r,i,s);try{for(let l=0;l<a.length;l++){const c=a[l],u=[];for(const d in c.attributes)u.push(e.mark(d,c.attributes[d]));o.push(e.text(c.insert,u))}}catch{return t.doc.transact(c=>{t._item.delete(c)},Et),null}return o},Lb=(t,e)=>t instanceof Array?((t,e)=>{const n=new ur,r=t.map(i=>({insert:i.text,attributes:cO(i.marks)}));return n.applyDelta(r),e.set(n,t),n})(t,e):((t,e)=>{const n=new Yn(t.type.name);for(const r in t.attrs){const i=t.attrs[r];null!==i&&"ychange"!==r&&n.setAttribute(r,i)}return n.insert(0,fp(t).map(r=>Lb(r,e))),e.set(n,t),n})(t,e),oO=t=>"object"==typeof t&&null!==t,Vb=(t,e)=>{const n=Object.keys(t).filter(i=>null!==t[i]);let r=n.length===Object.keys(e).filter(i=>null!==e[i]).length;for(let i=0;i<n.length&&r;i++){const s=n[i],o=t[s],a=e[s];r="ychange"===s||o===a||oO(o)&&oO(a)&&Vb(o,a)}return r},fp=t=>{const e=t.content.content,n=[];for(let r=0;r<e.length;r++){const i=e[r];if(i.isText){const s=[];for(let o=e[r];r<e.length&&o.isText;o=e[++r])s.push(o);r--,n.push(s)}else n.push(i)}return n},aO=(t,e)=>{const n=t.toDelta();return n.length===e.length&&n.every((r,i)=>r.insert===e[i].text&&ux(r.attributes||{}).length===e[i].marks.length&&e[i].marks.every(s=>Vb(r.attributes[s.type.name]||{},s.attrs)))},Lu=(t,e)=>{if(t instanceof Yn&&!(e instanceof Array)&&Ub(t,e)){const n=fp(e);return t._length===n.length&&Vb(t.getAttributes(),e.attrs)&&t.toArray().every((r,i)=>Lu(r,n[i]))}return t instanceof ur&&e instanceof Array&&aO(t,e)},hp=(t,e)=>t===e||t instanceof Array&&e instanceof Array&&t.length===e.length&&t.every((n,r)=>e[r]===n),lO=(t,e,n)=>{const r=t.toArray(),i=fp(e),s=i.length,o=r.length,a=Hs(o,s);let l=0,c=0,u=!1;for(;l<a;l++){const d=r[l],h=i[l];if(hp(n.get(d),h))u=!0;else if(!Lu(d,h))break}for(;l+c<a;c++){const d=r[o-c-1],h=i[s-c-1];if(hp(n.get(d),h))u=!0;else if(!Lu(d,h))break}return{equalityFactor:l+c,foundMappedChild:u}},kJ=(t,e,n)=>{n.set(t,e);const{nAttrs:r,str:i}=(t=>{let e="",n=t._start;const r={};for(;null!==n;)n.deleted||(n.countable&&n.content instanceof ni?e+=n.content.str:n.content instanceof Ut&&(r[n.content.key]=null)),n=n.right;return{str:e,nAttrs:r}})(t),s=e.map(c=>({insert:c.text,attributes:Object.assign({},r,cO(c.marks))})),{insert:o,remove:a,index:l}=((t,e)=>{let n=0,r=0;for(;n<t.length&&n<e.length&&t[n]===e[n];)n++;for(;r+n<t.length&&r+n<e.length&&t[t.length-r-1]===e[e.length-r-1];)r++;return{index:n,remove:t.length-n-r,insert:e.slice(n,e.length-r)}})(i,s.map(c=>c.insert).join(""));t.delete(l,a),t.insert(l,o),t.applyDelta(s.map(c=>({retain:c.insert.length,attributes:c.attributes})))},cO=t=>{const e={};return t.forEach(n=>{"ychange"!==n.type.name&&(e[n.type.name]=n.attrs)}),e},Bb=(t,e,n,r)=>{if(e instanceof Yn&&e.nodeName!==n.type.name)throw new Error("node name mismatch!");if(r.set(e,n),e instanceof Yn){const d=e.getAttributes(),h=n.attrs;for(const p in h)null!==h[p]?d[p]!==h[p]&&"ychange"!==p&&e.setAttribute(p,h[p]):e.removeAttribute(p);for(const p in d)void 0===h[p]&&e.removeAttribute(p)}const i=fp(n),s=i.length,o=e.toArray(),a=o.length,l=Hs(s,a);let c=0,u=0;for(;c<l;c++){const d=o[c],h=i[c];if(!hp(r.get(d),h)){if(!Lu(d,h))break;r.set(d,h)}}for(;u+c+1<l;u++){const d=o[a-u-1],h=i[s-u-1];if(!hp(r.get(d),h)){if(!Lu(d,h))break;r.set(d,h)}}t.transact(()=>{for(;a-c-u>0&&s-c-u>0;){const h=o[c],p=i[c],m=o[a-u-1],v=i[s-u-1];if(h instanceof ur&&p instanceof Array)aO(h,p)||kJ(h,p,r),c+=1;else{let w=h instanceof Yn&&Ub(h,p),k=m instanceof Yn&&Ub(m,v);if(w&&k){const z=lO(h,p,r),B=lO(m,v,r);z.foundMappedChild&&!B.foundMappedChild?k=!1:!z.foundMappedChild&&B.foundMappedChild||z.equalityFactor<B.equalityFactor?w=!1:k=!1}w?(Bb(t,h,p,r),c+=1):k?(Bb(t,m,v,r),u+=1):(e.delete(c,1),e.insert(c,[Lb(p,r)]),c+=1)}}const d=a-c-u;if(1===a&&0===s&&o[0]instanceof ur?o[0].delete(0,o[0].length):d>0&&e.delete(c,d),c+u<s){const h=[];for(let p=c;p<s-u;p++)h.push(Lb(i[p],r));e.insert(c,h)}},Et)},Ub=(t,e)=>!(e instanceof Array)&&t.nodeName===e.type.name,OJ=new Set(["paragraph"]),FJ=({protectedNodes:t=OJ,trackedOrigins:e=[],undoManager:n=null}={})=>new An({key:Qo,state:{init:(r,i)=>{const s=Et.getState(i),o=n||new G7(s.type,{trackedOrigins:new Set([Et].concat(e)),deleteFilter:a=>((t,e)=>!(t instanceof it&&t.content instanceof ri&&(t.content.type instanceof qo||t.content.type instanceof Yn&&e.has(t.content.type.nodeName))&&0!==t.content.type._length))(a,t)});return{undoManager:o,prevSel:null,hasUndoOps:o.undoStack.length>0,hasRedoOps:o.redoStack.length>0}},apply:(r,i,s,o)=>{const a=Et.getState(o).binding,l=i.undoManager,c=l.undoStack.length>0,u=l.redoStack.length>0;return a?{undoManager:l,prevSel:Pb(a,s),hasUndoOps:c,hasRedoOps:u}:c!==i.hasUndoOps||u!==i.hasRedoOps?Object.assign({},i,{hasUndoOps:l.undoStack.length>0,hasRedoOps:l.redoStack.length>0}):i}},view:r=>{const i=Et.getState(r.state),s=Qo.getState(r.state).undoManager;return s.on("stack-item-added",({stackItem:o})=>{const a=i.binding;a&&o.meta.set(a,Qo.getState(r.state).prevSel)}),s.on("stack-item-popped",({stackItem:o})=>{const a=i.binding;a&&(a.beforeTransactionSelection=o.meta.get(a)||a.beforeTransactionSelection)}),{destroy:()=>{s.destroy()}}}}),PJ=On.create({name:"collaboration",priority:1e3,addOptions:()=>({document:null,field:"default",fragment:null}),onCreate(){this.editor.extensionManager.extensions.find(t=>"history"===t.name)&&console.warn('[tiptap warn]: "@tiptap/extension-collaboration" comes with its own history support and is not compatible with "@tiptap/extension-history".')},addCommands:()=>({undo:()=>({tr:t,state:e,dispatch:n})=>(t.setMeta("preventDispatch",!0),0!==Qo.getState(e).undoManager.undoStack.length&&(!n||(t=>{const e=Qo.getState(t).undoManager;if(null!=e)return e.undo(),!0})(e))),redo:()=>({tr:t,state:e,dispatch:n})=>(t.setMeta("preventDispatch",!0),0!==Qo.getState(e).undoManager.redoStack.length&&(!n||(t=>{const e=Qo.getState(t).undoManager;if(null!=e)return e.redo(),!0})(e)))}),addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo()}},addProseMirrorPlugins(){const t=this.options.fragment?this.options.fragment:this.options.document.getXmlFragment(this.options.field);return[DJ(t),FJ()]}}),LJ=t=>{const e=document.createElement("span");e.classList.add("ProseMirror-yjs-cursor"),e.setAttribute("style",`border-color: ${t.color}`);const n=document.createElement("div");n.setAttribute("style",`background-color: ${t.color}`),n.insertBefore(document.createTextNode(t.name),null);const r=document.createTextNode("\u2060"),i=document.createTextNode("\u2060");return e.insertBefore(r,null),e.insertBefore(n,null),e.insertBefore(i,null),e},VJ=t=>({style:`background-color: ${t.color}70`,class:"ProseMirror-yjs-selection"}),BJ=/^#[0-9a-fA-F]{6}$/,uO=(t,e,n,r)=>{const i=Et.getState(t),s=i.doc,o=[];return null!=i.snapshot||null!=i.prevSnapshot||null===i.binding?Rt.create(t.doc,[]):(e.getStates().forEach((a,l)=>{if(l!==s.clientID&&null!=a.cursor){const c=a.user||{};null==c.color?c.color="#ffa500":BJ.test(c.color)||console.warn("A user uses an unsupported color format",c),null==c.name&&(c.name=`User: ${l}`);let u=Pu(s,i.type,Mu(a.cursor.anchor),i.binding.mapping),d=Pu(s,i.type,Mu(a.cursor.head),i.binding.mapping);if(null!==u&&null!==d){const h=ts(t.doc.content.size-1,0);u=Hs(u,h),d=Hs(d,h),o.push(qn.widget(d,()=>n(c),{key:l+"",side:10}));const p=Hs(u,d),m=ts(u,d);o.push(qn.inline(p,m,r(c),{inclusiveEnd:!0,inclusiveStart:!1}))}}}),Rt.create(t.doc,o))},UJ=(t,{cursorBuilder:e=LJ,selectionBuilder:n=VJ,getSelection:r=(s=>s.selection)}={},i="cursor")=>new An({key:ap,state:{init:(s,o)=>uO(o,t,e,n),apply(s,o,a,l){const c=Et.getState(l),u=s.getMeta(ap);return c&&c.isChangeOrigin||u&&u.awarenessUpdated?uO(l,t,e,n):o.map(s.mapping,s.doc)}},props:{decorations:s=>ap.getState(s)},view:s=>{const o=()=>{s.docView&&((t,e,n)=>{Fu||(Fu=new Map,kl(0,mJ)),lr(Fu,t,Zr).set(e,{awarenessUpdated:!0})})(s,ap)},a=()=>{const l=Et.getState(s.state),c=t.getLocalState()||{};if(null!=l.binding)if(s.hasFocus()){const u=r(s.state),d=cp(u.anchor,l.type,l.binding.mapping),h=cp(u.head,l.type,l.binding.mapping);(null==c.cursor||!sN(Mu(c.cursor.anchor),d)||!sN(Mu(c.cursor.head),h))&&t.setLocalStateField(i,{anchor:d,head:h})}else null!=c.cursor&&null!==Pu(l.doc,l.type,Mu(c.cursor.anchor),l.binding.mapping)&&t.setLocalStateField(i,null)};return t.on("change",o),s.dom.addEventListener("focusin",a),s.dom.addEventListener("focusout",a),{update:a,destroy:()=>{s.dom.removeEventListener("focusin",a),s.dom.removeEventListener("focusout",a),t.off("change",o),t.setLocalStateField(i,null)}}}}),dO=t=>Array.from(t.entries()).map(([e,n])=>({clientId:e,...n.user})),fO=()=>null,jJ=On.create({name:"collaborationCursor",addOptions:()=>({provider:null,user:{name:null,color:null},render:t=>{const e=document.createElement("span");e.classList.add("collaboration-cursor__caret"),e.setAttribute("style",`border-color: ${t.color}`);const n=document.createElement("div");return n.classList.add("collaboration-cursor__label"),n.setAttribute("style",`background-color: ${t.color}`),n.insertBefore(document.createTextNode(t.name),null),e.insertBefore(n,null),e},onUpdate:fO}),onCreate(){this.options.onUpdate!==fO&&console.warn('[tiptap warn]: DEPRECATED: The "onUpdate" option is deprecated. Please use `editor.storage.collaborationCursor.users` instead. Read more: https://tiptap.dev/api/extensions/collaboration-cursor')},addStorage:()=>({users:[]}),addCommands(){return{updateUser:t=>()=>(this.options.user=t,this.options.provider.awareness.setLocalStateField("user",this.options.user),!0),user:t=>({editor:e})=>(console.warn('[tiptap warn]: DEPRECATED: The "user" command is deprecated. Please use "updateUser" instead. Read more: https://tiptap.dev/api/extensions/collaboration-cursor'),e.commands.updateUser(t))}},addProseMirrorPlugins(){return[UJ((()=>(this.options.provider.awareness.setLocalStateField("user",this.options.user),this.storage.users=dO(this.options.provider.awareness.states),this.options.provider.awareness.on("update",()=>{this.storage.users=dO(this.options.provider.awareness.states)}),this.options.provider.awareness))(),{cursorBuilder:this.options.render})]}});class pp{constructor(){this.name="Demo",this.ydoc=new Ho,this.provider=new cJ("example-document",this.ydoc),this.editor=new rq({extensions:[r9.configure({history:!1}),PJ.configure({document:this.ydoc}),jJ.configure({provider:this.provider,user:{name:this.name,color:"red"}})]}),this.value="<p>Hello, Tiptap!</p>"}ngOnDestroy(){this.editor.destroy()}static#e=this.\u0275fac=function(n){return new(n||pp)};static#t=this.\u0275cmp=Ll({type:pp,selectors:[["app-tt-try1"]],decls:7,vars:4,consts:[[3,"ngModel","ngModelChange"],[3,"editor","ngModel","ngModelChange"]],template:function(n,r){1&n&&(go(0,"p"),Pd(1,"tt-try1 works!"),mo(),Pd(2,"\nName: "),go(3,"input",0),jn("ngModelChange",function(s){return r.name=s}),mo(),go(4,"h2"),Pd(5),mo(),go(6,"tiptap-editor",1),jn("ngModelChange",function(s){return r.value=s}),mo()),2&n&&(wd(3),Nd("ngModel",r.name),wd(2),Ld("User is ",r.name,""),wd(1),Nd("editor",r.editor)("ngModel",r.value))},dependencies:[u8,yf,v1,Hy]})}class gp{constructor(){this.title="tiptap1"}static#e=this.\u0275fac=function(n){return new(n||gp)};static#t=this.\u0275cmp=Ll({type:gp,selectors:[["app-root"]],decls:2,vars:0,template:function(n,r){1&n&&Od(0,"app-tt-try1")(1,"router-outlet")},dependencies:[hv,pp]})}class mp{static#e=this.\u0275fac=function(n){return new(n||mp)};static#t=this.\u0275mod=Or({type:mp,bootstrap:[gp]});static#n=this.\u0275inj=fr({imports:[zH,d8,l8,Wf]})}HH().bootstrapModule(mp).catch(t=>console.error(t))},753:xl=>{var us,ds,Re;xl.exports=(us=Math.floor,ds=Math.abs,Re=Math.pow,function K(le,U,M){function G(A,I){if(!U[A]){if(!le[A]){if(Q)return Q(A,!0);var F=new Error("Cannot find module '"+A+"'");throw F.code="MODULE_NOT_FOUND",F}var V=U[A]={exports:{}};le[A][0].call(V.exports,function($){return G(le[A][1][$]||$)},V,V.exports,K,le,U,M)}return U[A].exports}for(var Q=void 0,_=0;_<M.length;_++)G(M[_]);return G}({1:[function(K,le,U){"use strict";function M(S){var E=S.length;if(0<E%4)throw new Error("Invalid string. Length must be a multiple of 4");var O=S.indexOf("=");return-1===O&&(O=E),[O,O===E?0:4-O%4]}function _(S){return C[63&S>>18]+C[63&S>>12]+C[63&S>>6]+C[63&S]}function A(S,E,O){for(var P=[],W=E;W<O;W+=3)P.push(_((16711680&S[W]<<16)+(65280&S[W+1]<<8)+(255&S[W+2])));return P.join("")}U.byteLength=function(S){var E=M(S),T=E[1];return 3*(E[0]+T)/4-T},U.toByteArray=function Q(S){var E,O,T=M(S),P=T[0],W=T[1],x=new V(function G(S,E,O){return 3*(E+O)/4-O}(0,P,W)),N=0,J=0<W?P-4:P;for(O=0;O<J;O+=4)E=F[S.charCodeAt(O)]<<18|F[S.charCodeAt(O+1)]<<12|F[S.charCodeAt(O+2)]<<6|F[S.charCodeAt(O+3)],x[N++]=255&E>>16,x[N++]=255&E>>8,x[N++]=255&E;return 2===W&&(E=F[S.charCodeAt(O)]<<2|F[S.charCodeAt(O+1)]>>4,x[N++]=255&E),1===W&&(E=F[S.charCodeAt(O)]<<10|F[S.charCodeAt(O+1)]<<4|F[S.charCodeAt(O+2)]>>2,x[N++]=255&E>>8,x[N++]=255&E),x},U.fromByteArray=function I(S){for(var E,O=S.length,T=O%3,P=[],W=16383,x=0,N=O-T;x<N;x+=W)P.push(A(S,x,x+W>N?N:x+W));return 1===T?P.push(C[(E=S[O-1])>>2]+C[63&E<<4]+"=="):2===T&&P.push(C[(E=(S[O-2]<<8)+S[O-1])>>10]+C[63&E>>4]+C[63&E<<2]+"="),P.join("")};for(var C=[],F=[],V=typeof Uint8Array>"u"?Array:Uint8Array,$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",q=0,b=$.length;q<b;++q)C[q]=$[q],F[$.charCodeAt(q)]=q;F[45]=62,F[95]=63},{}],2:[function(){},{}],3:[function(K,le,U){(function(){(function(){"use strict";var M=String.fromCharCode,G=Math.min;function Q(f){if(2147483647<f)throw new RangeError('The value "'+f+'" is invalid for option "size"');var g=new Uint8Array(f);return g.__proto__=_.prototype,g}function _(f,g,y){if("number"==typeof f){if("string"==typeof g)throw new TypeError('The "string" argument must be of type string. Received type number');return F(f)}return A(f,g,y)}function A(f,g,y){if("string"==typeof f)return function V(f,g){if(("string"!=typeof g||""===g)&&(g="utf8"),!_.isEncoding(g))throw new TypeError("Unknown encoding: "+g);var y=0|E(f,g),D=Q(y),L=D.write(f,g);return L!==y&&(D=D.slice(0,L)),D}(f,g);if(ArrayBuffer.isView(f))return $(f);if(null==f)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f);if(R(f,ArrayBuffer)||f&&R(f.buffer,ArrayBuffer))return function q(f,g,y){if(0>g||f.byteLength<g)throw new RangeError('"offset" is outside of buffer bounds');if(f.byteLength<g+(y||0))throw new RangeError('"length" is outside of buffer bounds');var D;return(D=void 0===g&&void 0===y?new Uint8Array(f):void 0===y?new Uint8Array(f,g):new Uint8Array(f,g,y)).__proto__=_.prototype,D}(f,g,y);if("number"==typeof f)throw new TypeError('The "value" argument must not be of type number. Received type number');var D=f.valueOf&&f.valueOf();if(null!=D&&D!==f)return _.from(D,g,y);var L=function b(f){if(_.isBuffer(f)){var g=0|S(f.length),y=Q(g);return 0===y.length||f.copy(y,0,0,g),y}return void 0===f.length?"Buffer"===f.type&&Array.isArray(f.data)?$(f.data):void 0:"number"!=typeof f.length||H(f.length)?Q(0):$(f)}(f);if(L)return L;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof f[Symbol.toPrimitive])return _.from(f[Symbol.toPrimitive]("string"),g,y);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f)}function I(f){if("number"!=typeof f)throw new TypeError('"size" argument must be of type number');if(0>f)throw new RangeError('The value "'+f+'" is invalid for option "size"')}function F(f){return I(f),Q(0>f?0:0|S(f))}function $(f){for(var g=0>f.length?0:0|S(f.length),y=Q(g),D=0;D<g;D+=1)y[D]=255&f[D];return y}function S(f){if(f>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|f}function E(f,g){if(_.isBuffer(f))return f.length;if(ArrayBuffer.isView(f)||R(f,ArrayBuffer))return f.byteLength;if("string"!=typeof f)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof f);var y=f.length,D=2<arguments.length&&!0===arguments[2];if(!D&&0===y)return 0;for(var L=!1;;)switch(g){case"ascii":case"latin1":case"binary":return y;case"utf8":case"utf-8":return kr(f).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*y;case"hex":return y>>>1;case"base64":return bn(f).length;default:if(L)return D?-1:kr(f).length;g=(""+g).toLowerCase(),L=!0}}function O(f,g,y){var D=!1;if((void 0===g||0>g)&&(g=0),g>this.length||((void 0===y||y>this.length)&&(y=this.length),0>=y)||(y>>>=0)<=(g>>>=0))return"";for(f||(f="utf8");;)switch(f){case"hex":return Tr(this,g,y);case"utf8":case"utf-8":return ot(this,g,y);case"ascii":return we(this,g,y);case"latin1":case"binary":return vt(this,g,y);case"base64":return Ge(this,g,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ar(this,g,y);default:if(D)throw new TypeError("Unknown encoding: "+f);f=(f+"").toLowerCase(),D=!0}}function T(f,g,y){var D=f[g];f[g]=f[y],f[y]=D}function P(f,g,y,D,L){if(0===f.length)return-1;if("string"==typeof y?(D=y,y=0):2147483647<y?y=2147483647:-2147483648>y&&(y=-2147483648),H(y=+y)&&(y=L?0:f.length-1),0>y&&(y=f.length+y),y>=f.length){if(L)return-1;y=f.length-1}else if(0>y){if(!L)return-1;y=0}if("string"==typeof g&&(g=_.from(g,D)),_.isBuffer(g))return 0===g.length?-1:W(f,g,y,D,L);if("number"==typeof g)return g&=255,"function"==typeof Uint8Array.prototype.indexOf?L?Uint8Array.prototype.indexOf.call(f,g,y):Uint8Array.prototype.lastIndexOf.call(f,g,y):W(f,[g],y,D,L);throw new TypeError("val must be string, number or Buffer")}function W(f,g,y,D,L){function j(Qs,Xs){return 1===re?Qs[Xs]:Qs.readUInt16BE(Xs*re)}var Ze,re=1,$e=f.length,Xe=g.length;if(void 0!==D&&("ucs2"===(D=(D+"").toLowerCase())||"ucs-2"===D||"utf16le"===D||"utf-16le"===D)){if(2>f.length||2>g.length)return-1;re=2,$e/=2,Xe/=2,y/=2}if(L){var Ye=-1;for(Ze=y;Ze<$e;Ze++)if(j(f,Ze)!==j(g,-1===Ye?0:Ze-Ye))-1!==Ye&&(Ze-=Ze-Ye),Ye=-1;else if(-1===Ye&&(Ye=Ze),Ze-Ye+1===Xe)return Ye*re}else for(y+Xe>$e&&(y=$e-Xe),Ze=y;0<=Ze;Ze--){for(var qe=!0,Zs=0;Zs<Xe;Zs++)if(j(f,Ze+Zs)!==j(g,Zs)){qe=!1;break}if(qe)return Ze}return-1}function x(f,g,y,D){var L=f.length-(y=+y||0);D?(D=+D)>L&&(D=L):D=L;var j=g.length;D>j/2&&(D=j/2);for(var re,$e=0;$e<D;++$e){if(H(re=parseInt(g.substr(2*$e,2),16)))return $e;f[y+$e]=re}return $e}function N(f,g,y,D){return Pn(kr(g,f.length-y),f,y,D)}function J(f,g,y,D){return Pn(function xe(f){for(var g=[],y=0;y<f.length;++y)g.push(255&f.charCodeAt(y));return g}(g),f,y,D)}function ie(f,g,y,D){return J(f,g,y,D)}function Ce(f,g,y,D){return Pn(bn(g),f,y,D)}function Fe(f,g,y,D){return Pn(function Ni(f,g){for(var y,D,j=[],re=0;re<f.length&&!(0>(g-=2));++re)D=(y=f.charCodeAt(re))>>8,j.push(y%256),j.push(D);return j}(g,f.length-y),f,y,D)}function Ge(f,g,y){return ne.fromByteArray(0===g&&y===f.length?f:f.slice(g,y))}function ot(f,g,y){y=G(f.length,y);for(var D=[],L=g;L<y;){var Xe,Ze,Ye,qe,j=f[L],re=null,$e=239<j?4:223<j?3:191<j?2:1;L+$e<=y&&(1===$e?128>j&&(re=j):2===$e?128==(192&(Xe=f[L+1]))&&127<(qe=(31&j)<<6|63&Xe)&&(re=qe):3===$e?(Ze=f[L+2],128==(192&(Xe=f[L+1]))&&128==(192&Ze)&&2047<(qe=(15&j)<<12|(63&Xe)<<6|63&Ze)&&(55296>qe||57343<qe)&&(re=qe)):4===$e&&(Ze=f[L+2],Ye=f[L+3],128==(192&(Xe=f[L+1]))&&128==(192&Ze)&&128==(192&Ye)&&65535<(qe=(15&j)<<18|(63&Xe)<<12|(63&Ze)<<6|63&Ye)&&1114112>qe&&(re=qe))),null===re?(re=65533,$e=1):65535<re&&(D.push(55296|1023&(re-=65536)>>>10),re=56320|1023&re),D.push(re),L+=$e}return function an(f){var g=f.length;if(g<=4096)return M.apply(String,f);for(var y="",D=0;D<g;)y+=M.apply(String,f.slice(D,D+=4096));return y}(D)}function we(f,g,y){var D="";y=G(f.length,y);for(var L=g;L<y;++L)D+=M(127&f[L]);return D}function vt(f,g,y){var D="";y=G(f.length,y);for(var L=g;L<y;++L)D+=M(f[L]);return D}function Tr(f,g,y){var D=f.length;(!g||0>g)&&(g=0),(!y||0>y||y>D)&&(y=D);for(var L="",j=g;j<y;++j)L+=wt(f[j]);return L}function Ar(f,g,y){for(var D=f.slice(g,y),L="",j=0;j<D.length;j+=2)L+=M(D[j]+256*D[j+1]);return L}function at(f,g,y){if(f%1!=0||0>f)throw new RangeError("offset is not uint");if(f+g>y)throw new RangeError("Trying to access beyond buffer length")}function lt(f,g,y,D,L,j){if(!_.isBuffer(f))throw new TypeError('"buffer" argument must be a Buffer instance');if(g>L||g<j)throw new RangeError('"value" argument is out of bounds');if(y+D>f.length)throw new RangeError("Index out of range")}function qt(f,g,y,D){if(y+D>f.length)throw new RangeError("Index out of range");if(0>y)throw new RangeError("Index out of range")}function Fn(f,g,y,D,L){return g=+g,y>>>=0,L||qt(f,0,y,4),de.write(f,g,y,D,23,4),y+4}function Ir(f,g,y,D,L){return g=+g,y>>>=0,L||qt(f,0,y,8),de.write(f,g,y,D,52,8),y+8}function wt(f){return 16>f?"0"+f.toString(16):f.toString(16)}function kr(f,g){g=g||1/0;for(var y,D=f.length,L=null,j=[],re=0;re<D;++re){if(55295<(y=f.charCodeAt(re))&&57344>y){if(!L){if(56319<y){-1<(g-=3)&&j.push(239,191,189);continue}if(re+1===D){-1<(g-=3)&&j.push(239,191,189);continue}L=y;continue}if(56320>y){-1<(g-=3)&&j.push(239,191,189),L=y;continue}y=65536+(L-55296<<10|y-56320)}else L&&-1<(g-=3)&&j.push(239,191,189);if(L=null,128>y){if(0>(g-=1))break;j.push(y)}else if(2048>y){if(0>(g-=2))break;j.push(192|y>>6,128|63&y)}else if(65536>y){if(0>(g-=3))break;j.push(224|y>>12,128|63&y>>6,128|63&y)}else{if(!(1114112>y))throw new Error("Invalid code point");if(0>(g-=4))break;j.push(240|y>>18,128|63&y>>12,128|63&y>>6,128|63&y)}}return j}function bn(f){return ne.toByteArray(function ht(f){if(2>(f=(f=f.split("=")[0]).trim().replace(Ue,"")).length)return"";for(;f.length%4!=0;)f+="=";return f}(f))}function Pn(f,g,y,D){for(var L=0;L<D&&!(L+y>=g.length||L>=f.length);++L)g[L+y]=f[L];return L}function R(f,g){return f instanceof g||null!=f&&null!=f.constructor&&null!=f.constructor.name&&f.constructor.name===g.name}function H(f){return f!=f}var ne=K("base64-js"),de=K("ieee754");U.Buffer=_,U.SlowBuffer=function(f){return+f!=f&&(f=0),_.alloc(+f)},U.INSPECT_MAX_BYTES=50,U.kMaxLength=2147483647,(_.TYPED_ARRAY_SUPPORT=function(){try{var f=new Uint8Array(1);return f.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===f.foo()}catch{return!1}}())||typeof console>"u"||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(_.prototype,"parent",{enumerable:!0,get:function(){return _.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(_.prototype,"offset",{enumerable:!0,get:function(){return _.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&null!=Symbol.species&&_[Symbol.species]===_&&Object.defineProperty(_,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),_.poolSize=8192,_.from=function(f,g,y){return A(f,g,y)},_.prototype.__proto__=Uint8Array.prototype,_.__proto__=Uint8Array,_.alloc=function(f,g,y){return function C(f,g,y){return I(f),0>=f||void 0===g?Q(f):"string"==typeof y?Q(f).fill(g,y):Q(f).fill(g)}(f,g,y)},_.allocUnsafe=function(f){return F(f)},_.allocUnsafeSlow=function(f){return F(f)},_.isBuffer=function(f){return null!=f&&!0===f._isBuffer&&f!==_.prototype},_.compare=function(f,g){if(R(f,Uint8Array)&&(f=_.from(f,f.offset,f.byteLength)),R(g,Uint8Array)&&(g=_.from(g,g.offset,g.byteLength)),!_.isBuffer(f)||!_.isBuffer(g))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===g)return 0;for(var y=f.length,D=g.length,L=0,j=G(y,D);L<j;++L)if(f[L]!==g[L]){y=f[L],D=g[L];break}return y<D?-1:D<y?1:0},_.isEncoding=function(f){switch((f+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},_.concat=function(f,g){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(0===f.length)return _.alloc(0);var y;if(void 0===g)for(g=0,y=0;y<f.length;++y)g+=f[y].length;var D=_.allocUnsafe(g),L=0;for(y=0;y<f.length;++y){var j=f[y];if(R(j,Uint8Array)&&(j=_.from(j)),!_.isBuffer(j))throw new TypeError('"list" argument must be an Array of Buffers');j.copy(D,L),L+=j.length}return D},_.byteLength=E,_.prototype._isBuffer=!0,_.prototype.swap16=function(){var f=this.length;if(f%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var g=0;g<f;g+=2)T(this,g,g+1);return this},_.prototype.swap32=function(){var f=this.length;if(f%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var g=0;g<f;g+=4)T(this,g,g+3),T(this,g+1,g+2);return this},_.prototype.swap64=function(){var f=this.length;if(f%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var g=0;g<f;g+=8)T(this,g,g+7),T(this,g+1,g+6),T(this,g+2,g+5),T(this,g+3,g+4);return this},_.prototype.toLocaleString=_.prototype.toString=function(){var f=this.length;return 0===f?"":0===arguments.length?ot(this,0,f):O.apply(this,arguments)},_.prototype.equals=function(f){if(!_.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f||0===_.compare(this,f)},_.prototype.inspect=function(){var f="",g=U.INSPECT_MAX_BYTES;return f=this.toString("hex",0,g).replace(/(.{2})/g,"$1 ").trim(),this.length>g&&(f+=" ... "),"<Buffer "+f+">"},_.prototype.compare=function(f,g,y,D,L){if(R(f,Uint8Array)&&(f=_.from(f,f.offset,f.byteLength)),!_.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof f);if(void 0===g&&(g=0),void 0===y&&(y=f?f.length:0),void 0===D&&(D=0),void 0===L&&(L=this.length),0>g||y>f.length||0>D||L>this.length)throw new RangeError("out of range index");if(D>=L&&g>=y)return 0;if(D>=L)return-1;if(g>=y)return 1;if(this===f)return 0;for(var j=(L>>>=0)-(D>>>=0),re=(y>>>=0)-(g>>>=0),$e=G(j,re),Xe=this.slice(D,L),Ze=f.slice(g,y),Ye=0;Ye<$e;++Ye)if(Xe[Ye]!==Ze[Ye]){j=Xe[Ye],re=Ze[Ye];break}return j<re?-1:re<j?1:0},_.prototype.includes=function(f,g,y){return-1!==this.indexOf(f,g,y)},_.prototype.indexOf=function(f,g,y){return P(this,f,g,y,!0)},_.prototype.lastIndexOf=function(f,g,y){return P(this,f,g,y,!1)},_.prototype.write=function(f,g,y,D){if(void 0===g)D="utf8",y=this.length,g=0;else if(void 0===y&&"string"==typeof g)D=g,y=this.length,g=0;else{if(!isFinite(g))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");g>>>=0,isFinite(y)?(y>>>=0,void 0===D&&(D="utf8")):(D=y,y=void 0)}var L=this.length-g;if((void 0===y||y>L)&&(y=L),0<f.length&&(0>y||0>g)||g>this.length)throw new RangeError("Attempt to write outside buffer bounds");D||(D="utf8");for(var j=!1;;)switch(D){case"hex":return x(this,f,g,y);case"utf8":case"utf-8":return N(this,f,g,y);case"ascii":return J(this,f,g,y);case"latin1":case"binary":return ie(this,f,g,y);case"base64":return Ce(this,f,g,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Fe(this,f,g,y);default:if(j)throw new TypeError("Unknown encoding: "+D);D=(""+D).toLowerCase(),j=!0}},_.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},_.prototype.slice=function(f,g){var y=this.length;0>(f=~~f)?0>(f+=y)&&(f=0):f>y&&(f=y),0>(g=void 0===g?y:~~g)?0>(g+=y)&&(g=0):g>y&&(g=y),g<f&&(g=f);var D=this.subarray(f,g);return D.__proto__=_.prototype,D},_.prototype.readUIntLE=function(f,g,y){f>>>=0,g>>>=0,y||at(f,g,this.length);for(var D=this[f],L=1,j=0;++j<g&&(L*=256);)D+=this[f+j]*L;return D},_.prototype.readUIntBE=function(f,g,y){f>>>=0,g>>>=0,y||at(f,g,this.length);for(var D=this[f+--g],L=1;0<g&&(L*=256);)D+=this[f+--g]*L;return D},_.prototype.readUInt8=function(f,g){return f>>>=0,g||at(f,1,this.length),this[f]},_.prototype.readUInt16LE=function(f,g){return f>>>=0,g||at(f,2,this.length),this[f]|this[f+1]<<8},_.prototype.readUInt16BE=function(f,g){return f>>>=0,g||at(f,2,this.length),this[f]<<8|this[f+1]},_.prototype.readUInt32LE=function(f,g){return f>>>=0,g||at(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+16777216*this[f+3]},_.prototype.readUInt32BE=function(f,g){return f>>>=0,g||at(f,4,this.length),16777216*this[f]+(this[f+1]<<16|this[f+2]<<8|this[f+3])},_.prototype.readIntLE=function(f,g,y){f>>>=0,g>>>=0,y||at(f,g,this.length);for(var D=this[f],L=1,j=0;++j<g&&(L*=256);)D+=this[f+j]*L;return D>=(L*=128)&&(D-=Re(2,8*g)),D},_.prototype.readIntBE=function(f,g,y){f>>>=0,g>>>=0,y||at(f,g,this.length);for(var D=g,L=1,j=this[f+--D];0<D&&(L*=256);)j+=this[f+--D]*L;return j>=(L*=128)&&(j-=Re(2,8*g)),j},_.prototype.readInt8=function(f,g){return f>>>=0,g||at(f,1,this.length),128&this[f]?-1*(255-this[f]+1):this[f]},_.prototype.readInt16LE=function(f,g){f>>>=0,g||at(f,2,this.length);var y=this[f]|this[f+1]<<8;return 32768&y?4294901760|y:y},_.prototype.readInt16BE=function(f,g){f>>>=0,g||at(f,2,this.length);var y=this[f+1]|this[f]<<8;return 32768&y?4294901760|y:y},_.prototype.readInt32LE=function(f,g){return f>>>=0,g||at(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},_.prototype.readInt32BE=function(f,g){return f>>>=0,g||at(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},_.prototype.readFloatLE=function(f,g){return f>>>=0,g||at(f,4,this.length),de.read(this,f,!0,23,4)},_.prototype.readFloatBE=function(f,g){return f>>>=0,g||at(f,4,this.length),de.read(this,f,!1,23,4)},_.prototype.readDoubleLE=function(f,g){return f>>>=0,g||at(f,8,this.length),de.read(this,f,!0,52,8)},_.prototype.readDoubleBE=function(f,g){return f>>>=0,g||at(f,8,this.length),de.read(this,f,!1,52,8)},_.prototype.writeUIntLE=function(f,g,y,D){f=+f,g>>>=0,y>>>=0,D||lt(this,f,g,y,Re(2,8*y)-1,0);var j=1,re=0;for(this[g]=255&f;++re<y&&(j*=256);)this[g+re]=255&f/j;return g+y},_.prototype.writeUIntBE=function(f,g,y,D){f=+f,g>>>=0,y>>>=0,D||lt(this,f,g,y,Re(2,8*y)-1,0);var j=y-1,re=1;for(this[g+j]=255&f;0<=--j&&(re*=256);)this[g+j]=255&f/re;return g+y},_.prototype.writeUInt8=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,1,255,0),this[g]=255&f,g+1},_.prototype.writeUInt16LE=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,2,65535,0),this[g]=255&f,this[g+1]=f>>>8,g+2},_.prototype.writeUInt16BE=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,2,65535,0),this[g]=f>>>8,this[g+1]=255&f,g+2},_.prototype.writeUInt32LE=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,4,4294967295,0),this[g+3]=f>>>24,this[g+2]=f>>>16,this[g+1]=f>>>8,this[g]=255&f,g+4},_.prototype.writeUInt32BE=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,4,4294967295,0),this[g]=f>>>24,this[g+1]=f>>>16,this[g+2]=f>>>8,this[g+3]=255&f,g+4},_.prototype.writeIntLE=function(f,g,y,D){if(f=+f,g>>>=0,!D){var L=Re(2,8*y-1);lt(this,f,g,y,L-1,-L)}var j=0,re=1,$e=0;for(this[g]=255&f;++j<y&&(re*=256);)0>f&&0===$e&&0!==this[g+j-1]&&($e=1),this[g+j]=255&(f/re>>0)-$e;return g+y},_.prototype.writeIntBE=function(f,g,y,D){if(f=+f,g>>>=0,!D){var L=Re(2,8*y-1);lt(this,f,g,y,L-1,-L)}var j=y-1,re=1,$e=0;for(this[g+j]=255&f;0<=--j&&(re*=256);)0>f&&0===$e&&0!==this[g+j+1]&&($e=1),this[g+j]=255&(f/re>>0)-$e;return g+y},_.prototype.writeInt8=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,1,127,-128),0>f&&(f=255+f+1),this[g]=255&f,g+1},_.prototype.writeInt16LE=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,2,32767,-32768),this[g]=255&f,this[g+1]=f>>>8,g+2},_.prototype.writeInt16BE=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,2,32767,-32768),this[g]=f>>>8,this[g+1]=255&f,g+2},_.prototype.writeInt32LE=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,4,2147483647,-2147483648),this[g]=255&f,this[g+1]=f>>>8,this[g+2]=f>>>16,this[g+3]=f>>>24,g+4},_.prototype.writeInt32BE=function(f,g,y){return f=+f,g>>>=0,y||lt(this,f,g,4,2147483647,-2147483648),0>f&&(f=4294967295+f+1),this[g]=f>>>24,this[g+1]=f>>>16,this[g+2]=f>>>8,this[g+3]=255&f,g+4},_.prototype.writeFloatLE=function(f,g,y){return Fn(this,f,g,!0,y)},_.prototype.writeFloatBE=function(f,g,y){return Fn(this,f,g,!1,y)},_.prototype.writeDoubleLE=function(f,g,y){return Ir(this,f,g,!0,y)},_.prototype.writeDoubleBE=function(f,g,y){return Ir(this,f,g,!1,y)},_.prototype.copy=function(f,g,y,D){if(!_.isBuffer(f))throw new TypeError("argument should be a Buffer");if(y||(y=0),D||0===D||(D=this.length),g>=f.length&&(g=f.length),g||(g=0),0<D&&D<y&&(D=y),D===y||0===f.length||0===this.length)return 0;if(0>g)throw new RangeError("targetStart out of bounds");if(0>y||y>=this.length)throw new RangeError("Index out of range");if(0>D)throw new RangeError("sourceEnd out of bounds");D>this.length&&(D=this.length),f.length-g<D-y&&(D=f.length-g+y);var L=D-y;if(this===f&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(g,y,D);else if(this===f&&y<g&&g<D)for(var j=L-1;0<=j;--j)f[j+g]=this[j+y];else Uint8Array.prototype.set.call(f,this.subarray(y,D),g);return L},_.prototype.fill=function(f,g,y,D){if("string"==typeof f){if("string"==typeof g?(D=g,g=0,y=this.length):"string"==typeof y&&(D=y,y=this.length),void 0!==D&&"string"!=typeof D)throw new TypeError("encoding must be a string");if("string"==typeof D&&!_.isEncoding(D))throw new TypeError("Unknown encoding: "+D);if(1===f.length){var L=f.charCodeAt(0);("utf8"===D&&128>L||"latin1"===D)&&(f=L)}}else"number"==typeof f&&(f&=255);if(0>g||this.length<g||this.length<y)throw new RangeError("Out of range index");if(y<=g)return this;var j;if(g>>>=0,y=void 0===y?this.length:y>>>0,f||(f=0),"number"==typeof f)for(j=g;j<y;++j)this[j]=f;else{var re=_.isBuffer(f)?f:_.from(f,D),$e=re.length;if(0===$e)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(j=0;j<y-g;++j)this[j+g]=re[j%$e]}return this};var Ue=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,K("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(K,le,U){(function(M){(function(){U.formatArgs=function(_){if(_[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+_[0]+(this.useColors?"%c ":" ")+"+"+le.exports.humanize(this.diff),!this.useColors)return;const A="color: "+this.color;_.splice(1,0,A,"color: inherit");let I=0,C=0;_[0].replace(/%[a-zA-Z%]/g,F=>{"%%"===F||(I++,"%c"===F&&(C=I))}),_.splice(C,0,A)},U.save=function(_){try{_?U.storage.setItem("debug",_):U.storage.removeItem("debug")}catch{}},U.load=function G(){let _;try{_=U.storage.getItem("debug")}catch{}return!_&&typeof M<"u"&&"env"in M&&(_=M.env.DEBUG),_},U.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},U.storage=function(){try{return localStorage}catch{}}(),U.destroy=(()=>{let _=!1;return()=>{_||(_=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),U.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],U.log=console.debug||console.log||(()=>{}),le.exports=K("./common")(U);const{formatters:Q}=le.exports;Q.j=function(_){try{return JSON.stringify(_)}catch(A){return"[UnexpectedJSONParseError]: "+A.message}}}).call(this)}).call(this,K("_process"))},{"./common":5,_process:12}],5:[function(K,le){le.exports=function(U){function M(_){function A(...F){if(!A.enabled)return;const V=A,$=+new Date;V.diff=$-(I||$),V.prev=I,V.curr=$,I=$,F[0]=M.coerce(F[0]),"string"!=typeof F[0]&&F.unshift("%O");let b=0;F[0]=F[0].replace(/%([a-zA-Z%])/g,(E,O)=>{if("%%"===E)return"%";b++;const T=M.formatters[O];return"function"==typeof T&&(E=T.call(V,F[b]),F.splice(b,1),b--),E}),M.formatArgs.call(V,F),(V.log||M.log).apply(V,F)}let I,C=null;return A.namespace=_,A.useColors=M.useColors(),A.color=M.selectColor(_),A.extend=G,A.destroy=M.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>null===C?M.enabled(_):C,set:F=>{C=F}}),"function"==typeof M.init&&M.init(A),A}function G(_,A){const I=M(this.namespace+(typeof A>"u"?":":A)+_);return I.log=this.log,I}function Q(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}return M.debug=M,M.default=M,M.coerce=function(_){return _ instanceof Error?_.stack||_.message:_},M.disable=function(){const _=[...M.names.map(Q),...M.skips.map(Q).map(A=>"-"+A)].join(",");return M.enable(""),_},M.enable=function(_){let A;M.save(_),M.names=[],M.skips=[];const I=("string"==typeof _?_:"").split(/[\s,]+/),C=I.length;for(A=0;A<C;A++)I[A]&&("-"===(_=I[A].replace(/\*/g,".*?"))[0]?M.skips.push(new RegExp("^"+_.substr(1)+"$")):M.names.push(new RegExp("^"+_+"$")))},M.enabled=function(_){if("*"===_[_.length-1])return!0;let A,I;for(A=0,I=M.skips.length;A<I;A++)if(M.skips[A].test(_))return!1;for(A=0,I=M.names.length;A<I;A++)if(M.names[A].test(_))return!0;return!1},M.humanize=K("ms"),M.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(U).forEach(_=>{M[_]=U[_]}),M.names=[],M.skips=[],M.formatters={},M.selectColor=function(_){let A=0;for(let I=0;I<_.length;I++)A=(A<<5)-A+_.charCodeAt(I),A|=0;return M.colors[ds(A)%M.colors.length]},M.enable(M.load()),M}},{ms:11}],6:[function(K,le){"use strict";function U(M,G){for(const Q in G)Object.defineProperty(M,Q,{value:G[Q],enumerable:!0,configurable:!0});return M}le.exports=function(M,G,Q){if(!M||"string"==typeof M)throw new TypeError("Please pass an Error to err-code");Q||(Q={}),"object"==typeof G&&(Q=G,G=""),G&&(Q.code=G);try{return U(M,Q)}catch{Q.message=M.message,Q.stack=M.stack;const A=function(){};return A.prototype=Object.create(Object.getPrototypeOf(M)),U(new A,Q)}}},{}],7:[function(K,le){"use strict";function M(){M.init.call(this)}function G(x){if("function"!=typeof x)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof x)}function Q(x){return void 0===x._maxListeners?M.defaultMaxListeners:x._maxListeners}function _(x,N,J,ie){var Ce,Fe,Ge;if(G(J),void 0===(Fe=x._events)?(Fe=x._events=Object.create(null),x._eventsCount=0):(void 0!==Fe.newListener&&(x.emit("newListener",N,J.listener?J.listener:J),Fe=x._events),Ge=Fe[N]),void 0===Ge)Ge=Fe[N]=J,++x._eventsCount;else if("function"==typeof Ge?Ge=Fe[N]=ie?[J,Ge]:[Ge,J]:ie?Ge.unshift(J):Ge.push(J),0<(Ce=Q(x))&&Ge.length>Ce&&!Ge.warned){Ge.warned=!0;var ot=new Error("Possible EventEmitter memory leak detected. "+Ge.length+" "+N+" listeners added. Use emitter.setMaxListeners() to increase limit");ot.name="MaxListenersExceededWarning",ot.emitter=x,ot.type=N,ot.count=Ge.length,function U(x){console&&console.warn&&console.warn(x)}(ot)}return x}function A(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function I(x,N,J){var ie={fired:!1,wrapFn:void 0,target:x,type:N,listener:J},Ce=A.bind(ie);return Ce.listener=J,ie.wrapFn=Ce,Ce}function C(x,N,J){var ie=x._events;if(void 0===ie)return[];var Ce=ie[N];return void 0===Ce?[]:"function"==typeof Ce?J?[Ce.listener||Ce]:[Ce]:J?function q(x){for(var N=Array(x.length),J=0;J<N.length;++J)N[J]=x[J].listener||x[J];return N}(Ce):V(Ce,Ce.length)}function F(x){var N=this._events;if(void 0!==N){var J=N[x];if("function"==typeof J)return 1;if(void 0!==J)return J.length}return 0}function V(x,N){for(var J=Array(N),ie=0;ie<N;++ie)J[ie]=x[ie];return J}function S(x,N,J,ie){if("function"==typeof x.on)ie.once?x.once(N,J):x.on(N,J);else{if("function"!=typeof x.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof x);x.addEventListener(N,function Ce(Fe){ie.once&&x.removeEventListener(N,Ce),J(Fe)})}}var E,O="object"==typeof Reflect?Reflect:null,T=O&&"function"==typeof O.apply?O.apply:function(x,N,J){return Function.prototype.apply.call(x,N,J)};E=O&&"function"==typeof O.ownKeys?O.ownKeys:Object.getOwnPropertySymbols?function(x){return Object.getOwnPropertyNames(x).concat(Object.getOwnPropertySymbols(x))}:function(x){return Object.getOwnPropertyNames(x)};var P=Number.isNaN||function(x){return x!=x};le.exports=M,le.exports.once=function(x,N){return new Promise(function(J,ie){function Ce(Ge){x.removeListener(N,Fe),ie(Ge)}function Fe(){"function"==typeof x.removeListener&&x.removeListener("error",Ce),J([].slice.call(arguments))}S(x,N,Fe,{once:!0}),"error"!==N&&function b(x,N,J){"function"==typeof x.on&&S(x,"error",N,J)}(x,Ce,{once:!0})})},M.EventEmitter=M,M.prototype._events=void 0,M.prototype._eventsCount=0,M.prototype._maxListeners=void 0;var W=10;Object.defineProperty(M,"defaultMaxListeners",{enumerable:!0,get:function(){return W},set:function(x){if("number"!=typeof x||0>x||P(x))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+x+".");W=x}}),M.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},M.prototype.setMaxListeners=function(x){if("number"!=typeof x||0>x||P(x))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+x+".");return this._maxListeners=x,this},M.prototype.getMaxListeners=function(){return Q(this)},M.prototype.emit=function(x){for(var N=[],J=1;J<arguments.length;J++)N.push(arguments[J]);var ie="error"===x,Ce=this._events;if(void 0!==Ce)ie=ie&&void 0===Ce.error;else if(!ie)return!1;if(ie){var Fe;if(0<N.length&&(Fe=N[0]),Fe instanceof Error)throw Fe;var Ge=new Error("Unhandled error."+(Fe?" ("+Fe.message+")":""));throw Ge.context=Fe,Ge}var ot=Ce[x];if(void 0===ot)return!1;if("function"==typeof ot)T(ot,this,N);else{var an=ot.length,we=V(ot,an);for(J=0;J<an;++J)T(we[J],this,N)}return!0},M.prototype.on=M.prototype.addListener=function(x,N){return _(this,x,N,!1)},M.prototype.prependListener=function(x,N){return _(this,x,N,!0)},M.prototype.once=function(x,N){return G(N),this.on(x,I(this,x,N)),this},M.prototype.prependOnceListener=function(x,N){return G(N),this.prependListener(x,I(this,x,N)),this},M.prototype.off=M.prototype.removeListener=function(x,N){var J,ie,Ce,Fe,Ge;if(G(N),void 0===(ie=this._events))return this;if(void 0===(J=ie[x]))return this;if(J===N||J.listener===N)0==--this._eventsCount?this._events=Object.create(null):(delete ie[x],ie.removeListener&&this.emit("removeListener",x,J.listener||N));else if("function"!=typeof J){for(Ce=-1,Fe=J.length-1;0<=Fe;Fe--)if(J[Fe]===N||J[Fe].listener===N){Ge=J[Fe].listener,Ce=Fe;break}if(0>Ce)return this;0===Ce?J.shift():function $(x,N){for(;N+1<x.length;N++)x[N]=x[N+1];x.pop()}(J,Ce),1===J.length&&(ie[x]=J[0]),void 0!==ie.removeListener&&this.emit("removeListener",x,Ge||N)}return this},M.prototype.removeAllListeners=function(x){var N,J,ie;if(void 0===(J=this._events))return this;if(void 0===J.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==J[x]&&(0==--this._eventsCount?this._events=Object.create(null):delete J[x]),this;if(0===arguments.length){var Ce,Fe=Object.keys(J);for(ie=0;ie<Fe.length;++ie)"removeListener"!==(Ce=Fe[ie])&&this.removeAllListeners(Ce);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(N=J[x]))this.removeListener(x,N);else if(void 0!==N)for(ie=N.length-1;0<=ie;ie--)this.removeListener(x,N[ie]);return this},M.prototype.listeners=function(x){return C(this,x,!0)},M.prototype.rawListeners=function(x){return C(this,x,!1)},M.listenerCount=function(x,N){return"function"==typeof x.listenerCount?x.listenerCount(N):F.call(x,N)},M.prototype.listenerCount=F,M.prototype.eventNames=function(){return 0<this._eventsCount?E(this._events):[]}},{}],8:[function(K,le){le.exports=function(){if(typeof globalThis>"u")return null;var U={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return U.RTCPeerConnection?U:null}},{}],9:[function(K,le,U){U.read=function(M,G,Q,_,A){var I,C,F=8*A-_-1,V=(1<<F)-1,$=V>>1,q=-7,b=Q?A-1:0,S=Q?-1:1,E=M[G+b];for(b+=S,I=E&(1<<-q)-1,E>>=-q,q+=F;0<q;I=256*I+M[G+b],b+=S,q-=8);for(C=I&(1<<-q)-1,I>>=-q,q+=_;0<q;C=256*C+M[G+b],b+=S,q-=8);if(0===I)I=1-$;else{if(I===V)return C?NaN:1/0*(E?-1:1);C+=Re(2,_),I-=$}return(E?-1:1)*C*Re(2,I-_)},U.write=function(M,G,Q,_,A,I){var C,F,V,$=Math.LN2,q=Math.log,b=8*I-A-1,S=(1<<b)-1,E=S>>1,O=23===A?Re(2,-24)-Re(2,-77):0,T=_?0:I-1,P=_?1:-1,W=0>G||0===G&&0>1/G?1:0;for(G=ds(G),isNaN(G)||G===1/0?(F=isNaN(G)?1:0,C=S):(C=us(q(G)/$),1>G*(V=Re(2,-C))&&(C--,V*=2),2<=(G+=1<=C+E?O/V:O*Re(2,1-E))*V&&(C++,V/=2),C+E>=S?(F=0,C=S):1<=C+E?(F=(G*V-1)*Re(2,A),C+=E):(F=G*Re(2,E-1)*Re(2,A),C=0));8<=A;M[Q+T]=255&F,T+=P,F/=256,A-=8);for(C=C<<A|F,b+=A;0<b;M[Q+T]=255&C,T+=P,C/=256,b-=8);M[Q+T-P]|=128*W}},{}],10:[function(K,le){le.exports="function"==typeof Object.create?function(U,M){M&&(U.super_=M,U.prototype=Object.create(M.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}))}:function(U,M){if(M){U.super_=M;var G=function(){};G.prototype=M.prototype,U.prototype=new G,U.prototype.constructor=U}}},{}],11:[function(K,le){var U=Math.round;function _(I,C,F,V){return U(I/F)+" "+V+(C>=1.5*F?"s":"")}le.exports=function(I,C){C=C||{};var F=typeof I;if("string"==F&&0<I.length)return function M(I){if(!(100<(I+="").length)){var C=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(I);if(C){var F=parseFloat(C[1]),V=(C[2]||"ms").toLowerCase();return"years"===V||"year"===V||"yrs"===V||"yr"===V||"y"===V?315576e5*F:"weeks"===V||"week"===V||"w"===V?6048e5*F:"days"===V||"day"===V||"d"===V?864e5*F:"hours"===V||"hour"===V||"hrs"===V||"hr"===V||"h"===V?36e5*F:"minutes"===V||"minute"===V||"mins"===V||"min"===V||"m"===V?6e4*F:"seconds"===V||"second"===V||"secs"===V||"sec"===V||"s"===V?1e3*F:"milliseconds"===V||"millisecond"===V||"msecs"===V||"msec"===V||"ms"===V?F:void 0}}}(I);if("number"===F&&isFinite(I))return C.long?function Q(I){var C=ds(I);return 864e5<=C?_(I,C,864e5,"day"):36e5<=C?_(I,C,36e5,"hour"):6e4<=C?_(I,C,6e4,"minute"):1e3<=C?_(I,C,1e3,"second"):I+" ms"}(I):function G(I){var C=ds(I);return 864e5<=C?U(I/864e5)+"d":36e5<=C?U(I/36e5)+"h":6e4<=C?U(I/6e4)+"m":1e3<=C?U(I/1e3)+"s":I+"ms"}(I);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(I))}},{}],12:[function(K,le){function U(){throw new Error("setTimeout has not been defined")}function M(){throw new Error("clearTimeout has not been defined")}function G(O){if(F===setTimeout)return setTimeout(O,0);if((F===U||!F)&&setTimeout)return F=setTimeout,setTimeout(O,0);try{return F(O,0)}catch{try{return F.call(null,O,0)}catch{return F.call(this,O,0)}}}function _(){S&&q&&(S=!1,q.length?b=q.concat(b):E=-1,b.length&&A())}function A(){if(!S){var O=G(_);S=!0;for(var T=b.length;T;){for(q=b,b=[];++E<T;)q&&q[E].run();E=-1,T=b.length}q=null,S=!1,function Q(O){if(V===clearTimeout)return clearTimeout(O);if((V===M||!V)&&clearTimeout)return V=clearTimeout,clearTimeout(O);try{return V(O)}catch{try{return V.call(null,O)}catch{return V.call(this,O)}}}(O)}}function I(O,T){this.fun=O,this.array=T}function C(){}var F,V,$=le.exports={};!function(){try{F="function"==typeof setTimeout?setTimeout:U}catch{F=U}try{V="function"==typeof clearTimeout?clearTimeout:M}catch{V=M}}();var q,b=[],S=!1,E=-1;$.nextTick=function(O){var T=Array(arguments.length-1);if(1<arguments.length)for(var P=1;P<arguments.length;P++)T[P-1]=arguments[P];b.push(new I(O,T)),1!==b.length||S||G(A)},I.prototype.run=function(){this.fun.apply(null,this.array)},$.title="browser",$.browser=!0,$.env={},$.argv=[],$.version="",$.versions={},$.on=C,$.addListener=C,$.once=C,$.off=C,$.removeListener=C,$.removeAllListeners=C,$.emit=C,$.prependListener=C,$.prependOnceListener=C,$.listeners=function(){return[]},$.binding=function(){throw new Error("process.binding is not supported")},$.cwd=function(){return"/"},$.chdir=function(){throw new Error("process.chdir is not supported")},$.umask=function(){return 0}},{}],13:[function(K,le){(function(U){(function(){let M;le.exports="function"==typeof queueMicrotask?queueMicrotask.bind(typeof window>"u"?U:window):G=>(M||(M=Promise.resolve())).then(G).catch(Q=>setTimeout(()=>{throw Q},0))}).call(this)}).call(this,typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{}],14:[function(K,le){(function(U,M){(function(){"use strict";var G=K("safe-buffer").Buffer,Q=M.crypto||M.msCrypto;le.exports=Q&&Q.getRandomValues?function(_,A){if(_>4294967295)throw new RangeError("requested too many random bytes");var I=G.allocUnsafe(_);if(0<_)if(65536<_)for(var C=0;C<_;C+=65536)Q.getRandomValues(I.slice(C,C+65536));else Q.getRandomValues(I);return"function"==typeof A?U.nextTick(function(){A(null,I)}):I}:function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this)}).call(this,K("_process"),typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{_process:12,"safe-buffer":30}],15:[function(K,le){"use strict";function M(C,F,V){V||(V=Error);var q=function(b){function S(E,O,T){return b.call(this,function $(b,S,E){return"string"==typeof F?F:F(b,S,E)}(E,O,T))||this}return function U(C,F){C.prototype=Object.create(F.prototype),C.prototype.constructor=C,C.__proto__=F}(S,b),S}(V);q.prototype.name=V.name,q.prototype.code=C,I[C]=q}function G(C,F){if(Array.isArray(C)){var V=C.length;return C=C.map(function($){return $+""}),2<V?"one of ".concat(F," ").concat(C.slice(0,V-1).join(", "),", or ")+C[V-1]:2===V?"one of ".concat(F," ").concat(C[0]," or ").concat(C[1]):"of ".concat(F," ").concat(C[0])}return"of ".concat(F," ").concat(C+"")}var I={};M("ERR_INVALID_OPT_VALUE",function(C,F){return'The value "'+F+'" is invalid for option "'+C+'"'},TypeError),M("ERR_INVALID_ARG_TYPE",function(C,F,V){var $,q;if("string"==typeof F&&function Q(C,F,V){return C.substr(!V||0>V?0:+V,F.length)===F}(F,"not ")?($="must not be",F=F.replace(/^not /,"")):$="must be",function _(C,F,V){return(void 0===V||V>C.length)&&(V=C.length),C.substring(V-F.length,V)===F}(C," argument"))q="The ".concat(C," ").concat($," ").concat(G(F,"type"));else{var b=function A(C,F,V){return"number"!=typeof V&&(V=0),!(V+F.length>C.length)&&-1!==C.indexOf(F,V)}(C,".")?"property":"argument";q='The "'.concat(C,'" ').concat(b," ").concat($," ").concat(G(F,"type"))}return q+". Received type ".concat(typeof V)},TypeError),M("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),M("ERR_METHOD_NOT_IMPLEMENTED",function(C){return"The "+C+" method is not implemented"}),M("ERR_STREAM_PREMATURE_CLOSE","Premature close"),M("ERR_STREAM_DESTROYED",function(C){return"Cannot call "+C+" after a stream was destroyed"}),M("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),M("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),M("ERR_STREAM_WRITE_AFTER_END","write after end"),M("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),M("ERR_UNKNOWN_ENCODING",function(C){return"Unknown encoding: "+C},TypeError),M("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),le.exports.codes=I},{}],16:[function(K,le){(function(U){(function(){"use strict";function M($){return this instanceof M?(A.call(this,$),I.call(this,$),this.allowHalfOpen=!0,void($&&(!1===$.readable&&(this.readable=!1),!1===$.writable&&(this.writable=!1),!1===$.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",G))))):new M($)}function G(){this._writableState.ended||U.nextTick(Q,this)}function Q($){$.end()}var _=Object.keys||function($){var q=[];for(var b in $)q.push(b);return q};le.exports=M;var A=K("./_stream_readable"),I=K("./_stream_writable");K("inherits")(M,A);for(var C,F=_(I.prototype),V=0;V<F.length;V++)M.prototype[C=F[V]]||(M.prototype[C]=I.prototype[C]);Object.defineProperty(M.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(M.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(M.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function($){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=$,this._writableState.destroyed=$)}})}).call(this)}).call(this,K("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(K,le){"use strict";function U(G){return this instanceof U?void M.call(this,G):new U(G)}le.exports=U;var M=K("./_stream_transform");K("inherits")(U,M),U.prototype._transform=function(G,Q,_){_(null,G)}},{"./_stream_transform":19,inherits:10}],18:[function(K,le){(function(U,M){(function(){"use strict";function A(f,g,y){an=an||K("./_stream_duplex"),"boolean"!=typeof y&&(y=g instanceof an),this.objectMode=!!(f=f||{}).objectMode,y&&(this.objectMode=this.objectMode||!!f.readableObjectMode),this.highWaterMark=Ni(this,f,"readableHighWaterMark",y),this.buffer=new wt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==f.emitClose,this.autoDestroy=!!f.autoDestroy,this.destroyed=!1,this.defaultEncoding=f.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,f.encoding&&(!Fn&&(Fn=K("string_decoder/").StringDecoder),this.decoder=new Fn(f.encoding),this.encoding=f.encoding)}function I(f){if(an=an||K("./_stream_duplex"),!(this instanceof I))return new I(f);this._readableState=new A(f,this,this instanceof an),this.readable=!0,f&&("function"==typeof f.read&&(this._read=f.read),"function"==typeof f.destroy&&(this._destroy=f.destroy)),Ar.call(this)}function C(f,g,y,D,L){we("readableAddChunk",g);var re,j=f._readableState;if(null===g)j.reading=!1,function b(f,g){if(we("onEofChunk"),!g.ended){if(g.decoder){var y=g.decoder.end();y&&y.length&&(g.buffer.push(y),g.length+=g.objectMode?1:y.length)}g.ended=!0,g.sync?S(f):(g.needReadable=!1,!g.emittedReadable&&(g.emittedReadable=!0,E(f)))}}(f,j);else if(L||(re=function V(f,g){var y;return function Q(f){return at.isBuffer(f)||f instanceof lt}(g)||"string"==typeof g||void 0===g||f.objectMode||(y=new Pn("chunk",["string","Buffer","Uint8Array"],g)),y}(j,g)),re)de(f,re);else if(j.objectMode||g&&0<g.length)if("string"==typeof g||j.objectMode||Object.getPrototypeOf(g)===at.prototype||(g=function G(f){return at.from(f)}(g)),D)j.endEmitted?de(f,new ne):F(f,j,g,!0);else if(j.ended)de(f,new R);else{if(j.destroyed)return!1;j.reading=!1,j.decoder&&!y?(g=j.decoder.write(g),j.objectMode||0!==g.length?F(f,j,g,!1):O(f,j)):F(f,j,g,!1)}else D||(j.reading=!1,O(f,j));return!j.ended&&(j.length<j.highWaterMark||0===j.length)}function F(f,g,y,D){g.flowing&&0===g.length&&!g.sync?(g.awaitDrain=0,f.emit("data",y)):(g.length+=g.objectMode?1:y.length,D?g.buffer.unshift(y):g.buffer.push(y),g.needReadable&&S(f)),O(f,g)}function q(f,g){return 0>=f||0===g.length&&g.ended?0:g.objectMode?1:f==f?(f>g.highWaterMark&&(g.highWaterMark=function $(f){return 1073741824<=f?f=1073741824:(f--,f|=f>>>1,f|=f>>>2,f|=f>>>4,f|=f>>>8,f|=f>>>16,f++),f}(f)),f<=g.length?f:g.ended?g.length:(g.needReadable=!0,0)):g.flowing&&g.length?g.buffer.head.data.length:g.length}function S(f){var g=f._readableState;we("emitReadable",g.needReadable,g.emittedReadable),g.needReadable=!1,g.emittedReadable||(we("emitReadable",g.flowing),g.emittedReadable=!0,U.nextTick(E,f))}function E(f){var g=f._readableState;we("emitReadable_",g.destroyed,g.length,g.ended),!g.destroyed&&(g.length||g.ended)&&(f.emit("readable"),g.emittedReadable=!1),g.needReadable=!g.flowing&&!g.ended&&g.length<=g.highWaterMark,ie(f)}function O(f,g){g.readingMore||(g.readingMore=!0,U.nextTick(T,f,g))}function T(f,g){for(;!g.reading&&!g.ended&&(g.length<g.highWaterMark||g.flowing&&0===g.length);){var y=g.length;if(we("maybeReadMore read 0"),f.read(0),y===g.length)break}g.readingMore=!1}function W(f){var g=f._readableState;g.readableListening=0<f.listenerCount("readable"),g.resumeScheduled&&!g.paused?g.flowing=!0:0<f.listenerCount("data")&&f.resume()}function x(f){we("readable nexttick read 0"),f.read(0)}function J(f,g){we("resume",g.reading),g.reading||f.read(0),g.resumeScheduled=!1,f.emit("resume"),ie(f),g.flowing&&!g.reading&&f.read(0)}function ie(f){var g=f._readableState;for(we("flow",g.flowing);g.flowing&&null!==f.read(););}function Ce(f,g){return 0===g.length?null:(g.objectMode?y=g.buffer.shift():!f||f>=g.length?(y=g.decoder?g.buffer.join(""):1===g.buffer.length?g.buffer.first():g.buffer.concat(g.length),g.buffer.clear()):y=g.buffer.consume(f,g.decoder),y);var y}function Fe(f){var g=f._readableState;we("endReadable",g.endEmitted),g.endEmitted||(g.ended=!0,U.nextTick(Ge,g,f))}function Ge(f,g){if(we("endReadableNT",f.endEmitted,f.length),!f.endEmitted&&0===f.length&&(f.endEmitted=!0,g.readable=!1,g.emit("end"),f.autoDestroy)){var y=g._writableState;(!y||y.autoDestroy&&y.finished)&&g.destroy()}}function ot(f,g){for(var y=0,D=f.length;y<D;y++)if(f[y]===g)return y;return-1}var an;le.exports=I,I.ReadableState=A,K("events");var we,Tr=function(f,g){return f.listeners(g).length},Ar=K("./internal/streams/stream"),at=K("buffer").Buffer,lt=M.Uint8Array||function(){},qt=K("util");we=qt&&qt.debuglog?qt.debuglog("stream"):function(){};var Fn,Ir,ht,wt=K("./internal/streams/buffer_list"),kr=K("./internal/streams/destroy"),Ni=K("./internal/streams/state").getHighWaterMark,bn=K("../errors").codes,Pn=bn.ERR_INVALID_ARG_TYPE,R=bn.ERR_STREAM_PUSH_AFTER_EOF,H=bn.ERR_METHOD_NOT_IMPLEMENTED,ne=bn.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;K("inherits")(I,Ar);var de=kr.errorOrDestroy,Ue=["error","close","destroy","pause","resume"];Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(f){this._readableState&&(this._readableState.destroyed=f)}}),I.prototype.destroy=kr.destroy,I.prototype._undestroy=kr.undestroy,I.prototype._destroy=function(f,g){g(f)},I.prototype.push=function(f,g){var y,D=this._readableState;return D.objectMode?y=!0:"string"==typeof f&&((g=g||D.defaultEncoding)!==D.encoding&&(f=at.from(f,g),g=""),y=!0),C(this,f,g,!1,y)},I.prototype.unshift=function(f){return C(this,f,null,!0,!1)},I.prototype.isPaused=function(){return!1===this._readableState.flowing},I.prototype.setEncoding=function(f){Fn||(Fn=K("string_decoder/").StringDecoder);var g=new Fn(f);this._readableState.decoder=g,this._readableState.encoding=this._readableState.decoder.encoding;for(var y=this._readableState.buffer.head,D="";null!==y;)D+=g.write(y.data),y=y.next;return this._readableState.buffer.clear(),""!==D&&this._readableState.buffer.push(D),this._readableState.length=D.length,this},I.prototype.read=function(f){we("read",f),f=parseInt(f,10);var g=this._readableState,y=f;if(0!==f&&(g.emittedReadable=!1),0===f&&g.needReadable&&((0===g.highWaterMark?0<g.length:g.length>=g.highWaterMark)||g.ended))return we("read: emitReadable",g.length,g.ended),0===g.length&&g.ended?Fe(this):S(this),null;if(0===(f=q(f,g))&&g.ended)return 0===g.length&&Fe(this),null;var L,D=g.needReadable;return we("need readable",D),(0===g.length||g.length-f<g.highWaterMark)&&we("length less than watermark",D=!0),g.ended||g.reading?we("reading or ended",D=!1):D&&(we("do read"),g.reading=!0,g.sync=!0,0===g.length&&(g.needReadable=!0),this._read(g.highWaterMark),g.sync=!1,!g.reading&&(f=q(y,g))),null===(L=0<f?Ce(f,g):null)?(g.needReadable=g.length<=g.highWaterMark,f=0):(g.length-=f,g.awaitDrain=0),0===g.length&&(!g.ended&&(g.needReadable=!0),y!==f&&g.ended&&Fe(this)),null!==L&&this.emit("data",L),L},I.prototype._read=function(){de(this,new H("_read()"))},I.prototype.pipe=function(f,g){function y(eo,to){we("onunpipe"),eo===Ye&&to&&!1===to.hasUnpiped&&(to.hasUnpiped=!0,function L(){we("cleanup"),f.removeListener("close",$e),f.removeListener("finish",Xe),f.removeListener("drain",Xs),f.removeListener("error",re),f.removeListener("unpipe",y),Ye.removeListener("end",D),Ye.removeListener("end",Ze),Ye.removeListener("data",j),yp=!0,qe.awaitDrain&&(!f._writableState||f._writableState.needDrain)&&Xs()}())}function D(){we("onend"),f.end()}function j(eo){we("ondata");var to=f.write(eo);we("dest.write",to),!1===to&&((1===qe.pipesCount&&qe.pipes===f||1<qe.pipesCount&&-1!==ot(qe.pipes,f))&&!yp&&(we("false write response, pause",qe.awaitDrain),qe.awaitDrain++),Ye.pause())}function re(eo){we("onerror",eo),Ze(),f.removeListener("error",re),0===Tr(f,"error")&&de(f,eo)}function $e(){f.removeListener("finish",Xe),Ze()}function Xe(){we("onfinish"),f.removeListener("close",$e),Ze()}function Ze(){we("unpipe"),Ye.unpipe(f)}var Ye=this,qe=this._readableState;switch(qe.pipesCount){case 0:qe.pipes=f;break;case 1:qe.pipes=[qe.pipes,f];break;default:qe.pipes.push(f)}qe.pipesCount+=1,we("pipe count=%d opts=%j",qe.pipesCount,g);var Qs=g&&!1===g.end||f===U.stdout||f===U.stderr?Ze:D;qe.endEmitted?U.nextTick(Qs):Ye.once("end",Qs),f.on("unpipe",y);var Xs=function P(f){return function(){var g=f._readableState;we("pipeOnDrain",g.awaitDrain),g.awaitDrain&&g.awaitDrain--,0===g.awaitDrain&&Tr(f,"data")&&(g.flowing=!0,ie(f))}}(Ye);f.on("drain",Xs);var yp=!1;return Ye.on("data",j),function _(f,g,y){return"function"==typeof f.prependListener?f.prependListener(g,y):void(f._events&&f._events[g]?Array.isArray(f._events[g])?f._events[g].unshift(y):f._events[g]=[y,f._events[g]]:f.on(g,y))}(f,"error",re),f.once("close",$e),f.once("finish",Xe),f.emit("pipe",Ye),qe.flowing||(we("pipe resume"),Ye.resume()),f},I.prototype.unpipe=function(f){var g=this._readableState,y={hasUnpiped:!1};if(0===g.pipesCount)return this;if(1===g.pipesCount)return f&&f!==g.pipes||(f||(f=g.pipes),g.pipes=null,g.pipesCount=0,g.flowing=!1,f&&f.emit("unpipe",this,y)),this;if(!f){var D=g.pipes,L=g.pipesCount;g.pipes=null,g.pipesCount=0,g.flowing=!1;for(var j=0;j<L;j++)D[j].emit("unpipe",this,{hasUnpiped:!1});return this}var re=ot(g.pipes,f);return-1===re||(g.pipes.splice(re,1),g.pipesCount-=1,1===g.pipesCount&&(g.pipes=g.pipes[0]),f.emit("unpipe",this,y)),this},I.prototype.addListener=I.prototype.on=function(f,g){var y=Ar.prototype.on.call(this,f,g),D=this._readableState;return"data"===f?(D.readableListening=0<this.listenerCount("readable"),!1!==D.flowing&&this.resume()):"readable"==f&&!D.endEmitted&&!D.readableListening&&(D.readableListening=D.needReadable=!0,D.flowing=!1,D.emittedReadable=!1,we("on readable",D.length,D.reading),D.length?S(this):!D.reading&&U.nextTick(x,this)),y},I.prototype.removeListener=function(f,g){var y=Ar.prototype.removeListener.call(this,f,g);return"readable"===f&&U.nextTick(W,this),y},I.prototype.removeAllListeners=function(f){var g=Ar.prototype.removeAllListeners.apply(this,arguments);return("readable"===f||void 0===f)&&U.nextTick(W,this),g},I.prototype.resume=function(){var f=this._readableState;return f.flowing||(we("resume"),f.flowing=!f.readableListening,function N(f,g){g.resumeScheduled||(g.resumeScheduled=!0,U.nextTick(J,f,g))}(this,f)),f.paused=!1,this},I.prototype.pause=function(){return we("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(we("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},I.prototype.wrap=function(f){var g=this,y=this._readableState,D=!1;for(var L in f.on("end",function(){if(we("wrapped end"),y.decoder&&!y.ended){var re=y.decoder.end();re&&re.length&&g.push(re)}g.push(null)}),f.on("data",function(re){we("wrapped data"),y.decoder&&(re=y.decoder.write(re)),y.objectMode&&null==re||!(y.objectMode||re&&re.length)||g.push(re)||(D=!0,f.pause())}),f)void 0===this[L]&&"function"==typeof f[L]&&(this[L]=function(re){return function(){return f[re].apply(f,arguments)}}(L));for(var j=0;j<Ue.length;j++)f.on(Ue[j],this.emit.bind(this,Ue[j]));return this._read=function(re){we("wrapped _read",re),D&&(D=!1,f.resume())},this},"function"==typeof Symbol&&(I.prototype[Symbol.asyncIterator]=function(){return void 0===Ir&&(Ir=K("./internal/streams/async_iterator")),Ir(this)}),Object.defineProperty(I.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(I.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(I.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(f){this._readableState&&(this._readableState.flowing=f)}}),I._fromList=Ce,Object.defineProperty(I.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(I.from=function(f,g){return void 0===ht&&(ht=K("./internal/streams/from")),ht(I,f,g)})}).call(this)}).call(this,K("_process"),typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(K,le){"use strict";function U($,q){var b=this._transformState;b.transforming=!1;var S=b.writecb;if(null===S)return this.emit("error",new I);b.writechunk=null,b.writecb=null,null!=q&&this.push(q),S($);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function M($){return this instanceof M?(V.call(this,$),this._transformState={afterTransform:U.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,$&&("function"==typeof $.transform&&(this._transform=$.transform),"function"==typeof $.flush&&(this._flush=$.flush)),void this.on("prefinish",G)):new M($)}function G(){var $=this;"function"!=typeof this._flush||this._readableState.destroyed?Q(this,null,null):this._flush(function(q,b){Q($,q,b)})}function Q($,q,b){if(q)return $.emit("error",q);if(null!=b&&$.push(b),$._writableState.length)throw new F;if($._transformState.transforming)throw new C;return $.push(null)}le.exports=M;var _=K("../errors").codes,A=_.ERR_METHOD_NOT_IMPLEMENTED,I=_.ERR_MULTIPLE_CALLBACK,C=_.ERR_TRANSFORM_ALREADY_TRANSFORMING,F=_.ERR_TRANSFORM_WITH_LENGTH_0,V=K("./_stream_duplex");K("inherits")(M,V),M.prototype.push=function($,q){return this._transformState.needTransform=!1,V.prototype.push.call(this,$,q)},M.prototype._transform=function($,q,b){b(new A("_transform()"))},M.prototype._write=function($,q,b){var S=this._transformState;if(S.writecb=b,S.writechunk=$,S.writeencoding=q,!S.transforming){var E=this._readableState;(S.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},M.prototype._read=function(){var $=this._transformState;null===$.writechunk||$.transforming?$.needTransform=!0:($.transforming=!0,this._transform($.writechunk,$.writeencoding,$.afterTransform))},M.prototype._destroy=function($,q){V.prototype._destroy.call(this,$,function(b){q(b)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(K,le){(function(U,M){(function(){"use strict";function G(R){var H=this;this.next=null,this.entry=null,this.finish=function(){!function Fe(R,H,ne){var de=R.entry;for(R.entry=null;de;){var Ue=de.callback;H.pendingcb--,Ue(ne),de=de.next}H.corkedRequestsFree.next=R}(H,R)}}function A(){}function I(R,H,ne){Ge=Ge||K("./_stream_duplex"),"boolean"!=typeof ne&&(ne=H instanceof Ge),this.objectMode=!!(R=R||{}).objectMode,ne&&(this.objectMode=this.objectMode||!!R.writableObjectMode),this.highWaterMark=at(this,R,"writableHighWaterMark",ne),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===R.decodeStrings),this.defaultEncoding=R.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Ue){!function O(R,H){var ne=R._writableState,de=ne.sync,Ue=ne.writecb;if("function"!=typeof Ue)throw new Ir;if(function E(R){R.writing=!1,R.writecb=null,R.length-=R.writelen,R.writelen=0}(ne),H)!function S(R,H,ne,de,Ue){--H.pendingcb,ne?(U.nextTick(Ue,de),U.nextTick(ie,R,H),R._writableState.errorEmitted=!0,bn(R,de)):(Ue(de),R._writableState.errorEmitted=!0,bn(R,de),ie(R,H))}(R,ne,de,H,Ue);else{var f=x(ne)||R.destroyed;f||ne.corked||ne.bufferProcessing||!ne.bufferedRequest||W(R,ne),de?U.nextTick(T,R,ne,f,Ue):T(R,ne,f,Ue)}}(H,Ue)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==R.emitClose,this.autoDestroy=!!R.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new G(this)}function C(R){var H=this instanceof(Ge=Ge||K("./_stream_duplex"));return H||Pn.call(C,this)?(this._writableState=new I(R,this,H),this.writable=!0,R&&("function"==typeof R.write&&(this._write=R.write),"function"==typeof R.writev&&(this._writev=R.writev),"function"==typeof R.destroy&&(this._destroy=R.destroy),"function"==typeof R.final&&(this._final=R.final)),void an.call(this)):new C(R)}function q(R,H,ne,de,Ue,f){if(!ne){var g=function $(R,H,ne){return R.objectMode||!1===R.decodeStrings||"string"!=typeof H||(H=we.from(H,ne)),H}(H,de,Ue);de!==g&&(ne=!0,Ue="buffer",de=g)}var y=H.objectMode?1:de.length;H.length+=y;var D=H.length<H.highWaterMark;if(D||(H.needDrain=!0),H.writing||H.corked){var L=H.lastBufferedRequest;H.lastBufferedRequest={chunk:de,encoding:Ue,isBuf:ne,callback:f,next:null},L?L.next=H.lastBufferedRequest:H.bufferedRequest=H.lastBufferedRequest,H.bufferedRequestCount+=1}else b(R,H,!1,y,de,Ue,f);return D}function b(R,H,ne,de,Ue,f,g){H.writelen=de,H.writecb=g,H.writing=!0,H.sync=!0,H.destroyed?H.onwrite(new wt("write")):ne?R._writev(Ue,H.onwrite):R._write(Ue,f,H.onwrite),H.sync=!1}function T(R,H,ne,de){ne||function P(R,H){0===H.length&&H.needDrain&&(H.needDrain=!1,R.emit("drain"))}(R,H),H.pendingcb--,de(),ie(R,H)}function W(R,H){H.bufferProcessing=!0;var ne=H.bufferedRequest;if(R._writev&&ne&&ne.next){var Ue=Array(H.bufferedRequestCount),f=H.corkedRequestsFree;f.entry=ne;for(var g=0,y=!0;ne;)Ue[g]=ne,ne.isBuf||(y=!1),ne=ne.next,g+=1;Ue.allBuffers=y,b(R,H,!0,H.length,Ue,"",f.finish),H.pendingcb++,H.lastBufferedRequest=null,f.next?(H.corkedRequestsFree=f.next,f.next=null):H.corkedRequestsFree=new G(H),H.bufferedRequestCount=0}else{for(;ne;){var D=ne.chunk;if(b(R,H,!1,H.objectMode?1:D.length,D,ne.encoding,ne.callback),ne=ne.next,H.bufferedRequestCount--,H.writing)break}null===ne&&(H.lastBufferedRequest=null)}H.bufferedRequest=ne,H.bufferProcessing=!1}function x(R){return R.ending&&0===R.length&&null===R.bufferedRequest&&!R.finished&&!R.writing}function N(R,H){R._final(function(ne){H.pendingcb--,ne&&bn(R,ne),H.prefinished=!0,R.emit("prefinish"),ie(R,H)})}function ie(R,H){var ne=x(H);if(ne&&(function J(R,H){H.prefinished||H.finalCalled||("function"!=typeof R._final||H.destroyed?(H.prefinished=!0,R.emit("prefinish")):(H.pendingcb++,H.finalCalled=!0,U.nextTick(N,R,H)))}(R,H),0===H.pendingcb&&(H.finished=!0,R.emit("finish"),H.autoDestroy))){var de=R._readableState;(!de||de.autoDestroy&&de.endEmitted)&&R.destroy()}return ne}var Ge;le.exports=C,C.WritableState=I;var Pn,ot={deprecate:K("util-deprecate")},an=K("./internal/streams/stream"),we=K("buffer").Buffer,vt=M.Uint8Array||function(){},Tr=K("./internal/streams/destroy"),at=K("./internal/streams/state").getHighWaterMark,lt=K("../errors").codes,qt=lt.ERR_INVALID_ARG_TYPE,Fn=lt.ERR_METHOD_NOT_IMPLEMENTED,Ir=lt.ERR_MULTIPLE_CALLBACK,ht=lt.ERR_STREAM_CANNOT_PIPE,wt=lt.ERR_STREAM_DESTROYED,kr=lt.ERR_STREAM_NULL_VALUES,xe=lt.ERR_STREAM_WRITE_AFTER_END,Ni=lt.ERR_UNKNOWN_ENCODING,bn=Tr.errorOrDestroy;K("inherits")(C,an),I.prototype.getBuffer=function(){for(var R=this.bufferedRequest,H=[];R;)H.push(R),R=R.next;return H},function(){try{Object.defineProperty(I.prototype,"buffer",{get:ot.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Pn=Function.prototype[Symbol.hasInstance],Object.defineProperty(C,Symbol.hasInstance,{value:function(R){return!!Pn.call(this,R)||this===C&&R&&R._writableState instanceof I}})):Pn=function(R){return R instanceof this},C.prototype.pipe=function(){bn(this,new ht)},C.prototype.write=function(R,H,ne){var de=this._writableState,Ue=!1,f=!de.objectMode&&function _(R){return we.isBuffer(R)||R instanceof vt}(R);return f&&!we.isBuffer(R)&&(R=function Q(R){return we.from(R)}(R)),"function"==typeof H&&(ne=H,H=null),f?H="buffer":!H&&(H=de.defaultEncoding),"function"!=typeof ne&&(ne=A),de.ending?function F(R,H){var ne=new xe;bn(R,ne),U.nextTick(H,ne)}(this,ne):(f||function V(R,H,ne,de){var Ue;return null===ne?Ue=new kr:"string"!=typeof ne&&!H.objectMode&&(Ue=new qt("chunk",["string","Buffer"],ne)),!Ue||(bn(R,Ue),U.nextTick(de,Ue),!1)}(this,de,R,ne))&&(de.pendingcb++,Ue=q(this,de,f,R,H,ne)),Ue},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){var R=this._writableState;R.corked&&(R.corked--,!R.writing&&!R.corked&&!R.bufferProcessing&&R.bufferedRequest&&W(this,R))},C.prototype.setDefaultEncoding=function(R){if("string"==typeof R&&(R=R.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((R+"").toLowerCase())))throw new Ni(R);return this._writableState.defaultEncoding=R,this},Object.defineProperty(C.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(C.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),C.prototype._write=function(R,H,ne){ne(new Fn("_write()"))},C.prototype._writev=null,C.prototype.end=function(R,H,ne){var de=this._writableState;return"function"==typeof R?(ne=R,R=null,H=null):"function"==typeof H&&(ne=H,H=null),null!=R&&this.write(R,H),de.corked&&(de.corked=1,this.uncork()),de.ending||function Ce(R,H,ne){H.ending=!0,ie(R,H),ne&&(H.finished?U.nextTick(ne):R.once("finish",ne)),H.ended=!0,R.writable=!1}(this,de,ne),this},Object.defineProperty(C.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(R){this._writableState&&(this._writableState.destroyed=R)}}),C.prototype.destroy=Tr.destroy,C.prototype._undestroy=Tr.undestroy,C.prototype._destroy=function(R,H){H(R)}}).call(this)}).call(this,K("_process"),typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(K,le){(function(U){(function(){"use strict";function M(P,W,x){return W in P?Object.defineProperty(P,W,{value:x,enumerable:!0,configurable:!0,writable:!0}):P[W]=x,P}function G(P,W){return{value:P,done:W}}function Q(P){var W=P[F];if(null!==W){var x=P[E].read();null!==x&&(P[b]=null,P[F]=null,P[V]=null,W(G(x,!1)))}}function _(P){U.nextTick(Q,P)}var I,C=K("./end-of-stream"),F=Symbol("lastResolve"),V=Symbol("lastReject"),$=Symbol("error"),q=Symbol("ended"),b=Symbol("lastPromise"),S=Symbol("handlePromise"),E=Symbol("stream"),O=Object.getPrototypeOf(function(){}),T=Object.setPrototypeOf((M(I={get stream(){return this[E]},next:function(){var P=this,W=this[$];if(null!==W)return Promise.reject(W);if(this[q])return Promise.resolve(G(void 0,!0));if(this[E].destroyed)return new Promise(function(ie,Ce){U.nextTick(function(){P[$]?Ce(P[$]):ie(G(void 0,!0))})});var x,N=this[b];if(N)x=new Promise(function A(P,W){return function(x,N){P.then(function(){return W[q]?void x(G(void 0,!0)):void W[S](x,N)},N)}}(N,this));else{var J=this[E].read();if(null!==J)return Promise.resolve(G(J,!1));x=new Promise(this[S])}return this[b]=x,x}},Symbol.asyncIterator,function(){return this}),M(I,"return",function(){var P=this;return new Promise(function(W,x){P[E].destroy(null,function(N){return N?void x(N):void W(G(void 0,!0))})})}),I),O);le.exports=function(P){var W,x=Object.create(T,(M(W={},E,{value:P,writable:!0}),M(W,F,{value:null,writable:!0}),M(W,V,{value:null,writable:!0}),M(W,$,{value:null,writable:!0}),M(W,q,{value:P._readableState.endEmitted,writable:!0}),M(W,S,{value:function(N,J){var ie=x[E].read();ie?(x[b]=null,x[F]=null,x[V]=null,N(G(ie,!1))):(x[F]=N,x[V]=J)},writable:!0}),W));return x[b]=null,C(P,function(N){if(N&&"ERR_STREAM_PREMATURE_CLOSE"!==N.code){var J=x[V];return null!==J&&(x[b]=null,x[F]=null,x[V]=null,J(N)),void(x[$]=N)}var ie=x[F];null!==ie&&(x[b]=null,x[F]=null,x[V]=null,ie(G(void 0,!0))),x[q]=!0}),P.on("readable",_.bind(null,x)),x}}).call(this)}).call(this,K("_process"))},{"./end-of-stream":24,_process:12}],22:[function(K,le){"use strict";function U(b,S){var E=Object.keys(b);if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(b);S&&(O=O.filter(function(T){return Object.getOwnPropertyDescriptor(b,T).enumerable})),E.push.apply(E,O)}return E}function G(b,S,E){return S in b?Object.defineProperty(b,S,{value:E,enumerable:!0,configurable:!0,writable:!0}):b[S]=E,b}function _(b,S){for(var E,O=0;O<S.length;O++)(E=S[O]).enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(b,E.key,E)}function I(b,S,E){F.prototype.copy.call(b,S,E)}var F=K("buffer").Buffer,$=K("util").inspect,q=$&&$.custom||"inspect";le.exports=function(){function b(){(function Q(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")})(this,b),this.head=null,this.tail=null,this.length=0}return function A(b,S,E){return S&&_(b.prototype,S),E&&_(b,E),b}(b,[{key:"push",value:function(S){var E={data:S,next:null};0<this.length?this.tail.next=E:this.head=E,this.tail=E,++this.length}},{key:"unshift",value:function(S){var E={data:S,next:this.head};0===this.length&&(this.tail=E),this.head=E,++this.length}},{key:"shift",value:function(){if(0!==this.length){var S=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,S}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(S){if(0===this.length)return"";for(var E=this.head,O=""+E.data;E=E.next;)O+=S+E.data;return O}},{key:"concat",value:function(S){if(0===this.length)return F.alloc(0);for(var E=F.allocUnsafe(S>>>0),O=this.head,T=0;O;)I(O.data,E,T),T+=O.data.length,O=O.next;return E}},{key:"consume",value:function(S,E){var O;return S<this.head.data.length?(O=this.head.data.slice(0,S),this.head.data=this.head.data.slice(S)):O=S===this.head.data.length?this.shift():E?this._getString(S):this._getBuffer(S),O}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(S){var E=this.head,O=1,T=E.data;for(S-=T.length;E=E.next;){var P=E.data,W=S>P.length?P.length:S;if(T+=W===P.length?P:P.slice(0,S),0==(S-=W)){W===P.length?(++O,this.head=E.next?E.next:this.tail=null):(this.head=E,E.data=P.slice(W));break}++O}return this.length-=O,T}},{key:"_getBuffer",value:function(S){var E=F.allocUnsafe(S),O=this.head,T=1;for(O.data.copy(E),S-=O.data.length;O=O.next;){var P=O.data,W=S>P.length?P.length:S;if(P.copy(E,E.length-S,0,W),0==(S-=W)){W===P.length?(++T,this.head=O.next?O.next:this.tail=null):(this.head=O,O.data=P.slice(W));break}++T}return this.length-=T,E}},{key:q,value:function(S,E){return $(this,function M(b){for(var S,E=1;E<arguments.length;E++)S=arguments[E]??{},E%2?U(Object(S),!0).forEach(function(O){G(b,O,S[O])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(S)):U(Object(S)).forEach(function(O){Object.defineProperty(b,O,Object.getOwnPropertyDescriptor(S,O))});return b}({},E,{depth:0,customInspect:!1}))}}]),b}()},{buffer:3,util:2}],23:[function(K,le){(function(U){(function(){"use strict";function M(_,A){Q(_,A),G(_)}function G(_){_._writableState&&!_._writableState.emitClose||_._readableState&&!_._readableState.emitClose||_.emit("close")}function Q(_,A){_.emit("error",A)}le.exports={destroy:function(_,A){var I=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(A?A(_):_&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,U.nextTick(Q,this,_)):U.nextTick(Q,this,_)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(_||null,function(V){!A&&V?I._writableState?I._writableState.errorEmitted?U.nextTick(G,I):(I._writableState.errorEmitted=!0,U.nextTick(M,I,V)):U.nextTick(M,I,V):A?(U.nextTick(G,I),A(V)):U.nextTick(G,I)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(_,A){var I=_._readableState,C=_._writableState;I&&I.autoDestroy||C&&C.autoDestroy?_.destroy(A):_.emit("error",A)}}}).call(this)}).call(this,K("_process"))},{_process:12}],24:[function(K,le){"use strict";function M(){}var _=K("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;le.exports=function Q(A,I,C){if("function"==typeof I)return Q(A,null,I);I||(I={}),C=function U(A){var I=!1;return function(){if(!I){I=!0;for(var C=arguments.length,F=Array(C),V=0;V<C;V++)F[V]=arguments[V];A.apply(this,F)}}}(C||M);var F=I.readable||!1!==I.readable&&A.readable,V=I.writable||!1!==I.writable&&A.writable,$=function(){A.writable||b()},q=A._writableState&&A._writableState.finished,b=function(){V=!1,q=!0,F||C.call(A)},S=A._readableState&&A._readableState.endEmitted,E=function(){F=!1,S=!0,V||C.call(A)},O=function(W){C.call(A,W)},T=function(){var W;return F&&!S?(A._readableState&&A._readableState.ended||(W=new _),C.call(A,W)):V&&!q?(A._writableState&&A._writableState.ended||(W=new _),C.call(A,W)):void 0},P=function(){A.req.on("finish",b)};return function G(A){return A.setHeader&&"function"==typeof A.abort}(A)?(A.on("complete",b),A.on("abort",T),A.req?P():A.on("request",P)):V&&!A._writableState&&(A.on("end",$),A.on("close",$)),A.on("end",E),A.on("finish",b),!1!==I.error&&A.on("error",O),A.on("close",T),function(){A.removeListener("complete",b),A.removeListener("abort",T),A.removeListener("request",P),A.req&&A.req.removeListener("finish",b),A.removeListener("end",$),A.removeListener("close",$),A.removeListener("finish",b),A.removeListener("end",E),A.removeListener("error",O),A.removeListener("close",T)}}},{"../../../errors":15}],25:[function(K,le){le.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(K,le){"use strict";function M(q){if(q)throw q}function Q(q,b,S,E){E=function U(q){var b=!1;return function(){b||(b=!0,q.apply(void 0,arguments))}}(E);var O=!1;q.on("close",function(){O=!0}),void 0===C&&(C=K("./end-of-stream")),C(q,{readable:b,writable:S},function(P){return P?E(P):(O=!0,void E())});var T=!1;return function(P){if(!O)return T?void 0:(T=!0,function G(q){return q.setHeader&&"function"==typeof q.abort}(q)?q.abort():"function"==typeof q.destroy?q.destroy():void E(P||new $("pipe")))}}function _(q){q()}function A(q,b){return q.pipe(b)}function I(q){return q.length&&"function"==typeof q[q.length-1]?q.pop():M}var C,F=K("../../../errors").codes,V=F.ERR_MISSING_ARGS,$=F.ERR_STREAM_DESTROYED;le.exports=function(){for(var q=arguments.length,b=Array(q),S=0;S<q;S++)b[S]=arguments[S];var E=I(b);if(Array.isArray(b[0])&&(b=b[0]),2>b.length)throw new V("streams");var O,T=b.map(function(P,W){var x=W<b.length-1;return Q(P,x,0<W,function(N){O||(O=N),N&&T.forEach(_),x||(T.forEach(_),E(O))})});return b.reduce(A)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(K,le){"use strict";var M=K("../../../errors").codes.ERR_INVALID_OPT_VALUE;le.exports={getHighWaterMark:function(G,Q,_,A){var I=function U(G,Q,_){return G.highWaterMark??(Q?G[_]:null)}(Q,A,_);if(null!=I){if(!isFinite(I)||us(I)!==I||0>I)throw new M(A?_:"highWaterMark",I);return us(I)}return G.objectMode?16:16384}}},{"../../../errors":15}],28:[function(K,le){le.exports=K("events").EventEmitter},{events:7}],29:[function(K,le,U){(U=le.exports=K("./lib/_stream_readable.js")).Stream=U,U.Readable=U,U.Writable=K("./lib/_stream_writable.js"),U.Duplex=K("./lib/_stream_duplex.js"),U.Transform=K("./lib/_stream_transform.js"),U.PassThrough=K("./lib/_stream_passthrough.js"),U.finished=K("./lib/internal/streams/end-of-stream.js"),U.pipeline=K("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(K,le,U){function M(A,I){for(var C in A)I[C]=A[C]}function G(A,I,C){return _(A,I,C)}var Q=K("buffer"),_=Q.Buffer;_.from&&_.alloc&&_.allocUnsafe&&_.allocUnsafeSlow?le.exports=Q:(M(Q,U),U.Buffer=G),G.prototype=Object.create(_.prototype),M(_,G),G.from=function(A,I,C){if("number"==typeof A)throw new TypeError("Argument must not be a number");return _(A,I,C)},G.alloc=function(A,I,C){if("number"!=typeof A)throw new TypeError("Argument must be a number");var F=_(A);return void 0===I?F.fill(0):"string"==typeof C?F.fill(I,C):F.fill(I),F},G.allocUnsafe=function(A){if("number"!=typeof A)throw new TypeError("Argument must be a number");return _(A)},G.allocUnsafeSlow=function(A){if("number"!=typeof A)throw new TypeError("Argument must be a number");return Q.SlowBuffer(A)}},{buffer:3}],31:[function(K,le,U){"use strict";function Q(T){var P;switch(this.encoding=function G(T){var P=function M(T){if(!T)return"utf8";for(var P;;)switch(T){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return T;default:if(P)return;T=(""+T).toLowerCase(),P=!0}}(T);if("string"!=typeof P&&(E.isEncoding===O||!O(T)))throw new Error("Unknown encoding: "+T);return P||T}(T),this.encoding){case"utf16le":this.text=F,this.end=V,P=4;break;case"utf8":this.fillLast=C,P=4;break;case"base64":this.text=$,this.end=q,P=3;break;default:return this.write=b,void(this.end=S)}this.lastNeed=0,this.lastTotal=0,this.lastChar=E.allocUnsafe(P)}function _(T){return 127>=T?0:T>>5==6?2:T>>4==14?3:T>>3==30?4:T>>6==2?-1:-2}function C(T){var P=this.lastTotal-this.lastNeed,W=function I(T,P){if(128!=(192&P[0]))return T.lastNeed=0,"\ufffd";if(1<T.lastNeed&&1<P.length){if(128!=(192&P[1]))return T.lastNeed=1,"\ufffd";if(2<T.lastNeed&&2<P.length&&128!=(192&P[2]))return T.lastNeed=2,"\ufffd"}}(this,T);return void 0===W?this.lastNeed<=T.length?(T.copy(this.lastChar,P,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(T.copy(this.lastChar,P,0,T.length),void(this.lastNeed-=T.length)):W}function F(T,P){if((T.length-P)%2==0){var W=T.toString("utf16le",P);if(W){var x=W.charCodeAt(W.length-1);if(55296<=x&&56319>=x)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=T[T.length-2],this.lastChar[1]=T[T.length-1],W.slice(0,-1)}return W}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=T[T.length-1],T.toString("utf16le",P,T.length-1)}function V(T){var P=T&&T.length?this.write(T):"";return this.lastNeed?P+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):P}function $(T,P){var W=(T.length-P)%3;return 0==W?T.toString("base64",P):(this.lastNeed=3-W,this.lastTotal=3,1==W?this.lastChar[0]=T[T.length-1]:(this.lastChar[0]=T[T.length-2],this.lastChar[1]=T[T.length-1]),T.toString("base64",P,T.length-W))}function q(T){var P=T&&T.length?this.write(T):"";return this.lastNeed?P+this.lastChar.toString("base64",0,3-this.lastNeed):P}function b(T){return T.toString(this.encoding)}function S(T){return T&&T.length?this.write(T):""}var E=K("safe-buffer").Buffer,O=E.isEncoding||function(T){switch((T=""+T)&&T.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};U.StringDecoder=Q,Q.prototype.write=function(T){if(0===T.length)return"";var P,W;if(this.lastNeed){if(void 0===(P=this.fillLast(T)))return"";W=this.lastNeed,this.lastNeed=0}else W=0;return W<T.length?P?P+this.text(T,W):this.text(T,W):P||""},Q.prototype.end=function(T){var P=T&&T.length?this.write(T):"";return this.lastNeed?P+"\ufffd":P},Q.prototype.text=function(T,P){var W=function A(T,P,W){var x=P.length-1;if(x<W)return 0;var N=_(P[x]);return 0<=N?(0<N&&(T.lastNeed=N-1),N):--x<W||-2===N?0:0<=(N=_(P[x]))?(0<N&&(T.lastNeed=N-2),N):--x<W||-2===N?0:0<=(N=_(P[x]))?(0<N&&(2===N?N=0:T.lastNeed=N-3),N):0}(this,T,P);if(!this.lastNeed)return T.toString("utf8",P);this.lastTotal=W;var x=T.length-(W-this.lastNeed);return T.copy(this.lastChar,0,x),T.toString("utf8",P,x)},Q.prototype.fillLast=function(T){return this.lastNeed<=T.length?(T.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(T.copy(this.lastChar,this.lastTotal-this.lastNeed,0,T.length),void(this.lastNeed-=T.length))}},{"safe-buffer":30}],32:[function(K,le){(function(U){(function(){function M(G){try{if(!U.localStorage)return!1}catch{return!1}var Q=U.localStorage[G];return null!=Q&&"true"===(Q+"").toLowerCase()}le.exports=function(G,Q){if(M("noDeprecation"))return G;var A=!1;return function _(){if(!A){if(M("throwDeprecation"))throw new Error(Q);M("traceDeprecation")?console.trace(Q):console.warn(Q),A=!0}return G.apply(this,arguments)}}}).call(this)}).call(this,typeof global>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:global)},{}],"/":[function(K,le){function U(q){return q.replace(/a=ice-options:trickle\s\n/g,"")}const G=K("debug")("simple-peer"),Q=K("get-browser-rtc"),_=K("randombytes"),A=K("readable-stream"),I=K("queue-microtask"),C=K("err-code"),{Buffer:F}=K("buffer"),V=65536;class $ extends A.Duplex{constructor(b){if(super(b=Object.assign({allowHalfOpen:!1},b)),this._id=_(4).toString("hex").slice(0,7),this._debug("new peer %o",b),this.channelName=b.initiator?b.channelName||_(20).toString("hex"):null,this.initiator=b.initiator||!1,this.channelConfig=b.channelConfig||$.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},$.config,b.config),this.offerOptions=b.offerOptions||{},this.answerOptions=b.answerOptions||{},this.sdpTransform=b.sdpTransform||(S=>S),this.streams=b.streams||(b.stream?[b.stream]:[]),this.trickle=void 0===b.trickle||b.trickle,this.allowHalfTrickle=void 0!==b.allowHalfTrickle&&b.allowHalfTrickle,this.iceCompleteTimeout=b.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=b.wrtc&&"object"==typeof b.wrtc?b.wrtc:Q(),!this._wrtc)throw C(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(S){return void this.destroy(C(S,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=S=>{this._onIceCandidate(S)},"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch(S=>{this.destroy(C(S,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=S=>{this._setupData(S)},this.streams&&this.streams.forEach(S=>{this.addStream(S)}),this._pc.ontrack=S=>{this._onTrack(S)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(b){if(!this.destroying){if(this.destroyed)throw C(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if("string"==typeof b)try{b=JSON.parse(b)}catch{b={}}this._debug("signal()"),b.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),b.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(b.transceiverRequest.kind,b.transceiverRequest.init)),b.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(b.candidate):this._pendingCandidates.push(b.candidate)),b.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(b)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(S=>{this._addIceCandidate(S)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(S=>{this.destroy(C(S,"ERR_SET_REMOTE_DESCRIPTION"))}),b.sdp||b.candidate||b.renegotiate||b.transceiverRequest||this.destroy(C(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(b){const S=new this._wrtc.RTCIceCandidate(b);this._pc.addIceCandidate(S).catch(E=>{!S.address||S.address.endsWith(".local")?function M(q){console.warn(q)}("Ignoring unsupported ICE candidate."):this.destroy(C(E,"ERR_ADD_ICE_CANDIDATE"))})}send(b){if(!this.destroying){if(this.destroyed)throw C(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(b)}}addTransceiver(b,S){if(!this.destroying){if(this.destroyed)throw C(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(b,S),this._needsNegotiation()}catch(E){this.destroy(C(E,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:b,init:S}})}}addStream(b){if(!this.destroying){if(this.destroyed)throw C(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),b.getTracks().forEach(S=>{this.addTrack(S,b)})}}addTrack(b,S){if(this.destroying)return;if(this.destroyed)throw C(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const E=this._senderMap.get(b)||new Map;let O=E.get(S);if(O)throw O.removed?C(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):C(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");O=this._pc.addTrack(b,S),E.set(S,O),this._senderMap.set(b,E),this._needsNegotiation()}replaceTrack(b,S,E){if(this.destroying)return;if(this.destroyed)throw C(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const O=this._senderMap.get(b),T=O?O.get(E):null;if(!T)throw C(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");S&&this._senderMap.set(S,O),null==T.replaceTrack?this.destroy(C(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):T.replaceTrack(S)}removeTrack(b,S){if(this.destroying)return;if(this.destroyed)throw C(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const E=this._senderMap.get(b),O=E?E.get(S):null;if(!O)throw C(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{O.removed=!0,this._pc.removeTrack(O)}catch(T){"NS_ERROR_UNEXPECTED"===T.name?this._sendersAwaitingStable.push(O):this.destroy(C(T,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(b){if(!this.destroying){if(this.destroyed)throw C(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),b.getTracks().forEach(S=>{this.removeTrack(S,b)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,I(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw C(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(b){this._destroy(b,()=>{})}_destroy(b,S){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",b&&(b.message||b)),I(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",b&&(b.message||b)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,b&&this.emit("error",b),this.emit("close"),S()}))}_setupData(b){if(!b.channel)return this.destroy(C(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=b.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=V),this.channelName=this._channel.label,this._channel.onmessage=E=>{this._onChannelMessage(E)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=E=>{const O=E.error instanceof Error?E.error:new Error(`Datachannel error: ${E.message} ${E.filename}:${E.lineno}:${E.colno}`);this.destroy(C(O,"ERR_DATA_CHANNEL"))};let S=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(S&&this._onChannelClose(),S=!0):S=!1},5e3)}_read(){}_write(b,S,E){if(this.destroyed)return E(C(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(b)}catch(O){return this.destroy(C(O,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>V?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=E):E(null)}else this._debug("write before connect"),this._chunk=b,this._cb=E}_onFinish(){if(!this.destroyed){const b=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?b():this.once("connect",b)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(b=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(b.sdp=U(b.sdp)),b.sdp=this.sdpTransform(b.sdp);const S=()=>{if(!this.destroyed){const E=this._pc.localDescription||b;this._debug("signal"),this.emit("signal",{type:E.type,sdp:E.sdp})}};this._pc.setLocalDescription(b).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?S():this.once("_iceComplete",S))}).catch(E=>{this.destroy(C(E,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(b=>{this.destroy(C(b,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(b=>{b.mid||!b.sender.track||b.requested||(b.requested=!0,this.addTransceiver(b.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(b=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(b.sdp=U(b.sdp)),b.sdp=this.sdpTransform(b.sdp);const S=()=>{if(!this.destroyed){const E=this._pc.localDescription||b;this._debug("signal"),this.emit("signal",{type:E.type,sdp:E.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(b).then(()=>{this.destroyed||(this.trickle||this._iceComplete?S():this.once("_iceComplete",S))}).catch(E=>{this.destroy(C(E,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(b=>{this.destroy(C(b,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(C(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const b=this._pc.iceConnectionState,S=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",b,S),this.emit("iceStateChange",b,S),("connected"===b||"completed"===b)&&(this._pcReady=!0,this._maybeReady()),"failed"===b&&this.destroy(C(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===b&&this.destroy(C(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(b){const S=E=>("[object Array]"===Object.prototype.toString.call(E.values)&&E.values.forEach(O=>{Object.assign(E,O)}),E);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(E=>{const O=[];E.forEach(T=>{O.push(S(T))}),b(null,O)},E=>b(E)):0<this._pc.getStats.length?this._pc.getStats(E=>{if(this.destroyed)return;const O=[];E.result().forEach(T=>{const P={};T.names().forEach(W=>{P[W]=T.stat(W)}),P.id=T.id,P.type=T.type,P.timestamp=T.timestamp,O.push(S(P))}),b(null,O)},E=>b(E)):b(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const b=()=>{this.destroyed||this.getStats((S,E)=>{if(this.destroyed)return;S&&(E=[]);const O={},T={},P={};let W=!1;E.forEach(N=>{("remotecandidate"===N.type||"remote-candidate"===N.type)&&(O[N.id]=N),("localcandidate"===N.type||"local-candidate"===N.type)&&(T[N.id]=N),("candidatepair"===N.type||"candidate-pair"===N.type)&&(P[N.id]=N)});const x=N=>{W=!0;let J=T[N.localCandidateId];J&&(J.ip||J.address)?(this.localAddress=J.ip||J.address,this.localPort=+J.port):J&&J.ipAddress?(this.localAddress=J.ipAddress,this.localPort=+J.portNumber):"string"==typeof N.googLocalAddress&&(J=N.googLocalAddress.split(":"),this.localAddress=J[0],this.localPort=+J[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let ie=O[N.remoteCandidateId];ie&&(ie.ip||ie.address)?(this.remoteAddress=ie.ip||ie.address,this.remotePort=+ie.port):ie&&ie.ipAddress?(this.remoteAddress=ie.ipAddress,this.remotePort=+ie.portNumber):"string"==typeof N.googRemoteAddress&&(ie=N.googRemoteAddress.split(":"),this.remoteAddress=ie[0],this.remotePort=+ie[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(E.forEach(N=>{"transport"===N.type&&N.selectedCandidatePairId&&x(P[N.selectedCandidatePairId]),("googCandidatePair"===N.type&&"true"===N.googActiveConnection||("candidatepair"===N.type||"candidate-pair"===N.type)&&N.selected)&&x(N)}),W||Object.keys(P).length&&!Object.keys(T).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(J){return this.destroy(C(J,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const N=this._cb;this._cb=null,N(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(b,100)})};b()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>V)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(b=>{this._pc.removeTrack(b),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(b){this.destroyed||(b.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:b.candidate.candidate,sdpMLineIndex:b.candidate.sdpMLineIndex,sdpMid:b.candidate.sdpMid}}):!b.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),b.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(b){if(this.destroyed)return;let S=b.data;S instanceof ArrayBuffer&&(S=F.from(S)),this.push(S)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const b=this._cb;this._cb=null,b(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(b){this.destroyed||b.streams.forEach(S=>{this._debug("on track"),this.emit("track",b.track,S),this._remoteTracks.push({track:b.track,stream:S}),this._remoteStreams.some(E=>E.id===S.id)||(this._remoteStreams.push(S),I(()=>{this._debug("on stream"),this.emit("stream",S)}))})}_debug(){const b=[].slice.call(arguments);b[0]="["+this._id+"] "+b[0],G.apply(null,b)}}$.WEBRTC_SUPPORT=!!Q(),$.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},$.channelConfig={},le.exports=$},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/"))}},xl=>{xl(xl.s=761)}]);